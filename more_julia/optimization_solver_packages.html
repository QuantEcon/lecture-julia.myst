

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>10. Optimization and Nonlinear Solvers &#8212; Quantitative Economics with Julia</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/quantecon-book-theme.css?digest=b09b2da44b9015b4fa76ea072fa2d8f7faee5492" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/quantecon-book-theme.js?digest=eed9c059a3ee152aae2353ec732f0a6d12e6aa07"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3PCWRLGWND"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3PCWRLGWND');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'more_julia/optimization_solver_packages';</script>
    <link rel="canonical" href="https://julia.quantecon.org/more_julia/optimization_solver_packages.html" />
    <link rel="shortcut icon" href="../_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Visual Studio Code and Other Tools" href="../software_engineering/tools_editors.html" />
    <link rel="prev" title="9. General, Data, and Statistics Packages" href="data_statistical_packages.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Jesse Perla &amp; Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Julia, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Jesse Perla, Thomas J. Sargent and John Stachurski. The language instruction is Julia. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Optimization and Nonlinear Solvers"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Jesse Perla, Thomas J. Sargent and John Stachurski. The language instruction is Julia.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Optimization and Nonlinear Solvers" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://julia.quantecon.org/more_julia/optimization_solver_packages.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Jesse Perla, Thomas J. Sargent and John Stachurski. The language instruction is Julia." />
<meta property="og:site_name" content="Quantitative Economics with Julia" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=more_julia/optimization_solver_packages>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">10.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization">10.2. Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optim-jl">10.2.1. Optim.jl</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#univariate-functions-on-bounded-intervals">10.2.1.1. Univariate Functions on Bounded Intervals</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#unconstrained-multivariate-optimization">10.2.1.2. Unconstrained Multivariate Optimization</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jump-jl">10.2.2. JuMP.jl</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#blackboxoptim-jl">10.2.3. BlackBoxOptim.jl</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-jl-meta-package">10.3. Optimization.jl Meta-Package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinearsolve-jl-meta-package">10.4. NonlinearSolve.jl Meta-Package</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-examples">10.4.1. Basic Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-parameters-and-inplace-functions">10.4.2. Using Parameters and Inplace Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#patterns-for-parameters">10.4.3. Patterns for Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#small-systems">10.4.4. Small Systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-other-solvers">10.4.5. Using Other Solvers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bracketing-solvers-and-rootfinding-problems">10.4.6. Bracketing Solvers and Rootfinding Problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#systems-of-equations-and-fixed-points">10.5. Systems of Equations and Fixed Points</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#roots-jl">10.5.1. Roots.jl</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nlsolve-jl">10.5.2. NLsolve.jl</a></li>
</ul>
</li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="../_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    <a href=https://quantecon.org><img src="../_static/quantecon-logo-transparent.png" class="dark-logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="../intro.html">Quantitative Economics with Julia</a></p>

                        <p class="qe-page__header-subheading">Optimization and Nonlinear Solvers</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="https://www.jesseperla.com" target="_blank"><span>Jesse Perla</span></a>,
                                
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>,
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><section class="tex2jax_ignore mathjax_ignore" id="optimization-and-nonlinear-solvers">
<h1><a class="toc-backref" href="#id1"><span class="section-number">10. </span>Optimization and Nonlinear Solvers</a><a class="headerlink" href="#optimization-and-nonlinear-solvers" title="Permalink to this heading">#</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#optimization-and-nonlinear-solvers" id="id1">Optimization and Nonlinear Solvers</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id2">Overview</a></p></li>
<li><p><a class="reference internal" href="#optimization" id="id3">Optimization</a></p></li>
<li><p><a class="reference internal" href="#optimization-jl-meta-package" id="id4">Optimization.jl Meta-Package</a></p></li>
<li><p><a class="reference internal" href="#nonlinearsolve-jl-meta-package" id="id5">NonlinearSolve.jl Meta-Package</a></p></li>
<li><p><a class="reference internal" href="#systems-of-equations-and-fixed-points" id="id6">Systems of Equations and Fixed Points</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id2"><span class="section-number">10.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>In this lecture we introduce a few of the Julia libraries for solving optimization problems, systems of equations, and finding fixed points.</p>
<p>See <a class="reference internal" href="auto_differentiation.html"><span class="doc">auto-differentiation</span></a> for more on calculating gradients and Jacobians for these types of algorithms.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span><span class="p">,</span><span class="w"> </span><span class="n">Statistics</span><span class="p">,</span><span class="w"> </span><span class="n">BenchmarkTools</span>
<span class="k">using</span><span class="w"> </span><span class="n">ForwardDiff</span><span class="p">,</span><span class="w"> </span><span class="n">Optim</span><span class="p">,</span><span class="w"> </span><span class="n">Roots</span><span class="p">,</span><span class="w"> </span><span class="n">NLsolve</span>
<span class="k">using</span><span class="w"> </span><span class="n">FixedPointAcceleration</span><span class="p">,</span><span class="w"> </span><span class="n">NonlinearSolve</span>
<span class="k">using</span><span class="w"> </span><span class="n">Optimization</span><span class="p">,</span><span class="w"> </span><span class="n">OptimizationOptimJL</span><span class="p">,</span><span class="w"> </span><span class="n">ForwardDiff</span><span class="p">,</span><span class="w"> </span><span class="n">Enzyme</span>
<span class="k">using</span><span class="w"> </span><span class="n">Optim</span><span class="o">:</span><span class="w"> </span><span class="n">converged</span><span class="p">,</span><span class="w"> </span><span class="n">maximum</span><span class="p">,</span><span class="w"> </span><span class="n">maximizer</span><span class="p">,</span><span class="w"> </span><span class="n">minimizer</span><span class="p">,</span><span class="w"> </span><span class="n">iterations</span><span class="w"> </span><span class="c">#some extra functions</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optimization">
<h2><a class="toc-backref" href="#id3"><span class="section-number">10.2. </span>Optimization</a><a class="headerlink" href="#optimization" title="Permalink to this heading">#</a></h2>
<p>There are a large number of packages intended to be used for optimization in Julia.</p>
<p>Part of the reason for the diversity of options is that Julia makes it possible to efficiently implement a large number of variations on optimization routines.</p>
<p>The other reason is that different types of optimization problems require different algorithms.</p>
<section id="optim-jl">
<h3><span class="section-number">10.2.1. </span>Optim.jl<a class="headerlink" href="#optim-jl" title="Permalink to this heading">#</a></h3>
<p>A good pure-Julia solution for the (unconstrained or box-bounded) optimization of
univariate and multivariate functions is the <a class="reference external" href="https://github.com/JuliaNLSolvers/Optim.jl">Optim.jl</a> package.</p>
<p>By default, the algorithms in <code class="docutils literal notranslate"><span class="pre">Optim.jl</span></code> target minimization rather than
maximization, so if a function is called <code class="docutils literal notranslate"><span class="pre">optimize</span></code> it will mean minimization.</p>
<section id="univariate-functions-on-bounded-intervals">
<h4><span class="section-number">10.2.1.1. </span>Univariate Functions on Bounded Intervals<a class="headerlink" href="#univariate-functions-on-bounded-intervals" title="Permalink to this heading">#</a></h4>
<p><a class="reference external" href="http://julianlsolvers.github.io/Optim.jl/stable/user/minimization/#minimizing-a-univariate-function-on-a-bounded-interval">Univariate optimization</a>
defaults to a robust hybrid optimization routine called <a class="reference external" href="https://en.wikipedia.org/wiki/Brent%27s_method">Brent’s method</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Optim</span><span class="o">:</span><span class="w"> </span><span class="n">converged</span><span class="p">,</span><span class="w"> </span><span class="n">maximum</span><span class="p">,</span><span class="w"> </span><span class="n">maximizer</span><span class="p">,</span><span class="w"> </span><span class="n">minimizer</span><span class="p">,</span><span class="w"> </span><span class="n">iterations</span><span class="w"> </span><span class="c">#some extra functions</span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optimize</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Results of Optimization Algorithm
 * Status: success
 * Algorithm: Brent&#39;s Method
 * Search Interval: [-2.000000, 1.000000]
 * Minimizer: 0.000000e+00
 * Minimum: 0.000000e+00
 * Iterations: 5
 * Convergence: max(|x - x_upper|, |x - x_lower|) &lt;= 2*(1.5e-08*|x|+2.2e-16): true
 * Objective Function Calls: 6
</pre></div>
</div>
</div>
</div>
<p>Always check if the results converged, and throw errors otherwise</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">    </span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Failed to converge in </span><span class="si">$</span><span class="p">(</span><span class="n">iterations</span><span class="p">(</span><span class="n">result</span><span class="p">))</span><span class="s"> iterations&quot;</span><span class="p">)</span>
<span class="n">xmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="o">.</span><span class="n">minimizer</span>
<span class="n">result</span><span class="o">.</span><span class="n">minimum</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>The first line is a logical OR between <code class="docutils literal notranslate"><span class="pre">converged(result)</span></code> and <code class="docutils literal notranslate"><span class="pre">error(&quot;...&quot;)</span></code>.</p>
<p>If the convergence check passes, the logical sentence is true, and it will proceed to the next line; if not, it will throw the error.</p>
</section>
<section id="unconstrained-multivariate-optimization">
<h4><span class="section-number">10.2.1.2. </span>Unconstrained Multivariate Optimization<a class="headerlink" href="#unconstrained-multivariate-optimization" title="Permalink to this heading">#</a></h4>
<p>There are a variety of <a class="reference external" href="http://julianlsolvers.github.io/Optim.jl/stable/user/minimization/#_top">algorithms and options</a> for multivariate optimization.</p>
<p>From the documentation, the simplest version is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">x_iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">]</span>
<span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x_iv</span><span class="p">)</span><span class="w"> </span><span class="c"># i.e. optimize(f, x_iv, NelderMead())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * Status: success

 * Candidate solution
    Final objective value:     3.525527e-09

 * Found with
    Algorithm:     Nelder-Mead

 * Convergence measures
    √(Σ(yᵢ-ȳ)²)/n ≤ 1.0e-08

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    60
    f(x) calls:    117
</pre></div>
</div>
</div>
</div>
<p>The default algorithm is <code class="docutils literal notranslate"><span class="pre">NelderMead</span></code>, which is derivative-free and hence requires many function evaluations.</p>
<p>To change the algorithm type to <a class="reference external" href="http://julianlsolvers.github.io/Optim.jl/stable/algo/lbfgs/">L-BFGS</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x_iv</span><span class="p">,</span><span class="w"> </span><span class="n">LBFGS</span><span class="p">())</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;minimum = </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">minimum</span><span class="p">)</span><span class="s"> with argmin = </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">minimizer</span><span class="p">)</span><span class="s"> in &quot;</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span><span class="s"> iterations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>minimum = 5.378388330692143e-17 with argmin = [0.9999999926662504, 0.9999999853325008] in 24 iterations
</pre></div>
</div>
</div>
</div>
<p>Note that this has fewer iterations.</p>
<p>As no derivative was given, it used <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference">finite differences</a> to approximate the gradient of <code class="docutils literal notranslate"><span class="pre">f(x)</span></code>.</p>
<p>However, since most of the algorithms require derivatives, you will often want to use automatic differentiation or pass analytical gradients if possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">x_iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">]</span>
<span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x_iv</span><span class="p">,</span><span class="w"> </span><span class="n">LBFGS</span><span class="p">(),</span><span class="w"> </span><span class="n">autodiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">:forward</span><span class="p">)</span><span class="w"> </span><span class="c"># i.e. use ForwardDiff.jl</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;minimum = </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">minimum</span><span class="p">)</span><span class="s"> with argmin = </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">minimizer</span><span class="p">)</span><span class="s"> in &quot;</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span><span class="s"> iterations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>minimum = 5.191703158437428e-27 with argmin = [0.999999999999928, 0.9999999999998559] in 24 iterations
</pre></div>
</div>
</div>
</div>
<p>Note that we did not need to use <code class="docutils literal notranslate"><span class="pre">ForwardDiff.jl</span></code> directly, as long as our <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> function was written to be generic (see the <a class="reference internal" href="generic_programming.html"><span class="doc">generic programming lecture</span></a> ).</p>
<p>Alternatively, with an analytical gradient</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">x_iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">]</span>
<span class="k">function</span><span class="w"> </span><span class="n">g!</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">400.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">G</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">200.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">g!</span><span class="p">,</span><span class="w"> </span><span class="n">x_iv</span><span class="p">,</span><span class="w"> </span><span class="n">LBFGS</span><span class="p">())</span><span class="w"> </span><span class="c"># or ConjugateGradient()</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;minimum = </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">minimum</span><span class="p">)</span><span class="s"> with argmin = </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">minimizer</span><span class="p">)</span><span class="s"> in &quot;</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span><span class="s"> iterations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>minimum = 5.191703158437428e-27 with argmin = [0.999999999999928, 0.9999999999998559] in 24 iterations
</pre></div>
</div>
</div>
</div>
<p>For derivative-free methods, you can change the algorithm – and have no need to provide a gradient</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">x_iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">]</span>
<span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x_iv</span><span class="p">,</span><span class="w"> </span><span class="n">SimulatedAnnealing</span><span class="p">())</span><span class="w"> </span><span class="c"># or ParticleSwarm() or NelderMead()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> * Status: failure (reached maximum number of iterations)

 * Candidate solution
    Final objective value:     1.437096e-02

 * Found with
    Algorithm:     Simulated Annealing

 * Convergence measures
    |x - x&#39;|               = NaN ≰ 0.0e+00
    |x - x&#39;|/|x&#39;|          = NaN ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = NaN ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = NaN ≰ 0.0e+00
    |g(x)|                 = NaN ≰ 1.0e-08

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    1000
    f(x) calls:    1001
</pre></div>
</div>
</div>
</div>
<p>However, you will note that this did not converge, as stochastic methods typically require many more iterations as a tradeoff for their global convergence properties.</p>
<p>See the <a class="reference external" href="http://julianlsolvers.github.io/Optim.jl/stable/examples/generated/maxlikenlm/">maximum likelihood</a>
example and the accompanying <a class="reference external" href="https://nbviewer.jupyter.org/github/JuliaNLSolvers/Optim.jl/blob/gh-pages/v0.15.3/examples/generated/maxlikenlm.ipynb">Jupyter notebook</a>.</p>
</section>
</section>
<section id="jump-jl">
<h3><span class="section-number">10.2.2. </span>JuMP.jl<a class="headerlink" href="#jump-jl" title="Permalink to this heading">#</a></h3>
<p>The <a class="reference external" href="https://github.com/JuliaOpt/JuMP.jl">JuMP.jl</a> package is an ambitious implementation of a modelling language for optimization problems in Julia.</p>
<p>In that sense, it is more like an AMPL (or Pyomo) built on top of the Julia
language with macros, and able to use a variety of different commercial and open-source solvers.</p>
<p>If you have a linear, quadratic, conic, mixed-integer linear, etc. problem then this will likely be the ideal “meta-package” for calling various solvers.</p>
<p>For nonlinear problems, the modelling language may make things difficult for complicated functions (as it is not designed to be used as a general-purpose nonlinear optimizer).</p>
<p>See the <a class="reference external" href="http://www.juliaopt.org/JuMP.jl/0.18/quickstart.html">quick start guide</a> for more details on all of the options.</p>
<p>The following is an example of calling a linear objective with a nonlinear constraint (provided by an external function).</p>
<p>Here <code class="docutils literal notranslate"><span class="pre">Ipopt</span></code> stands for <code class="docutils literal notranslate"><span class="pre">Interior</span> <span class="pre">Point</span> <span class="pre">OPTimizer</span></code>, a <a class="reference external" href="https://github.com/JuliaOpt/Ipopt.jl">nonlinear solver</a> in Julia</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">JuMP</span><span class="p">,</span><span class="w"> </span><span class="n">Ipopt</span>
<span class="c"># solve</span>
<span class="c"># max( x[1] + x[2] )</span>
<span class="c"># st sqrt(x[1]^2 + x[2]^2) &lt;= 1</span>

<span class="k">function</span><span class="w"> </span><span class="n">squareroot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># pretending we don&#39;t know sqrt()</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="c"># Initial starting point for Newton’s method</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1e-13</span>
<span class="w">        </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="n">z</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">z</span>
<span class="k">end</span>
<span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Model</span><span class="p">(</span><span class="n">Ipopt</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">)</span>
<span class="c"># need to register user defined functions for AD</span>
<span class="n">JuMP</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="ss">:squareroot</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">squareroot</span><span class="p">,</span><span class="w"> </span><span class="n">autodiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span>

<span class="nd">@variable</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="c"># start is the initial condition</span>
<span class="nd">@objective</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">Max</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nd">@NLconstraint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">squareroot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">JuMP</span><span class="o">.</span><span class="n">optimize!</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<p>And this is an example of a quadratic objective</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># solve</span>
<span class="c"># min (1-x)^2 + (100(y-x^2)^2)</span>
<span class="c"># st x + y &gt;= 10</span>

<span class="k">using</span><span class="w"> </span><span class="n">JuMP</span><span class="p">,</span><span class="w"> </span><span class="n">Ipopt</span>
<span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Model</span><span class="p">(</span><span class="n">Ipopt</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">)</span><span class="w"> </span><span class="c"># settings for the solver</span>
<span class="nd">@variable</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="nd">@variable</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

<span class="nd">@NLobjective</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">Min</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">100</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="n">JuMP</span><span class="o">.</span><span class="n">optimize!</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;x = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="s">&quot; y = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

<span class="c"># adding a (linear) constraint</span>
<span class="nd">@constraint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span>
<span class="n">JuMP</span><span class="o">.</span><span class="n">optimize!</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;x = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="s">&quot; y = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="blackboxoptim-jl">
<h3><span class="section-number">10.2.3. </span>BlackBoxOptim.jl<a class="headerlink" href="#blackboxoptim-jl" title="Permalink to this heading">#</a></h3>
<p>Another package for doing global optimization without derivatives is <a class="reference external" href="https://github.com/robertfeldt/BlackBoxOptim.jl">BlackBoxOptim.jl</a>.</p>
<p>An example for <a class="reference external" href="https://github.com/robertfeldt/BlackBoxOptim.jl/blob/master/examples/rosenbrock_parallel.jl">parallel execution</a> of the objective is provided.</p>
</section>
</section>
<section id="optimization-jl-meta-package">
<h2><a class="toc-backref" href="#id4"><span class="section-number">10.3. </span>Optimization.jl Meta-Package</a><a class="headerlink" href="#optimization-jl-meta-package" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://github.com/SciML/Optimization.jl">Optimization.jl</a> package provides a common interface to a variety of optimization packages in Julia.  As part of the <a class="reference external" href="https://sciml.ai/">SciML</a> ecosystem, it is designed to work seamlessly with other SciML tools, and to provide differentiable optimization routines that can be used in conjunction with automatic differentiation packages.</p>
<p>Algorithms require loading additional packages for one of the <a class="reference external" href="https://docs.sciml.ai/Optimization/stable/#Overview-of-the-solver-packages-in-alphabetical-order">supported optimizers</a>, such as <code class="docutils literal notranslate"><span class="pre">OptimizationOptimJL.jl</span></code>, which wraps the <code class="docutils literal notranslate"><span class="pre">Optim.jl</span></code> package.</p>
<p>From the <a class="reference external" href="https://docs.sciml.ai/Optimization/stable/getting_started/">documentation</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">rosenbrock</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">u0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">100.0</span><span class="p">]</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OptimizationProblem</span><span class="p">(</span><span class="n">rosenbrock</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">NelderMead</span><span class="p">())</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element Vector{Float64}:
 0.9999634355313174
 0.9999315506115275
</pre></div>
</div>
</div>
</div>
<p>The separation of the argument, <code class="docutils literal notranslate"><span class="pre">u</span></code>, and the parameters, <code class="docutils literal notranslate"><span class="pre">p</span></code>, is common in SciML and provides methods to cleanly handle parameterized problems.</p>
<p>Function wrappers also provide easy integration with automatic differentiation such as <code class="docutils literal notranslate"><span class="pre">ForwardDiff.jl</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f_fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OptimizationFunction</span><span class="p">(</span><span class="n">rosenbrock</span><span class="p">,</span><span class="w"> </span><span class="n">Optimization</span><span class="o">.</span><span class="n">AutoForwardDiff</span><span class="p">())</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OptimizationProblem</span><span class="p">(</span><span class="n">f_fd</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">BFGS</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element Vector{Float64}:
 0.9999999999373614
 0.999999999868622
</pre></div>
</div>
</div>
</div>
<p>Or with <code class="docutils literal notranslate"><span class="pre">Enzyme.jl</span></code>, which has slower compilation times but provides another AD backend</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f_enzyme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OptimizationFunction</span><span class="p">(</span><span class="n">rosenbrock</span><span class="p">,</span><span class="w"> </span><span class="n">Optimization</span><span class="o">.</span><span class="n">AutoEnzyme</span><span class="p">())</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OptimizationProblem</span><span class="p">(</span><span class="n">f_enzyme</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">BFGS</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element Vector{Float64}:
 0.9999999999373613
 0.9999999998686219
</pre></div>
</div>
</div>
</div>
<p>Finally, <a class="reference external" href="https://docs.sciml.ai/Optimization/stable/">the documentation</a> for a variety of other examples and features, such as constrained optimization.</p>
</section>
<section id="nonlinearsolve-jl-meta-package">
<h2><a class="toc-backref" href="#id5"><span class="section-number">10.4. </span>NonlinearSolve.jl Meta-Package</a><a class="headerlink" href="#nonlinearsolve-jl-meta-package" title="Permalink to this heading">#</a></h2>
<p>Within the <a class="reference external" href="https://sciml.ai/">SciML</a> ecosystem, the <a class="reference external" href="https://github.com/SciML/NonlinearSolve.jl">NonlinearSolve.jl</a> package provides a unified interface for solving nonlinear systems of equations. It builds on top of other SciML packages and offers advanced features such as automatic differentiation, various solver algorithms, and support for large-scale problems.  Furthermore, as with <code class="docutils literal notranslate"><span class="pre">Optimization.jl</span></code>, it has convenient integration with automatic differentiation (as well as implementing AD for the solver itself, with respect to parameters).</p>
<p>In general, we suggest using this meta-package where possible as it provides a well-maintained interface amenable to switching out solvers in the future.</p>
<section id="basic-examples">
<h3><span class="section-number">10.4.1. </span>Basic Examples<a class="headerlink" href="#basic-examples" title="Permalink to this heading">#</a></h3>
<p>Here we adapt examples directly from the <a class="reference external" href="https://docs.sciml.ai/NonlinearSolve/stable/">documentation</a>.</p>
<p>First we can solve a system of equations as a closure over a constant <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="c"># p ignored</span>
<span class="n">u0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">]</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NonlinearProblem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">)</span><span class="w"> </span><span class="c"># defaults to p = nothing</span>
<span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">NewtonRaphson</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element Vector{Float64}:
 1.4142135623730951
 1.4142135623730951
</pre></div>
</div>
</div>
</div>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">p</span></code> argument (which can hold parameters) is ignored, but needs to be present in SciML problems.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NewtonRaphson()</span></code> method is a built-in solver, and not an external package.  We can access the results through <code class="docutils literal notranslate"><span class="pre">sol.u</span></code> and see other information such as the return code</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">sol</span><span class="o">.</span><span class="n">u</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">sol</span><span class="o">.</span><span class="n">retcode</span>
<span class="n">sol</span><span class="o">.</span><span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sol.u = [1.4142135623730951, 1.4142135623730951]
sol.retcode = 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SciMLBase.ReturnCode.Success
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SciMLBase.NLStats
Number of function evaluations:                    7
Number of Jacobians created:                       6
Number of factorizations:                          0
Number of linear solves:                           5
Number of nonlinear solver iterations:             5
</pre></div>
</div>
</div>
</div>
<p>We can see further details on the algorithm itself, and see that it uses <code class="docutils literal notranslate"><span class="pre">ForwardDiff.jl</span></code> by default since <code class="docutils literal notranslate"><span class="pre">NewtonRaphson()</span></code> requires a Jacobian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span><span class="o">.</span><span class="n">alg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoEnzyme(
        mode = ReverseMode()
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)
</pre></div>
</div>
</div>
</div>
<p>You can see the performance of this algorithm in this context, which uses a large number of allocations relative to the simplicity of the problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@benchmark</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="o">$</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">NewtonRaphson</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BenchmarkTools.Trial: 10000 samples with 1 evaluation per sample.
 Range (<span class=" -Color -Color-Bold -Color-Bold-Cyan">min</span> … <span class=" -Color -Color-Magenta">max</span>):  <span class=" -Color -Color-Bold -Color-Bold-Cyan">18.054 μs</span> … <span class=" -Color -Color-Magenta">100.748 μs</span>  ┊ GC (min … max): 0.00% … 0.00%
 Time  (<span class=" -Color -Color-Bold -Color-Bold-Blue">median</span>):     <span class=" -Color -Color-Bold -Color-Bold-Blue">18.935 μs               </span>┊ GC (median):    0.00%
 Time  (<span class=" -Color -Color-Bold -Color-Bold-Green">mean</span> ± <span class=" -Color -Color-Green">σ</span>):   <span class=" -Color -Color-Bold -Color-Bold-Green">19.541 μs</span> ± <span class=" -Color -Color-Green">  3.293 μs</span>  ┊ GC (mean ± σ):  0.00% ± 0.00%

  ▄██<span class=" -Color -Color-Blue">▇</span><span class=" -Color -Color-Green">▆</span>▄▂▁                         ▁                           ▂
  ███<span class=" -Color -Color-Blue">█</span><span class=" -Color -Color-Green">█</span>████▇▆▇▆▄▄▄▄▄▁▃▃▁▁▃▁▁▄▄▃▁▄▆███▇▆▄▆▅▄▃▄▄▄▄▃▁▄▅▄▆▄▅▅▅▄▄▄▄ █
  18.1 μs       Histogram: <span class=" -Color -Color-Bold">log(</span>frequency<span class=" -Color -Color-Bold">)</span> by time      38.3 μs <span class=" -Color -Color-Bold">&lt;</span>

 Memory estimate: <span class=" -Color -Color-Yellow">7.05 KiB</span>, allocs estimate: <span class=" -Color -Color-Yellow">132</span>.
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-parameters-and-inplace-functions">
<h3><span class="section-number">10.4.2. </span>Using Parameters and Inplace Functions<a class="headerlink" href="#using-parameters-and-inplace-functions" title="Permalink to this heading">#</a></h3>
<p>SciML interfaces prefer to cleanly separate a function argument and a parameter argument, which makes it easier to handle parameterized problems and ensure flexible code.</p>
<p>To use this, we rewrite our example above to use the previously ignored parameter <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="n">p</span>
<span class="n">u0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">]</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NonlinearProblem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="c"># pass the `p`</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NonlinearProblem with uType Vector{Float64}. In-place: false
u0: 2-element Vector{Float64}:
 1.0
 1.0
</pre></div>
</div>
</div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">prob</span></code> shows In-place: true.</p>
<p>Benchmarking this version.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="o">$</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">NewtonRaphson</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  10.158 μs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (99 allocations: 6.05 KiB)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element Vector{Float64}:
 1.4142135623730951
 1.4142135623730951
</pre></div>
</div>
</div>
</div>
<p>This may or may not have better performance than the previous version which used the closure.</p>
<p>Regardless, it will still have many allocations, which can be a significant fraction of the runtime for problems small or large.</p>
<p>To support this, the SciML ecosystem has a bias towards in-place functions.  Here we add another version of the function <code class="docutils literal notranslate"><span class="pre">f!(du,</span> <span class="pre">u,</span> <span class="pre">p)</span></code> to be in-place, modifying the first argument, which the solver detects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f!</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="n">du</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="n">p</span>
<span class="k">end</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NonlinearProblem</span><span class="p">(</span><span class="n">f!</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="nd">@btime</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="o">$</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">NewtonRaphson</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9.127 μs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (65 allocations: 4.42 KiB)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element Vector{Float64}:
 1.4142135623730951
 1.4142135623730951
</pre></div>
</div>
</div>
</div>
<p>Note the decrease in allocations, and possibly time depending on your system.</p>
</section>
<section id="patterns-for-parameters">
<h3><span class="section-number">10.4.3. </span>Patterns for Parameters<a class="headerlink" href="#patterns-for-parameters" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">p</span></code> argument can be anything, including named tuples, vectors, or a single value as above.</p>
<p>A common pattern appropriate for more complicated code is to use a named tuple packing and unpacking.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f_nt</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="p">(;</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="c"># unpack any arguments in the named tuple</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="n">c</span>
<span class="k">end</span>

<span class="n">p_nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,)</span><span class="w"> </span><span class="c"># named tuple</span>
<span class="n">prob_nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NonlinearProblem</span><span class="p">(</span><span class="n">f_nt</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">p_nt</span><span class="p">)</span>
<span class="nd">@btime</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="o">$</span><span class="n">prob_nt</span><span class="p">,</span><span class="w"> </span><span class="n">NewtonRaphson</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  10.159 μs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (99 allocations: 6.05 KiB)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element Vector{Float64}:
 1.4142135623730951
 1.4142135623730951
</pre></div>
</div>
</div>
</div>
</section>
<section id="small-systems">
<h3><span class="section-number">10.4.4. </span>Small Systems<a class="headerlink" href="#small-systems" title="Permalink to this heading">#</a></h3>
<p>For small systems, the solver is able to use <a class="reference external" href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a> which can further improve performance.  These fixed-size arrays require using the out-of-place formulation, but otherwise require no special handling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">StaticArrays</span>
<span class="n">f_SA</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="c"># rewrote without broadcasting</span>
<span class="n">u0_static</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">]</span><span class="w"> </span><span class="c"># static array</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NonlinearProblem</span><span class="p">(</span><span class="n">f_SA</span><span class="p">,</span><span class="w"> </span><span class="n">u0_static</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NonlinearProblem with uType SVector{2, Float64}. In-place: false
u0: 2-element SVector{2, Float64} with indices SOneTo(2):
 1.0
 1.0
</pre></div>
</div>
</div>
</div>
<p>Note that the problem shows that this is <code class="docutils literal notranslate"><span class="pre">In-place:</span> <span class="pre">false</span></code> and operates on the <code class="docutils literal notranslate"><span class="pre">SVector{2,</span> <span class="pre">Float64}</span></code> type.</p>
<p>Next we can benchmark this version, where we can use a simpler non-allocating solver designed for small systems, <code class="docutils literal notranslate"><span class="pre">SimpleNewtonRaphson()</span></code>.  See <a class="reference external" href="https://docs.sciml.ai/NonlinearSolve/stable/native/simplenonlinearsolve/">the docs</a> for more details on solvers optimized for non-allocating algorithms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="o">$</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">SimpleNewtonRaphson</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  47.193 ns
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (0 allocations: 0 bytes)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 2-element SVector{2, Float64} with indices SOneTo(2):
 1.414213562373095
 1.414213562373095
</pre></div>
</div>
</div>
</div>
<p>Depending on your system, you may find this is 100 to 1000x faster than the original version using closures and allocations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In principle it should be equivalent to use our previous <code class="docutils literal notranslate"><span class="pre">f</span></code> instead of <code class="docutils literal notranslate"><span class="pre">f_SA</span></code>, but depending on package and compiler versions it may not achieve the full 0 allocations.  Regardless, try the generic function first before porting over to a new function.  The <code class="docutils literal notranslate"><span class="pre">SimpleNewtonRaphson()</span></code> function is also specialized to avoid any internal allocations for small systems, but you will even see some benefits with <code class="docutils literal notranslate"><span class="pre">NewtonRaphson()</span></code>.</p>
</div>
</section>
<section id="using-other-solvers">
<h3><span class="section-number">10.4.5. </span>Using Other Solvers<a class="headerlink" href="#using-other-solvers" title="Permalink to this heading">#</a></h3>
<p>While it has some pre-built solvers, as we used above, it is primarily intended as a meta-package.  To use one of the many <a class="reference external" href="https://docs.sciml.ai/NonlinearSolve/stable/solvers/nonlinear_system_solvers/">external solver packages</a> you simply need to ensure the package is in your Project file and then include it.</p>
<p>For example, we can use the Anderson Acceleration in <a class="reference external" href="https://docs.sciml.ai/NonlinearSolve/stable/api/fixedpointacceleration/">FixedPointAcceleration.jl’s wrapper</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">FixedPointAcceleration</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NonlinearProblem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">u0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="nd">@btime</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="o">$</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">FixedPointAccelerationJL</span><span class="p">())</span>
<span class="nd">@btime</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="o">$</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">FixedPointAccelerationJL</span><span class="p">(;</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">:Simple</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  48.510 μs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (862 allocations: 323.65 KiB)
  2.228 ms
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (21324 allocations: 16.03 MiB)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Failure
u: 2-element Vector{Float64}:
 1.0
 1.0
</pre></div>
</div>
</div>
</div>
<p>The default algorithm in this case is <code class="docutils literal notranslate"><span class="pre">:Anderson</span></code>, but we can also use <code class="docutils literal notranslate"><span class="pre">:Simple</span></code> fixed-point iteration.</p>
<p>In this case, the fixed-point iteration algorithm is slower than the gradient-based Newton-Raphson, but shows the flexibility in cases where gradients are not available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While there is a <a class="reference external" href="https://docs.sciml.ai/NonlinearSolve/stable/api/nlsolve/">NLsolve.jl wrapper</a>, it seems to have a less robust implementation of Anderson than some of the other packages.</p>
</div>
</section>
<section id="bracketing-solvers-and-rootfinding-problems">
<h3><span class="section-number">10.4.6. </span>Bracketing Solvers and Rootfinding Problems<a class="headerlink" href="#bracketing-solvers-and-rootfinding-problems" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NonlinearProblem</span></code> type is intended for algorithms which use an initial condition (and may or may not use derivatives).</p>
<p>For some one-dimensional problems it is more convenient to use one of the <a class="reference external" href="https://docs.sciml.ai/NonlinearSolve/stable/solvers/bracketing_solvers/#bracketing">bracketing methods</a></p>
<p>For example, from the <a class="reference external" href="https://docs.sciml.ai/NonlinearSolve/stable/tutorials/getting_started/#Problem-Type-2:-Solving-Interval-Rootfinding-Problems-with-Bracketing-Methods">documentation</a>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f_bracketed</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span>
<span class="n">uspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="c"># brackets</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntervalNonlinearProblem</span><span class="p">(</span><span class="n">f_bracketed</span><span class="p">,</span><span class="w"> </span><span class="n">uspan</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>retcode: Success
u: 1.4142135623730951
</pre></div>
</div>
</div>
</div>
<p>In general, this should be preferred to using the <code class="docutils literal notranslate"><span class="pre">Roots.jl</span></code> package below, as it may provide a more consistent interface.</p>
</section>
</section>
<section id="systems-of-equations-and-fixed-points">
<h2><a class="toc-backref" href="#id6"><span class="section-number">10.5. </span>Systems of Equations and Fixed Points</a><a class="headerlink" href="#systems-of-equations-and-fixed-points" title="Permalink to this heading">#</a></h2>
<p>Julia has a variety of packages you can directly use for solving systems of equations and finding fixed points.  Many of these packages can also be used as backends for the <code class="docutils literal notranslate"><span class="pre">NonlinearSolve.jl</span></code> meta-package described above.</p>
<section id="roots-jl">
<h3><span class="section-number">10.5.1. </span>Roots.jl<a class="headerlink" href="#roots-jl" title="Permalink to this heading">#</a></h3>
<p>A root of a real function <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\([a,b]\)</span> is an <span class="math notranslate nohighlight">\(x \in [a, b]\)</span> such that <span class="math notranslate nohighlight">\(f(x)=0\)</span>.</p>
<p>For example, if we plot the function</p>
<div class="math notranslate nohighlight" id="equation-root-f">
<span class="eqno">(10.1)<a class="headerlink" href="#equation-root-f" title="Permalink to this equation">#</a></span>\[f(x) = \sin(4 (x - 1/4)) + x + x^{20} - 1\]</div>
<p>with <span class="math notranslate nohighlight">\(x \in [0,1]\)</span> we get</p>
<figure class="align-default">
<img alt="../_images/sine-screenshot-2.png" src="../_images/sine-screenshot-2.png" />
</figure>
<p>The unique root is approximately 0.408.</p>
<p>The <a class="reference external" href="https://github.com/JuliaLang/Roots.jl">Roots.jl</a> package offers <code class="docutils literal notranslate"><span class="pre">fzero()</span></code> to find roots</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Roots</span>
<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="n">fzero</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.40829350427936706
</pre></div>
</div>
</div>
</div>
</section>
<section id="nlsolve-jl">
<h3><span class="section-number">10.5.2. </span>NLsolve.jl<a class="headerlink" href="#nlsolve-jl" title="Permalink to this heading">#</a></h3>
<p>The <a class="reference external" href="https://github.com/JuliaNLSolvers/NLsolve.jl/">NLsolve.jl</a> package provides functions to solve for multivariate systems of equations and fixed points.</p>
<p>From the documentation, to solve for a system of equations without providing a Jacobian</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">NLsolve</span>

<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">18</span>
<span class="w">        </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="c"># returns an array</span>

<span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="mf">1.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Results of Nonlinear Solver Algorithm
 * Algorithm: Trust-region with dogleg and autoscaling
 * Starting Point: [0.1, 1.2]
 * Zero: [-7.775548712324193e-17, 0.9999999999999999]
 * Inf-norm of residuals: 0.000000
 * Iterations: 4
 * Convergence: true
   * |x - x&#39;| &lt; 0.0e+00: false
   * |f(x)| &lt; 1.0e-08: true
 * Function Calls (f): 5
 * Jacobian Calls (df/dx): 5
</pre></div>
</div>
</div>
</div>
<p>In the above case, the algorithm used finite differences to calculate the Jacobian.</p>
<p>Alternatively, if <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> is written generically, you can use auto-differentiation with a single setting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="mf">1.2</span><span class="p">],</span><span class="w"> </span><span class="n">autodiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">:forward</span><span class="p">)</span>

<span class="n">println</span><span class="p">(</span><span class="s">&quot;converged=</span><span class="si">$</span><span class="p">(</span><span class="n">NLsolve</span><span class="o">.</span><span class="n">converged</span><span class="p">(</span><span class="n">results</span><span class="p">))</span><span class="s"> at root=</span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">zero</span><span class="p">)</span><span class="s"> in &quot;</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span><span class="s"> iterations and </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">f_calls</span><span class="p">)</span><span class="s"> function calls&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converged=true at root=[-3.7818049096324184e-16, 1.0000000000000002] in 4 iterations and 5 function calls
</pre></div>
</div>
</div>
</div>
<p>Providing a function which operates inplace (i.e., modifies an argument) may help performance for large systems of equations (and hurt it for small ones).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f!</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># modifies the first argument</span>
<span class="w">    </span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">18</span>
<span class="w">    </span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlsolve</span><span class="p">(</span><span class="n">f!</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="mf">1.2</span><span class="p">],</span><span class="w"> </span><span class="n">autodiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">:forward</span><span class="p">)</span>

<span class="n">println</span><span class="p">(</span><span class="s">&quot;converged=</span><span class="si">$</span><span class="p">(</span><span class="n">NLsolve</span><span class="o">.</span><span class="n">converged</span><span class="p">(</span><span class="n">results</span><span class="p">))</span><span class="s"> at root=</span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">zero</span><span class="p">)</span><span class="s"> in &quot;</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">iterations</span><span class="p">)</span><span class="s"> iterations and </span><span class="si">$</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">f_calls</span><span class="p">)</span><span class="s"> function calls&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converged=true at root=[-3.7818049096324184e-16, 1.0000000000000002] in 4 iterations and 5 function calls
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.12"
        },
        kernelOptions: {
            name: "julia-1.12",
            path: "./more_julia"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.12'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started with Julia
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/getting_started.html">
   1. Setting up Your Julia Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/julia_by_example.html">
   2. Introductory Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/julia_essentials.html">
   3. Julia Essentials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/fundamental_types.html">
   4. Arrays, Tuples, Ranges, and Other Fundamental Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/introduction_to_types.html">
   5. Introduction to Types and Generic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Package Ecosystem
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="generic_programming.html">
   6. Generic Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="auto_differentiation.html">
   7. Automatic Differentiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quadrature_interpolation.html">
   8. Quadrature and Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_statistical_packages.html">
   9. General, Data, and Statistics Packages
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   10. Optimization and Nonlinear Solvers
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Software Engineering
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/tools_editors.html">
   11. Visual Studio Code and Other Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/version_control.html">
   12. GitHub, Version Control and Collaboration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/testing.html">
   13. Packages, Testing, and Continuous Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/need_for_speed.html">
   14. The Need for Speed
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/geom_series.html">
   15. Geometric Series for Elementary Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/linear_algebra.html">
   16. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/orth_proj.html">
   17. Orthogonal Projections and Their Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/lln_clt.html">
   18. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/stationary_densities.html">
   19. Continuous State Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/numerical_linear_algebra.html">
   20. Numerical Linear Algebra and Factorizations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/iterative_methods_sparsity.html">
   21. Krylov Methods and Matrix Conditioning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/scalar_dynam.html">
   22. Dynamics in One Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/ar1_processes.html">
   23. AR1 Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/finite_markov.html">
   24. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/linear_models.html">
   25. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/wealth_dynamics.html">
   26. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/kalman.html">
   27. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/short_path.html">
   28. Shortest Paths
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/mccall_model.html">
   29. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/mccall_model_with_separation.html">
   30. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/wald_friedman.html">
   31. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/odu.html">
   32. Job Search III: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/career.html">
   33. Job Search IV: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/jv.html">
   34. Job Search V: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/optgrowth.html">
   35. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/coleman_policy_iter.html">
   36. Optimal Growth II: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/egm_policy_iter.html">
   37. Optimal Growth III: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/lqcontrol.html">
   38. LQ Dynamic Programming Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/perm_income.html">
   39. Optimal Savings I: The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/perm_income_cons.html">
   40. Optimal Savings II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/smoothing.html">
   41. Consumption and Tax Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/ifp.html">
   42. Optimal Savings III: Occasionally Binding Constraints
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/robustness.html">
   43. Robustness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/discrete_dp.html">
   44. Discrete State Dynamic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Differentiable Economics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../differentiable_economics/differentiable_dynamics.html">
   45. Differentiating Models of Economic Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../differentiable_economics/differentiable_filters.html">
   46. Differentiable Filters
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modeling in Continuous Time
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../continuous_time/seir_model.html">
   47. Modeling COVID 19 with Differential Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../continuous_time/covid_sde.html">
   48. Modeling Shocks in COVID 19 with Stochastic Differential Equations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/schelling.html">
   49. Schelling’s Segregation Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/lake_model.html">
   50. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/rational_expectations.html">
   51. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/markov_perf.html">
   52. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/markov_asset.html">
   53. Asset Pricing I: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/lucas_model.html">
   54. Asset Pricing II: The Lucas Asset Pricing Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/harrison_kreps.html">
   55. Asset Pricing III:  Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/uncertainty_traps.html">
   56. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/aiyagari.html">
   57. The Aiyagari Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/arellano.html">
   58. Default Risk and Income Fluctuations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/matsuyama.html">
   59. Globalization and Cycles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../about_lectures.html">
   60. About these Lectures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../troubleshooting.html">
   61. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../zreferences.html">
   62. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../status.html">
   63. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/more_julia/optimization_solver_packages.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/quantecon/lecture-julia.myst/blob/main/lectures/more_julia/optimization_solver_packages.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/quantecon/lecture-julia.notebooks/blob/main/more_julia/optimization_solver_packages.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/quantecon/lecture-julia.notebooks" data-urlpath="tree/lecture-julia.notebooks/more_julia/optimization_solver_packages.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/quantecon/lecture-julia.notebooks/blob/main/more_julia/optimization_solver_packages.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "more_julia/optimization_solver_packages";
                const repoURL = "https://github.com/quantecon/lecture-julia.notebooks";
                const urlPath = "tree/lecture-julia.notebooks/more_julia/optimization_solver_packages.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>