
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5. Introduction to Types and Generic Programming &#8212; Quantitative Economics with Julia</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/quantecon-book-theme.1ef59f8f4e91ec8319176e8479c6af4e.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">


    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="../_static/quantecon-book-theme.15b0c36fffe88f468997fa7b698991d3.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-svg.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://julia.quantecon.org/getting_started_julia/introduction_to_types.html" />
    <link rel="shortcut icon" href="../_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Generic Programming" href="../more_julia/generic_programming.html" />
    <link rel="prev" title="4. Arrays, Tuples, Ranges, and Other Fundamental Types" href="fundamental_types.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Jesse Perla &amp; Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Julia, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Jesse Perla, Thomas J. Sargent and John Stachurski. The language instruction is Julia. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Introduction to Types and Generic Programming"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Jesse Perla, Thomas J. Sargent and John Stachurski. The language instruction is Julia.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Introduction to Types and Generic Programming" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://julia.quantecon.org/getting_started_julia/introduction_to_types.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Jesse Perla, Thomas J. Sargent and John Stachurski. The language instruction is Julia." />
<meta property="og:site_name" content="Quantitative Economics with Julia" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=getting_started_julia/introduction_to_types>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   5.1. Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-and-interpreting-types">
   5.2. Finding and Interpreting Types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-the-type">
     5.2.1. Finding The Type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parametric-types">
     5.2.2. Parametric Types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-types-and-values">
     5.2.3. Variables, Types, and Values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-type-hierarchy">
   5.3. The Type Hierarchy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#abstract-vs-concrete-types">
     5.3.1. Abstract vs Concrete Types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subtypes-and-supertypes">
     5.3.2. Subtypes and Supertypes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deducing-and-declaring-types">
   5.4. Deducing and Declaring Types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#good-practices-for-functions-and-variable-types">
     5.4.1. Good Practices for Functions and Variable Types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manually-declaring-function-and-variable-types">
     5.4.2. Manually Declaring Function and Variable Types
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-new-types">
   5.5. Creating New Types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#syntax-for-creating-concrete-types">
     5.5.1. Syntax for Creating Concrete Types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#issues-with-type-declarations">
     5.5.2. Issues with Type Declarations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#declaring-parametric-types-advanced">
     5.5.3. Declaring Parametric Types (Advanced)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keyword-argument-constructors-advanced">
     5.5.4. Keyword Argument Constructors (Advanced)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tips-and-tricks-for-writing-generic-functions">
     5.5.5. Tips and Tricks for Writing Generic Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-digression-on-style-and-naming">
     5.5.6. A Digression on Style and Naming
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#commenting-code">
       5.5.6.1. Commenting Code
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-multiple-dispatch">
   5.6. Introduction to Multiple Dispatch
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-dispatch-in-algorithms-advanced">
     5.6.1. Multiple Dispatch in Algorithms (Advanced)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   5.7. Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     5.7.1. Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     5.7.2. Exercise 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3">
     5.7.3. Exercise 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4">
     5.7.4. Exercise 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-5-advanced">
     5.7.5. Exercise 5 (Advanced)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-6-advanced">
     5.7.6. Exercise 6 (Advanced)
    </a>
   </li>
  </ul>
 </li>
</ul>

                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="../_static/qe-logo-large.png" class="logo" alt="logo"></a>
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="../intro.html">Quantitative Economics with Julia</a></p>

                        <p class="qe-page__header-subheading">Introduction to Types and Generic Programming</p>

                    </div>

                    <p class="qe-page__header-authors">Jesse Perla & Thomas J. Sargent & John Stachurski</p>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><div class="tex2jax_ignore mathjax_ignore section" id="introduction-to-types-and-generic-programming">
<h1><a class="toc-backref" href="#id1"><span class="section-number">5. </span>Introduction to Types and Generic Programming</a><a class="headerlink" href="#introduction-to-types-and-generic-programming" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction-to-types-and-generic-programming" id="id1">Introduction to Types and Generic Programming</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id2">Overview</a></p></li>
<li><p><a class="reference internal" href="#finding-and-interpreting-types" id="id3">Finding and Interpreting Types</a></p></li>
<li><p><a class="reference internal" href="#the-type-hierarchy" id="id4">The Type Hierarchy</a></p></li>
<li><p><a class="reference internal" href="#deducing-and-declaring-types" id="id5">Deducing and Declaring Types</a></p></li>
<li><p><a class="reference internal" href="#creating-new-types" id="id6">Creating New Types</a></p></li>
<li><p><a class="reference internal" href="#introduction-to-multiple-dispatch" id="id7">Introduction to Multiple Dispatch</a></p></li>
<li><p><a class="reference internal" href="#exercises" id="id8">Exercises</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id2"><span class="section-number">5.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>In Julia, arrays and tuples are the most important data type for working with numerical data.</p>
<p>In this lecture we give more details on</p>
<ul class="simple">
<li><p>declaring types</p></li>
<li><p>abstract types</p></li>
<li><p>motivation for generic programming</p></li>
<li><p>multiple dispatch</p></li>
<li><p>building user-defined types</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span><span class="p">,</span><span class="w"> </span><span class="n">Statistics</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="finding-and-interpreting-types">
<h2><a class="toc-backref" href="#id3"><span class="section-number">5.2. </span>Finding and Interpreting Types</a><a class="headerlink" href="#finding-and-interpreting-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="finding-the-type">
<h3><span class="section-number">5.2.1. </span>Finding The Type<a class="headerlink" href="#finding-the-type" title="Permalink to this headline">¶</a></h3>
<p>As we have seen in the previous lectures, in Julia all values have a type, which can be queried using the <code class="docutils literal notranslate"><span class="pre">typeof</span></code> function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(1) = Int64
typeof(1.0) = Float64
</pre></div>
</div>
</div>
</div>
<p>The hard-coded values <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">1.0</span></code> are called literals in a programming
language, and the compiler deduces their types (<code class="docutils literal notranslate"><span class="pre">Int64</span></code> and <code class="docutils literal notranslate"><span class="pre">Float64</span></code> respectively in the example above).</p>
<p>You can also query the type of a value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64
</pre></div>
</div>
</div>
</div>
<p>The name <code class="docutils literal notranslate"><span class="pre">x</span></code> binds to the value <code class="docutils literal notranslate"><span class="pre">1</span></code>, created as a literal.</p>
</div>
<div class="section" id="parametric-types">
<h3><span class="section-number">5.2.2. </span>Parametric Types<a class="headerlink" href="#parametric-types" title="Permalink to this headline">¶</a></h3>
<p>(See <a class="reference external" href="https://docs.julialang.org/en/v1/manual/types/#Parametric-Types-1">parametric types documentation</a>).</p>
<p>The next two types use curly bracket notation to express the fact that they are <em>parametric</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="nb">im</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(1.0 + 1im) = ComplexF64
typeof(ones(2, 2)) = Matrix{Float64}
</pre></div>
</div>
</div>
</div>
<p>We will learn more details about <a class="reference internal" href="../more_julia/generic_programming.html"><span class="doc">generic programming</span></a> later, but the key is to interpret the curly brackets as swappable parameters for a given type.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">Array{Float64,</span> <span class="pre">2}</span></code> can be read as</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Array</span></code> is a parametric type representing a dense array, where the first parameter is the type stored, and the second is the number of dimensions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Float64</span></code> is a concrete type declaring that the data stored will be a particular size of floating point.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> is the number of dimensions of that array.</p></li>
</ol>
<p>A concrete type is one where values can be created by the compiler (equivalently, one which can be the result of <code class="docutils literal notranslate"><span class="pre">typeof(x)</span></code> for some object <code class="docutils literal notranslate"><span class="pre">x</span></code>).</p>
<p>Values of a <strong>parametric type</strong> cannot be concretely constructed unless all of the parameters are given (themselves with concrete types).</p>
<p>In the case of <code class="docutils literal notranslate"><span class="pre">Complex{Float64}</span></code></p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Complex</span></code> is an abstract complex number type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Float64</span></code> is a concrete type declaring what the type of the real and imaginary parts of the value should store.</p></li>
</ol>
<p>Another type to consider is the <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> and <code class="docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x) = Tuple{Int64, Float64, String}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tuple{Int64, Float64, String}
</pre></div>
</div>
</div>
</div>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> is the parametric type, and the three parameters are a list of the types of each value.</p>
<p>For a named tuple</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x) = NamedTuple{(:a, :b, :c), Tuple{Int64, Float64, String}}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NamedTuple{(:a, :b, :c), Tuple{Int64, Float64, String}}
</pre></div>
</div>
</div>
</div>
<p>The parametric <code class="docutils literal notranslate"><span class="pre">NamedTuple</span></code> type contains two parameters: first a list of names for each field of the tuple, and second the underlying <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> type to store the values.</p>
<p>Anytime a value is prefixed by a colon, as in the <code class="docutils literal notranslate"><span class="pre">:a</span></code> above, the type is <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> – a special kind of string used by the compiler.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">typeof</span><span class="p">(</span><span class="ss">:a</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Symbol
</pre></div>
</div>
</div>
</div>
<p><strong>Remark:</strong> Note that, by convention, type names use CamelCase –  <code class="docutils literal notranslate"><span class="pre">Array</span></code>, <code class="docutils literal notranslate"><span class="pre">AbstractArray</span></code>, etc.</p>
</div>
<div class="section" id="variables-types-and-values">
<h3><span class="section-number">5.2.3. </span>Variables, Types, and Values<a class="headerlink" href="#variables-types-and-values" title="Permalink to this headline">¶</a></h3>
<p>Since variables and functions are lower case by convention, this can be used to easily identify types when reading code and output.</p>
<p>After assigning a variable name to a value, we can query the type of the
value via the name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x) = Int64
</pre></div>
</div>
</div>
</div>
<p>Thus, <code class="docutils literal notranslate"><span class="pre">x</span></code> is just a symbol bound to a value of type <code class="docutils literal notranslate"><span class="pre">Int64</span></code>.</p>
<p>We can <em>rebind</em> the symbol <code class="docutils literal notranslate"><span class="pre">x</span></code> to any other value, of the same type or otherwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">42.0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42.0
</pre></div>
</div>
</div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">x</span></code> “points to” another value, of type <code class="docutils literal notranslate"><span class="pre">Float64</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Float64
</pre></div>
</div>
</div>
</div>
<p>However, beyond a few notable exceptions (e.g. <code class="docutils literal notranslate"><span class="pre">nothing</span></code> used for <a class="reference internal" href="fundamental_types.html#error-handling"><span class="std std-ref">error handling</span></a>),
changing types is usually a symptom of poorly organized code, and makes
<a class="reference internal" href="#type-inference"><span class="std std-ref">type inference</span></a> more difficult for the compiler.</p>
</div>
</div>
<div class="section" id="the-type-hierarchy">
<h2><a class="toc-backref" href="#id4"><span class="section-number">5.3. </span>The Type Hierarchy</a><a class="headerlink" href="#the-type-hierarchy" title="Permalink to this headline">¶</a></h2>
<p>Let’s discuss how types are organized.</p>
<div class="section" id="abstract-vs-concrete-types">
<h3><span class="section-number">5.3.1. </span>Abstract vs Concrete Types<a class="headerlink" href="#abstract-vs-concrete-types" title="Permalink to this headline">¶</a></h3>
<p>(See <a class="reference external" href="https://docs.julialang.org/en/v1/manual/types/#man-abstract-types-1">abstract types documentation</a>)</p>
<p>Up to this point, most of the types we have worked with (e.g., <code class="docutils literal notranslate"><span class="pre">Float64,</span> <span class="pre">Int64</span></code>) are examples of <strong>concrete types</strong>.</p>
<p>Concrete types are types that we can <em>instantiate</em> – i.e., pair with data in memory.</p>
<p>We will now examine <strong>abstract types</strong> that cannot be instantiated (e.g., <code class="docutils literal notranslate"><span class="pre">Real</span></code>, <code class="docutils literal notranslate"><span class="pre">AbstractFloat</span></code>).</p>
<p>For example, while you will never have a <code class="docutils literal notranslate"><span class="pre">Real</span></code> number directly in memory, the abstract types
help us organize and work with related concrete types.</p>
</div>
<div class="section" id="subtypes-and-supertypes">
<h3><span class="section-number">5.3.2. </span>Subtypes and Supertypes<a class="headerlink" href="#subtypes-and-supertypes" title="Permalink to this headline">¶</a></h3>
<p>How exactly do abstract types organize or relate different concrete types?</p>
<p>In the Julia language specification, the types form a hierarchy.</p>
<p>You can check if a type is a subtype of another with the <code class="docutils literal notranslate"><span class="pre">&lt;:</span></code> operator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="kt">Float64</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Real</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="kt">Int64</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Real</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="kt">Complex</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Real</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="kt">Array</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Real</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Float64 &lt;: Real = true
Int64 &lt;: Real = true
Complex{Float64} &lt;: Real = false
Array &lt;: Real = false
</pre></div>
</div>
</div>
</div>
<p>In the above, both <code class="docutils literal notranslate"><span class="pre">Float64</span></code> and <code class="docutils literal notranslate"><span class="pre">Int64</span></code> are <strong>subtypes</strong> of <code class="docutils literal notranslate"><span class="pre">Real</span></code>, whereas the <code class="docutils literal notranslate"><span class="pre">Complex</span></code> numbers are not.</p>
<p>They are, however, all subtypes of <code class="docutils literal notranslate"><span class="pre">Number</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="kt">Real</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Number</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="kt">Float64</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Number</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="kt">Int64</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Number</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="kt">Complex</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Number</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Real &lt;: Number = true
Float64 &lt;: Number = true
Int64 &lt;: Number = true
Complex{Float64} &lt;: Number = true
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Number</span></code> in turn is a subtype of <code class="docutils literal notranslate"><span class="pre">Any</span></code>, which is a parent of all types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="kt">Number</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Any</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>true
</pre></div>
</div>
</div>
</div>
<p>In particular, the type tree is organized with <code class="docutils literal notranslate"><span class="pre">Any</span></code> at the top and the concrete types at the bottom.</p>
<p>We never actually see <em>instances</em> of abstract types (i.e., <code class="docutils literal notranslate"><span class="pre">typeof(x)</span></code> never returns an abstract type).</p>
<p>The point of abstract types is to categorize the concrete types, as well as other abstract types that sit below them in the hierarchy.</p>
<p>There are some further functions to help you explore the type hierarchy, such as <code class="docutils literal notranslate"><span class="pre">show_supertypes</span></code> which walks up the tree of types to <code class="docutils literal notranslate"><span class="pre">Any</span></code> for a given type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Base</span><span class="o">:</span><span class="w"> </span><span class="n">show_supertypes</span><span class="w">  </span><span class="c"># import the function from the `Base` package</span><span class="w"></span>

<span class="n">show_supertypes</span><span class="p">(</span><span class="kt">Int64</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64 &lt;: Signed &lt;: Integer &lt;: Real &lt;: Number &lt;: Any
</pre></div>
</div>
</div>
</div>
<p>And the <code class="docutils literal notranslate"><span class="pre">subtypes</span></code> which gives a list of the available subtypes for any packages or code currently loaded</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">subtypes</span><span class="p">(</span><span class="kt">Real</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">subtypes</span><span class="p">(</span><span class="kt">AbstractFloat</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>subtypes(Real) = Any[AbstractFloat, AbstractIrrational, Integer, Rational]
subtypes(AbstractFloat) = Any[BigFloat, Float16, Float32, Float64]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="deducing-and-declaring-types">
<span id="type-inference"></span><h2><a class="toc-backref" href="#id5"><span class="section-number">5.4. </span>Deducing and Declaring Types</a><a class="headerlink" href="#deducing-and-declaring-types" title="Permalink to this headline">¶</a></h2>
<p>We will discuss this in detail in <a class="reference internal" href="../more_julia/generic_programming.html"><span class="doc">generic programming</span></a>,
but much of Julia’s performance gains and generality of notation comes from its type system.</p>
<p>For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">]</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x1) = Vector{Int64}
typeof(x2) = Vector{Float64}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vector{Float64} (alias for Array{Float64, 1})
</pre></div>
</div>
</div>
</div>
<p>These return <code class="docutils literal notranslate"><span class="pre">Array{Int64,1}</span></code> and <code class="docutils literal notranslate"><span class="pre">Array{Float64,1}</span></code> respectively, which the compiler is able to infer from the right hand side of the expressions.</p>
<p>Given the information on the type, the compiler can work through the sequence of expressions to infer other types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="n">y</span><span class="w"> </span><span class="c"># define some function</span><span class="w"></span>


<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># call with an integer array - compiler deduces type</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3-element Vector{Int64}:
 2
 4
 6
</pre></div>
</div>
</div>
</div>
<div class="section" id="good-practices-for-functions-and-variable-types">
<h3><span class="section-number">5.4.1. </span>Good Practices for Functions and Variable Types<a class="headerlink" href="#good-practices-for-functions-and-variable-types" title="Permalink to this headline">¶</a></h3>
<p>In order to keep many of the benefits of Julia, you will sometimes want to ensure
the compiler can always deduce a single type from any function or expression.</p>
<p>An example of bad practice is to use an array to hold unrelated types</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">  </span><span class="c"># typically poor style</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3-element Vector{Any}:
 1.0
  &quot;test&quot;
 1
</pre></div>
</div>
</div>
</div>
<p>The type of this array is <code class="docutils literal notranslate"><span class="pre">Array{Any,1}</span></code>, where <code class="docutils literal notranslate"><span class="pre">Any</span></code> means the compiler has determined that any valid Julia type can be added to the array.</p>
<p>While occasionally useful, this is to be avoided whenever possible in performance sensitive code.</p>
<p>The other place this can come up is in the declaration of functions.</p>
<p>As an example, consider a function which returns different types depending on the arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mf">1.0</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c"># probably meant `0.0`</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f(1) = 1.0
f(-1) = 0
</pre></div>
</div>
</div>
</div>
<p>The issue here is relatively subtle:  <code class="docutils literal notranslate"><span class="pre">1.0</span></code> is a floating point, while <code class="docutils literal notranslate"><span class="pre">0</span></code> is an integer.</p>
<p>Consequently, given the type of <code class="docutils literal notranslate"><span class="pre">x</span></code>, the compiler cannot in general determine what type the function will return.</p>
<p>This issue, called <strong>type stability</strong>, is at the heart of most Julia performance considerations.</p>
<p>Luckily, trying to ensure that functions return the same types is also generally consistent with simple, clear code.</p>
</div>
<div class="section" id="manually-declaring-function-and-variable-types">
<h3><span class="section-number">5.4.2. </span>Manually Declaring Function and Variable Types<a class="headerlink" href="#manually-declaring-function-and-variable-types" title="Permalink to this headline">¶</a></h3>
<p>(See <a class="reference external" href="https://docs.julialang.org/en/v1/manual/types/#Type-Declarations-1">type declarations documentation</a>)</p>
<p>You will notice that in the lecture notes we have never directly declared any types.</p>
<p>This is intentional both for exposition and as a best practice for using packages (as opposed to writing new packages, where declaring these types is very important).</p>
<p>It is also in contrast to some of the sample code you will see in other Julia sources, which you will need to be able to read.</p>
<p>To give an example of the declaration of types, the following are equivalent</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.0</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">.+</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="mf">4.0</span><span class="p">])</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2-element Vector{Float64}:
  9.1
 14.3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">},</span><span class="w"> </span><span class="n">A</span><span class="o">::</span><span class="kt">Matrix</span><span class="p">{</span><span class="kt">Float64</span><span class="p">})</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c"># argument and return types</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.0</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">.+</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f2</span><span class="p">([</span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="mf">4.0</span><span class="p">])</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2-element Vector{Float64}:
  9.1
 14.3
</pre></div>
</div>
</div>
</div>
<p>While declaring the types may be verbose, would it ever generate faster code?</p>
<p>The answer is almost never.</p>
<p>Furthermore, it can lead to confusion and inefficiencies since many things that behave like vectors and matrices are not <code class="docutils literal notranslate"><span class="pre">Matrix{Float64}</span></code> and <code class="docutils literal notranslate"><span class="pre">Vector{Float64}</span></code>.</p>
<p>Here, the first line works and the second line fails</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">([</span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">([</span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">],</span><span class="w"> </span><span class="n">Diagonal</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">]))</span><span class="w"></span>

<span class="c"># f2([0.1; 2.0], [1 2; 3 4]) # not a `Float64`</span><span class="w"></span>
<span class="c"># f2([0.1; 2.0], Diagonal([1.0, 2.0])) # not a `Matrix{Float64}`</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f([0.1; 2.0], [1 2; 3 4]) = [9.1, 14.3]
f([0.1; 2.0], Diagonal([1.0, 2.0])) = [5.1, 10.0]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2-element Vector{Float64}:
  5.1
 10.0
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-new-types">
<h2><a class="toc-backref" href="#id6"><span class="section-number">5.5. </span>Creating New Types</a><a class="headerlink" href="#creating-new-types" title="Permalink to this headline">¶</a></h2>
<p>(See <a class="reference external" href="https://docs.julialang.org/en/v1/manual/types/#Type-Declarations-1">type declarations documentation</a>)</p>
<p>Up until now, we have used <code class="docutils literal notranslate"><span class="pre">NamedTuple</span></code> to collect sets of parameters for our models and examples.</p>
<p>These are useful for maintaining values for model parameters,
but you will eventually need to be able to use code that creates its own types.</p>
<div class="section" id="syntax-for-creating-concrete-types">
<h3><span class="section-number">5.5.1. </span>Syntax for Creating Concrete Types<a class="headerlink" href="#syntax-for-creating-concrete-types" title="Permalink to this headline">¶</a></h3>
<p>(See <a class="reference external" href="https://docs.julialang.org/en/v1/manual/types/#Composite-Types-1">composite types documentation</a>)</p>
<p>While other sorts of types exist, we almost always use the <code class="docutils literal notranslate"><span class="pre">struct</span></code> keyword, which is for creation of composite data types</p>
<ul class="simple">
<li><p>“Composite” refers to the fact that the data types in question can be used as collection of named fields.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">struct</span></code> terminology is used in a number of programming languages to refer to composite data types.</p></li>
</ul>
<p>Let’s start with a trivial example where the <code class="docutils literal notranslate"><span class="pre">struct</span></code> we build has fields named <code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c</span></code>, are not typed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="kt">FooNotTyped</span><span class="w">  </span><span class="c"># immutable by default, use `mutable struct` otherwise</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="c"># BAD! not typed</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>And another where the types of the fields are chosen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="kt">Foo</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span><span class="o">::</span><span class="kt">Float64</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="o">::</span><span class="kt">Int64</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>In either case, the compiler generates a function to create new values of the data type, called a “constructor”.</p>
<p>It has the same name as the data type but uses function call notion</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">foo_nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FooNotTyped</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">])</span><span class="w">  </span><span class="c"># new `FooNotTyped`</span><span class="w"></span>
<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">])</span><span class="w"> </span><span class="c"># creates a new `Foo`</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">foo</span><span class="o">.</span><span class="n">a</span><span class="w">       </span><span class="c"># get the value for a field</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">foo</span><span class="o">.</span><span class="n">b</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">foo</span><span class="o">.</span><span class="n">c</span><span class="p">;</span><span class="w"></span>

<span class="c"># foo.a = 2.0     # fails since it is immutable</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(foo) = Foo
foo.a = 2.0
foo.b = 3
foo.c = [1.0, 2.0, 3.0]
</pre></div>
</div>
</div>
</div>
<p>You will notice two differences above for the creation of a <code class="docutils literal notranslate"><span class="pre">struct</span></code> compared to our use of <code class="docutils literal notranslate"><span class="pre">NamedTuple</span></code>.</p>
<ul class="simple">
<li><p>Types are declared for the fields, rather than inferred by the compiler.</p></li>
<li><p>The construction of a new instance has no named parameters to prevent accidental misuse if the wrong order is chosen.</p></li>
</ul>
</div>
<div class="section" id="issues-with-type-declarations">
<h3><span class="section-number">5.5.2. </span>Issues with Type Declarations<a class="headerlink" href="#issues-with-type-declarations" title="Permalink to this headline">¶</a></h3>
<p>Was it necessary to manually declare the types <code class="docutils literal notranslate"><span class="pre">a::Float64</span></code> in the above struct?</p>
<p>The answer, in practice, is usually yes.</p>
<p>Without a declaration of the type, the compiler is unable to generate efficient code, and the use of a <code class="docutils literal notranslate"><span class="pre">struct</span></code> declared without types could drop performance by orders of magnitude.</p>
<p>Moreover, it is very easy to use the wrong type, or unnecessarily constrain the types.</p>
<p>The first example, which is usually just as low-performance as no declaration of types at all, is to accidentally declare it with an abstract type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="kt">Foo2</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span><span class="o">::</span><span class="kt">Float64</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="o">::</span><span class="kt">Integer</span><span class="w">  </span><span class="c"># BAD! Not a concrete type</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Real</span><span class="p">}</span><span class="w">  </span><span class="c"># BAD! Not a concrete type</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>The second issue is that by choosing a type (as in the <code class="docutils literal notranslate"><span class="pre">Foo</span></code> above), you may
be unnecessarily constraining what is allowed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="c"># use the type</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">]</span><span class="w"></span>
<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w">   </span><span class="c"># call with the foo, no problem</span><span class="w"></span>

<span class="c"># some other typed for the values</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="c"># not a floating point but `f()` would work</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">]</span><span class="o">&#39;</span><span class="w">   </span><span class="c"># transpose is not a `Vector` but `f()` would work</span><span class="w"></span>
<span class="c"># foo = Foo(a, b, c)   # fails to compile</span><span class="w"></span>

<span class="c"># works with `NotTyped` version, but low performance</span><span class="w"></span>
<span class="n">foo_nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FooNotTyped</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">foo_nt</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f(foo) = 11.0
f(foo_nt) = 11.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="declaring-parametric-types-advanced">
<h3><span class="section-number">5.5.3. </span>Declaring Parametric Types (Advanced)<a class="headerlink" href="#declaring-parametric-types-advanced" title="Permalink to this headline">¶</a></h3>
<p>(See <a class="reference external" href="https://docs.julialang.org/en/v1/manual/types/#Parametric-Types-1">type parametric types documentation</a>)</p>
<p>Motivated by the above, we can create a type which can adapt to holding fields of different types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="kt">Foo3</span><span class="p">{</span><span class="kt">T1</span><span class="p">,</span><span class="w"> </span><span class="kt">T2</span><span class="p">,</span><span class="w"> </span><span class="kt">T3</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span><span class="o">::</span><span class="kt">T1</span><span class="w">   </span><span class="c"># could be any type</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="o">::</span><span class="kt">T2</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="o">::</span><span class="kt">T3</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="c"># works fine</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">]</span><span class="o">&#39;</span><span class="w">    </span><span class="c"># transpose is not a `Vector` but `f()` would work</span><span class="w"></span>
<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w"></span>
<span class="n">f</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(foo) = Foo3{Int64, Int64, Adjoint{Float64, Vector{Float64}}}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.0
</pre></div>
</div>
</div>
</div>
<p>Of course, this is probably too flexible, and the <code class="docutils literal notranslate"><span class="pre">f</span></code> function might not work on an arbitrary set of <code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c</span></code>.</p>
<p>You could constrain the types based on the abstract parent type using the <code class="docutils literal notranslate"><span class="pre">&lt;:</span></code> operator</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="kt">Foo4</span><span class="p">{</span><span class="kt">T1</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Real</span><span class="p">,</span><span class="w"> </span><span class="kt">T2</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Real</span><span class="p">,</span><span class="w"> </span><span class="kt">T3</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">AbstractVecOrMat</span><span class="p">{</span><span class="o">&lt;:</span><span class="kt">Real</span><span class="p">}}</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span><span class="o">::</span><span class="kt">T1</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="o">::</span><span class="kt">T2</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="o">::</span><span class="kt">T3</span><span class="w">  </span><span class="c"># should check dimensions as well</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo4</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w">  </span><span class="c"># no problem, and high performance</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w"></span>
<span class="n">f</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(foo) = Foo4{Int64, Int64, Adjoint{Float64, Vector{Float64}}}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.0
</pre></div>
</div>
</div>
</div>
<p>This ensures that</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are a subtype of <code class="docutils literal notranslate"><span class="pre">Real</span></code>, and <code class="docutils literal notranslate"><span class="pre">+</span></code> in the definition of <code class="docutils literal notranslate"><span class="pre">f</span></code> works</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> is a one dimensional abstract array of <code class="docutils literal notranslate"><span class="pre">Real</span></code> values</p></li>
</ul>
<p>The code works, and is equivalent in performance to a <code class="docutils literal notranslate"><span class="pre">NamedTuple</span></code>, but is more verbose and error prone.</p>
</div>
<div class="section" id="keyword-argument-constructors-advanced">
<h3><span class="section-number">5.5.4. </span>Keyword Argument Constructors (Advanced)<a class="headerlink" href="#keyword-argument-constructors-advanced" title="Permalink to this headline">¶</a></h3>
<p>There is no way to avoid learning parametric types to achieve high performance code.</p>
<p>However, the other issue where constructor arguments are error-prone can be
remedied with the <code class="docutils literal notranslate"><span class="pre">&#64;kwdef</span></code> macro from <code class="docutils literal notranslate"><span class="pre">Base</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Base</span><span class="o">:</span><span class="w"> </span><span class="nd">@kwdef</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">Parameters</span><span class="w"></span>

<span class="nd">@kwdef</span><span class="w"> </span><span class="k">struct</span> <span class="kt">Foo5</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span><span class="o">::</span><span class="kt">Float64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w">     </span><span class="c"># adds default value</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="o">::</span><span class="kt">Int64</span><span class="w"></span>
<span class="w">    </span><span class="n">c</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo5</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">])</span><span class="w"></span>
<span class="n">foo2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo5</span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">],</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="c"># rearrange order, uses default values</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">foo</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">foo2</span><span class="w"></span>

<span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="nd">@unpack</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w">     </span><span class="c"># can use `@unpack` on any struct</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">f</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>foo = Foo5(0.1, 2, [1.0, 2.0, 3.0])
foo2 = Foo5(2.0, 2, [1.0, 2.0, 3.0])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.1
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tips-and-tricks-for-writing-generic-functions">
<span id="generic-tips-tricks"></span><h3><span class="section-number">5.5.5. </span>Tips and Tricks for Writing Generic Functions<a class="headerlink" href="#tips-and-tricks-for-writing-generic-functions" title="Permalink to this headline">¶</a></h3>
<p>As discussed in the previous sections, there is major advantage to never declaring a type unless it is absolutely necessary.</p>
<p>The main place where it is necessary is designing code around <a class="reference internal" href="#intro-multiple-dispatch"><span class="std std-ref">multiple dispatch</span></a>.</p>
<p>If you are careful to write code that doesn’t unnecessarily assume types,
you will both achieve higher performance and allow seamless use of a
number of powerful libraries such as
<a class="reference external" href="https://github.com/JuliaDiff/ForwardDiff.jl">auto-differentiation</a>,
<a class="reference external" href="https://github.com/JuliaArrays/StaticArrays.jl">static arrays</a>,
<a class="reference external" href="https://github.com/JuliaGPU/CuArrays.jl">GPUs</a>,
<a class="reference external" href="https://github.com/JuliaIntervals/IntervalRootFinding.jl">interval arithmetic and root finding</a>,
<a class="reference external" href="https://docs.julialang.org/en/v1/manual/integers-and-floating-point-numbers/index.html#Arbitrary-Precision-Arithmetic-1">arbitrary precision numbers</a>,
and many more packages – including ones that have not even been written yet.</p>
<p>A few simple programming patterns ensure that this is possible</p>
<ul class="simple">
<li><p>Do not declare types when declaring variables or functions unless necessary.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># BAD</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.1</span><span class="p">]</span><span class="w"></span>

<span class="k">function</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">})</span><span class="w">   </span><span class="c"># not generic!</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w">   </span><span class="c"># not generic, hidden float!</span><span class="w"></span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Diagonal</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="w">  </span><span class="c"># not generic, hidden float!</span><span class="w"></span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>

<span class="c"># GOOD</span><span class="w"></span>
<span class="k">function</span><span class="w"> </span><span class="n">g2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c"># or `x::AbstractVector`</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">similar</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I</span><span class="w"></span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w">  </span><span class="c"># or `fill(one(x), length(x))`</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">g2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3-element Vector{Float64}:
 6.0
 7.0
 3.1
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Preallocate related vectors with <code class="docutils literal notranslate"><span class="pre">similar</span></code> where possible, and use <code class="docutils literal notranslate"><span class="pre">eltype</span></code> or <code class="docutils literal notranslate"><span class="pre">typeof</span></code>. This is important when using Multiple Dispatch given the different input types the function can call</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">similar</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">eachindex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="w">      </span><span class="c"># could broadcast</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">g</span><span class="p">([</span><span class="kt">BigInt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="kt">BigInt</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2-element Vector{BigInt}:
 1
 4
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">typeof</span></code> or <code class="docutils literal notranslate"><span class="pre">eltype</span></code> to declare a type</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">])</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">eltype</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof([1.0, 2.0, 3.0]) = Vector{Float64}
eltype([1.0, 2.0, 3.0]) = Float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Beware of hidden floating points</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="kt">Int64</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">zeros</span><span class="p">(</span><span class="kt">Int64</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(ones(3)) = Vector{Float64}
typeof(ones(Int64, 3)) = Vector{Int64}
typeof(zeros(3)) = Vector{Float64}
typeof(zeros(Int64, 3)) = Vector{Int64}
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">one</span></code> and <code class="docutils literal notranslate"><span class="pre">zero</span></code> to write generic code</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="kt">BigFloat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">one</span><span class="p">(</span><span class="kt">BigFloat</span><span class="p">))</span><span class="w">  </span><span class="c"># gets multiplicative identity, passing in type</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">zero</span><span class="p">(</span><span class="kt">BigFloat</span><span class="p">))</span><span class="w"></span>

<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">BigFloat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">one</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w">  </span><span class="c"># can call with a variable for convenience</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">zero</span><span class="p">(</span><span class="n">x</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(1) = Int64
typeof(1.0) = Float64
typeof(BigFloat(1.0)) = BigFloat
typeof(one(BigFloat)) = BigFloat
typeof(zero(BigFloat)) = BigFloat
typeof(one(x)) = BigFloat
typeof(zero(x)) = BigFloat
</pre></div>
</div>
</div>
</div>
<p>This last example is a subtle, because of something called <a class="reference external" href="https://docs.julialang.org/en/v1/manual/conversion-and-promotion/#Promotion-1">type promotion</a></p>
<ul class="simple">
<li><p>Assume reasonable type promotion exists for numeric types</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># ACCEPTABLE</span><span class="w"></span>
<span class="k">function</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">AbstractFloat</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0</span><span class="w">   </span><span class="c"># assumes `1.0` can be converted to something compatible with `typeof(x)`</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">BigFloat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">));</span><span class="w">  </span><span class="c"># this has &quot;promoted&quot; the `1.0` to a `BigFloat`</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(g(x)) = BigFloat
</pre></div>
</div>
</div>
</div>
<p>But sometimes assuming promotion is not enough</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># BAD</span><span class="w"></span>
<span class="k">function</span><span class="w"> </span><span class="n">g2</span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">AbstractFloat</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="w">   </span><span class="c"># can&#39;t efficiently call with `x::Integer`</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0</span><span class="w">   </span><span class="c"># OK - assumes you can promote `Float64` to `AbstractFloat`</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="c"># BAD! Returns a `Int64`</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">BigFloat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>
<span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">BigFloat</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">g2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">g2</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span><span class="w">  </span><span class="c"># type unstable</span><span class="w"></span>

<span class="c"># GOOD</span><span class="w"></span>
<span class="k">function</span><span class="w"> </span><span class="n">g3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c">#</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">zero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">   </span><span class="c"># any type with an additive identity</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c"># more general but less important of a change</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">zero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">g3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">g3</span><span class="p">(</span><span class="n">x2</span><span class="p">));</span><span class="w">  </span><span class="c"># type stable</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(g2(x)) = BigFloat
typeof(g2(x2)) = Int64
typeof(g3(x)) = BigFloat
typeof(g3(x2)) = BigFloat
</pre></div>
</div>
</div>
</div>
<p>These patterns are relatively straightforward, but generic programming can be thought of
as a Leontief production function:  if <em>any</em> of the functions you write or call are not
precise enough, then it may break the chain.</p>
<p>This is all the more reason to exploit carefully designed packages rather than “do-it-yourself”.</p>
</div>
<div class="section" id="a-digression-on-style-and-naming">
<h3><span class="section-number">5.5.6. </span>A Digression on Style and Naming<a class="headerlink" href="#a-digression-on-style-and-naming" title="Permalink to this headline">¶</a></h3>
<p>The previous section helps to establish some of the reasoning behind the style
choices in these lectures: “be aware of types, but avoid declaring them”.</p>
<p>The purpose of this is threefold:</p>
<ul class="simple">
<li><p>Provide easy to read code with minimal “syntactic noise” and a clear correspondence to the math.</p></li>
<li><p>Ensure that code is sufficiently generic to exploit other packages and types.</p></li>
<li><p>Avoid common mistakes and unnecessary performance degradations.</p></li>
</ul>
<p>This is just one of many decisions and patterns to ensure that your code is consistent and clear.</p>
<p>The best resource is to carefully read other peoples code, but a few sources to review are</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.julialang.org/en/v1/manual/style-guide/">Julia Style Guide</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/invenia/BlueStyle">Invenia Blue Style Guide</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/JuliaPraxis/Naming/tree/master/guides">Julia Praxis Naming Guides</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/QuantEcon/lecture-source-jl/blob/master/style.md">QuantEcon Style Guide</a> used in these lectures.</p></li>
</ul>
<p>Now why would we emphasize naming and style as a crucial part of the lectures?</p>
<p>Because it is an essential tool for creating research that is
<strong>reproducible</strong> and <a class="reference external" href="https://en.wikipedia.org/wiki/Correctness_%28computer_science%29"><strong>correct</strong></a>.</p>
<p>Some helpful ways to think about this are</p>
<ul class="simple">
<li><p><strong>Clearly written code is easier to review for errors</strong>: The first-order
concern of any code is that it correctly implements the whiteboard math.</p></li>
<li><p><strong>Code is read many more times than it is written</strong>: Saving a few keystrokes
in typing a variable name is never worth it, nor is a divergence from the
mathematical notation where a single symbol for a variable name would map better to the model.</p></li>
<li><p><strong>Write code to be read in the future, not today</strong>: If you are not sure
anyone else will read the code, then write it for an ignorant future version
of yourself who may have forgotten everything, and is likely to misuse the code.</p></li>
<li><p><strong>Maintain the correspondence between the whiteboard math and the code</strong>:
For example, if you change notation in your model, then immediately update
all variables in the code to reflect it.</p></li>
</ul>
<div class="section" id="commenting-code">
<h4><span class="section-number">5.5.6.1. </span>Commenting Code<a class="headerlink" href="#commenting-code" title="Permalink to this headline">¶</a></h4>
<p>One common mistake people make when trying to apply these goals is to add in a large number of comments.</p>
<p>Over the years, developers have found that excess comments in code (and <em>especially</em> big comment headers used before every function declaration) can make code <em>harder</em> to read.</p>
<p>The issue is one of syntactic noise: if most of the comments are redundant given clear variable and function names, then the comments make it more difficult to mentally parse and read the code.</p>
<p>If you examine Julia code in packages and the core language, you will see a great amount of care taken in function and variable names, and comments are only added where helpful.</p>
<p>For creating packages that you intend others to use, instead of a comment header, you should use <a class="reference external" href="https://docs.julialang.org/en/v1/manual/documentation/index.html#Syntax-Guide-1">docstrings</a>.</p>
</div>
</div>
</div>
<div class="section" id="introduction-to-multiple-dispatch">
<span id="intro-multiple-dispatch"></span><h2><a class="toc-backref" href="#id7"><span class="section-number">5.6. </span>Introduction to Multiple Dispatch</a><a class="headerlink" href="#introduction-to-multiple-dispatch" title="Permalink to this headline">¶</a></h2>
<p>One of the defining features of Julia is <strong>multiple dispatch</strong>, whereby the same function name can do different things depending on the underlying types.</p>
<p>Without realizing it, in nearly every function call within packages or the standard library you have used this feature.</p>
<p>To see this in action, consider the absolute value function <code class="docutils literal notranslate"><span class="pre">abs</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">   </span><span class="c"># `Int64`</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="w">  </span><span class="c"># `Float64`</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="mf">0.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="nb">im</span><span class="p">);</span><span class="w">  </span><span class="c"># `Complex{Float64}`</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>abs(-1) = 1
abs(-1.0) = 1.0
abs(0.0 - 1.0im) = 1.0
</pre></div>
</div>
</div>
</div>
<p>In all of these cases, the <code class="docutils literal notranslate"><span class="pre">abs</span></code> function has specialized code depending on the type passed in.</p>
<p>To do this, a function specifies different <strong>methods</strong> which operate on a particular set of types.</p>
<p>Unlike most cases we have seen before, this requires a type annotation.</p>
<p>To rewrite the <code class="docutils literal notranslate"><span class="pre">abs</span></code> function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">ourabs</span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">Real</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">zero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">   </span><span class="c"># note, not 0!</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="k">function</span><span class="w"> </span><span class="n">ourabs</span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">Complex</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">sqrt</span><span class="p">(</span><span class="n">real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">imag</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">ourabs</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">   </span><span class="c"># `Int64`</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">ourabs</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="c"># `Float64`</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">ourabs</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.0</span><span class="nb">im</span><span class="p">);</span><span class="w">  </span><span class="c"># `Complex{Float64}`</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ourabs(-1) = 1
ourabs(-1.0) = 1.0
ourabs(1.0 - 2.0im) = 2.23606797749979
</pre></div>
</div>
</div>
</div>
<p>Note that in the above, <code class="docutils literal notranslate"><span class="pre">x</span></code> works for any type of <code class="docutils literal notranslate"><span class="pre">Real</span></code>, including <code class="docutils literal notranslate"><span class="pre">Int64</span></code>, <code class="docutils literal notranslate"><span class="pre">Float64</span></code>, and ones you may not have realized exist</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="o">//</span><span class="mi">3</span><span class="w">  </span><span class="c"># `Rational` number, -2/3</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">ourabs</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x) = Rational{Int64}
ourabs(x) = 2//3
</pre></div>
</div>
</div>
</div>
<p>You will also note that we used an abstract type, <code class="docutils literal notranslate"><span class="pre">Real</span></code>, and an incomplete
parametric type, <code class="docutils literal notranslate"><span class="pre">Complex</span></code>, when defining the above functions.</p>
<p>Unlike the creation of <code class="docutils literal notranslate"><span class="pre">struct</span></code> fields, there is no penalty in using abstract
types when you define function parameters, as they are used purely to determine which version of a function to use.</p>
<div class="section" id="multiple-dispatch-in-algorithms-advanced">
<h3><span class="section-number">5.6.1. </span>Multiple Dispatch in Algorithms (Advanced)<a class="headerlink" href="#multiple-dispatch-in-algorithms-advanced" title="Permalink to this headline">¶</a></h3>
<p>If you want an algorithm to have specialized versions when given different input types, you need to declare the types for the function inputs.</p>
<p>As an example where this could come up, assume that we have some grid <code class="docutils literal notranslate"><span class="pre">x</span></code> of values, the results of a function <code class="docutils literal notranslate"><span class="pre">f</span></code> applied at those values, and want to calculate an approximate derivative using forward differences.</p>
<p>In that case, given <span class="math notranslate nohighlight">\(x_n, x_{n+1}, f(x_n)\)</span> and <span class="math notranslate nohighlight">\(f(x_{n+1})\)</span>, the forward-difference approximation of the derivative is</p>
<div class="math notranslate nohighlight">
\[
f'(x_n) \approx \frac{f(x_{n+1}) - f(x_n)}{x_{n+1} - x_n}
\]</div>
<p>To implement this calculation for a vector of inputs, we notice that there is a specialized implementation if the grid is uniform.</p>
<p>The uniform grid can be implemented using an <code class="docutils literal notranslate"><span class="pre">AbstractRange</span></code>, which we can analyze with
<code class="docutils literal notranslate"><span class="pre">typeof</span></code>, <code class="docutils literal notranslate"><span class="pre">supertype</span></code> and <code class="docutils literal notranslate"><span class="pre">show_supertypes</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="n">x_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="mi">20</span><span class="w">   </span><span class="c"># if integers</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">supertype</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x) = StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}
typeof(x_2) = StepRange{Int64, Int64}
supertype(typeof(x)) = AbstractRange{Float64}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AbstractRange{Float64}
</pre></div>
</div>
</div>
</div>
<p>To see the entire tree about a particular type, use <code class="docutils literal notranslate"><span class="pre">show_supertypes</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">show_supertypes</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w">  </span><span class="c"># or typeof(x) |&gt; show_supertypes</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64} &lt;: AbstractRange{Float64} &lt;: AbstractVector{Float64} &lt;: Any
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">show_supertypes</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>StepRange{Int64, Int64} &lt;: OrdinalRange{Int64, Int64} &lt;: AbstractRange{Int64} &lt;: AbstractVector{Int64} &lt;: Any
</pre></div>
</div>
</div>
</div>
<p>The types of the range objects can be very complicated, but are both subtypes of <code class="docutils literal notranslate"><span class="pre">AbstractRange</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">AbstractRange</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">AbstractRange</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x) &lt;: AbstractRange = true
typeof(x_2) &lt;: AbstractRange = true
</pre></div>
</div>
</div>
</div>
<p>While you may not know the exact concrete type, any <code class="docutils literal notranslate"><span class="pre">AbstractRange</span></code> has an informal set of operations that are available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span><span class="w"> </span><span class="n">minimum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>minimum(x) = 0.0
maximum(x) = 1.0
length(x) = 20
step(x) = 0.05263157894736842
</pre></div>
</div>
</div>
</div>
<p>Similarly, there are a number of operations available for any <code class="docutils literal notranslate"><span class="pre">AbstractVector</span></code>, such as <code class="docutils literal notranslate"><span class="pre">length</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="w"></span>
<span class="n">f_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c"># calculating at the range values</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">f_x</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">supertype</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">f_x</span><span class="p">))</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">supertype</span><span class="p">(</span><span class="n">supertype</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">f_x</span><span class="p">)))</span><span class="w">  </span><span class="c"># walk up tree again!</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">f_x</span><span class="p">);</span><span class="w">   </span><span class="c"># and many more</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(f_x) = Vector{Float64}
supertype(typeof(f_x)) = DenseVector{Float64}
supertype(supertype(typeof(f_x))) = AbstractVector{Float64}
length(f_x) = 20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">show_supertypes</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">f_x</span><span class="p">))</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vector{Float64} &lt;: DenseVector{Float64} &lt;: AbstractVector{Float64} &lt;: Any
</pre></div>
</div>
</div>
</div>
<p>There are also many functions that can use any <code class="docutils literal notranslate"><span class="pre">AbstractArray</span></code>, such as <code class="docutils literal notranslate"><span class="pre">diff</span></code>.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">diff</span><span class="w"></span>

<span class="n">search</span><span class="o">:</span><span class="w"> </span><span class="n">diff</span><span class="w"> </span><span class="n">symdiff</span><span class="w"> </span><span class="n">setdiff</span><span class="w"> </span><span class="n">symdiff!</span><span class="w"> </span><span class="n">setdiff!</span><span class="w"> </span><span class="kt">Cptrdiff_t</span><span class="w"></span>

<span class="n">diff</span><span class="p">(</span><span class="n">A</span><span class="o">::</span><span class="kt">AbstractVector</span><span class="p">)</span><span class="w"> </span><span class="c"># finite difference operator of matrix or vector A</span><span class="w"></span>

<span class="c"># if A is a matrix, specify the dimension over which to operate with the dims keyword argument</span><span class="w"></span>
<span class="n">diff</span><span class="p">(</span><span class="n">A</span><span class="o">::</span><span class="kt">AbstractMatrix</span><span class="p">;</span><span class="w"> </span><span class="n">dims</span><span class="o">::</span><span class="kt">Integer</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>Hence, we can call this function for anything of type <code class="docutils literal notranslate"><span class="pre">AbstractVector</span></code>.</p>
<p>Finally, we can make a high performance specialization for any <code class="docutils literal notranslate"><span class="pre">AbstractVector</span></code> and <code class="docutils literal notranslate"><span class="pre">AbstractRange</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">slopes</span><span class="p">(</span><span class="n">f_x</span><span class="o">::</span><span class="kt">AbstractVector</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">::</span><span class="kt">AbstractRange</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">f_x</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>slopes (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p>We can use auto-differentiation to compare the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Plots</span><span class="p">,</span><span class="w"> </span><span class="n">ForwardDiff</span><span class="w"></span>


<span class="c"># operator to get the derivative of this function using AD</span><span class="w"></span>
<span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ForwardDiff</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"></span>

<span class="c"># compare slopes with AD for sin(x)</span><span class="w"></span>
<span class="n">q</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mf">4.0</span><span class="w"></span>
<span class="n">q_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="n">q_slopes_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slopes</span><span class="p">(</span><span class="n">q_x</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"></span>

<span class="n">D_q_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c"># broadcasts AD across vector</span><span class="w"></span>

<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">D_q_x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;q&#39; with AD&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">q_slopes_x</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;q slopes&quot;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/introduction_to_types_94_0.svg" src="../_images/introduction_to_types_94_0.svg" /></div>
</div>
<p>Consider a variation where we pass a function instead of an <code class="docutils literal notranslate"><span class="pre">AbstractArray</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">slopes</span><span class="p">(</span><span class="n">f</span><span class="o">::</span><span class="kt">Function</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">::</span><span class="kt">AbstractRange</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c"># broadcast function</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Function</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">AbstractRange</span><span class="w"></span>
<span class="n">q_slopes_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slopes</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c"># use slopes(f::Function, x)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">q_slopes_x</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(q) &lt;: Function = true
typeof(x) &lt;: AbstractRange = true
q_slopes_x[1] = 0.9983341664682815
</pre></div>
</div>
</div>
</div>
<p>Finally, if <code class="docutils literal notranslate"><span class="pre">x</span></code> was an <code class="docutils literal notranslate"><span class="pre">AbstractArray</span></code> and not an <code class="docutils literal notranslate"><span class="pre">AbstractRange</span></code> we can no longer use a uniform step.</p>
<p>For this, we add in a version calculating slopes with forward first-differences</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># broadcasts over the diff</span><span class="w"></span>
<span class="n">slopes</span><span class="p">(</span><span class="n">f</span><span class="o">::</span><span class="kt">Function</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">::</span><span class="kt">AbstractArray</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>

<span class="n">x_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c"># convert range to array</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">AbstractArray</span><span class="w"></span>
<span class="n">q_slopes_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slopes</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">x_array</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">q_slopes_x</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>typeof(x_array) &lt;: AbstractArray = true
q_slopes_x[1] = 0.9983341664682815
</pre></div>
</div>
</div>
</div>
<p>In the final example, we see that it is able to use specialized implementations over both the <code class="docutils literal notranslate"><span class="pre">f</span></code> and the <code class="docutils literal notranslate"><span class="pre">x</span></code> arguments.</p>
<p>This is the “multiple” in multiple dispatch.</p>
</div>
</div>
<div class="section" id="exercises">
<h2><a class="toc-backref" href="#id8"><span class="section-number">5.7. </span>Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-1">
<h3><span class="section-number">5.7.1. </span>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<p>Explore the package <a class="reference external" href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a>.</p>
<ul class="simple">
<li><p>Describe two abstract types and the hierarchy of three different concrete types.</p></li>
<li><p>Benchmark the calculation of some simple linear algebra with a static array
compared to the following for a dense array for <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">3</span></code> and <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">15</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">BenchmarkTools</span><span class="w"></span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"></span>

<span class="nd">@btime</span><span class="w"> </span><span class="o">$</span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">$</span><span class="n">x</span><span class="w">  </span><span class="c"># the $ in front of variable names is sometimes important</span><span class="w"></span>
<span class="nd">@btime</span><span class="w"> </span><span class="n">inv</span><span class="p">(</span><span class="o">$</span><span class="n">A</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  70.055 ns (1 allocation: 80 bytes)
  663.265 ns (4 allocations: 1.86 KiB)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3×3 Matrix{Float64}:
  0.0238361   1.13692  -0.187944
  2.78837    -2.17737  -0.484277
 -3.35428     1.65018   1.94943
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-2">
<h3><span class="section-number">5.7.2. </span>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>A key step in the calculation of the Kalman Filter is calculation of the Kalman gain, as can be seen with the following example using dense matrices from <a class="reference internal" href="../tools_and_techniques/kalman.html"><span class="doc">the Kalman lecture</span></a>.</p>
<p>Using what you learned from Exercise 1, benchmark this using Static Arrays</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Σ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.4</span><span class="w">  </span><span class="mf">0.3</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="mf">0.3</span><span class="w">  </span><span class="mf">0.45</span><span class="p">]</span><span class="w"></span>
<span class="n">G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I</span><span class="w"></span>
<span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Σ</span><span class="w"></span>

<span class="n">gain</span><span class="p">(</span><span class="n">Σ</span><span class="p">,</span><span class="w"> </span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Σ</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">G</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inv</span><span class="p">(</span><span class="n">G</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Σ</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">G</span><span class="o">&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="w"></span>
<span class="nd">@btime</span><span class="w"> </span><span class="n">gain</span><span class="p">(</span><span class="o">$</span><span class="n">Σ</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">R</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  792.732 ns (9 allocations: 1.77 KiB)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2×2 Matrix{Float64}:
 0.666667     1.11022e-16
 1.11022e-16  0.666667
</pre></div>
</div>
</div>
</div>
<p>How many times faster are static arrays in this example?</p>
</div>
<div class="section" id="exercise-3">
<h3><span class="section-number">5.7.3. </span>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://github.com/JuliaMath/Polynomials.jl">Polynomial.jl</a> provides a package for simple univariate Polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Polynomials</span><span class="w"></span>

<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Polynomial</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="ss">:x</span><span class="p">)</span><span class="w">  </span><span class="c"># :x just gives a symbol for display</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">p</span><span class="w"></span>
<span class="n">p′</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">derivative</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w">   </span><span class="c"># gives the derivative of p, another polynomial</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span><span class="w"> </span><span class="n">p′</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="w">  </span><span class="c"># call like a function</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">roots</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w">   </span><span class="c"># find roots such that p(x) = 0</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p = Polynomial(2 - 5*x + 2*x^2)
(p(0.1), p′(0.1)) = (1.52, -4.6)
roots(p) = [0.5, 2.0]
</pre></div>
</div>
</div>
</div>
<p>Plot both <code class="docutils literal notranslate"><span class="pre">p(x)</span></code> and <code class="docutils literal notranslate"><span class="pre">p′(x)</span></code> for <span class="math notranslate nohighlight">\(x \in [-2, 2]\)</span>.</p>
</div>
<div class="section" id="exercise-4">
<h3><span class="section-number">5.7.4. </span>Exercise 4<a class="headerlink" href="#exercise-4" title="Permalink to this headline">¶</a></h3>
<p>Use your solution to Exercise 8(a/b) in <a class="reference internal" href="julia_by_example.html"><span class="doc">Introductory Examples</span></a> to
create a specialized version of Newton’s method for <code class="docutils literal notranslate"><span class="pre">Polynomials</span></code> using the <code class="docutils literal notranslate"><span class="pre">derivative</span></code> function.</p>
<p>The signature of the function should be <code class="docutils literal notranslate"><span class="pre">newtonsmethod(p::Polynomial,</span> <span class="pre">x_0;</span> <span class="pre">tolerance</span> <span class="pre">=</span> <span class="pre">1E-7,</span> <span class="pre">maxiter</span> <span class="pre">=</span> <span class="pre">100)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">p::Polynomial</span></code> ensures that this version of the function will be used anytime a polynomial is passed (i.e. dispatch).</p>
<p>Compare the results of this function to the built-in <code class="docutils literal notranslate"><span class="pre">roots(p)</span></code> function.</p>
</div>
<div class="section" id="exercise-5-advanced">
<span id="intro-types-ex-5"></span><h3><span class="section-number">5.7.5. </span>Exercise 5 (Advanced)<a class="headerlink" href="#exercise-5-advanced" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Trapezoidal_rule">trapezoidal rule</a>  approximates an integral with</p>
<div class="math notranslate nohighlight">
\[
\int_{\underline{x}}^{\bar{x}} f(x) \, dx \approx \sum_{n=1}^N \frac{f(x_{n-1}) + f(x_n)}{2} \Delta x_n
\]</div>
<p>where <span class="math notranslate nohighlight">\(x_0 = {\underline{x}},\, x_N = \bar{x}\)</span>, and <span class="math notranslate nohighlight">\(\Delta x_n \equiv x_{n-1} - x_n\)</span>.</p>
<p>Given an <code class="docutils literal notranslate"><span class="pre">x</span></code> and a function <code class="docutils literal notranslate"><span class="pre">f</span></code>, implement a few variations of the trapezoidal rule using multiple dispatch</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trapezoidal(f,</span> <span class="pre">x)</span></code> for any <code class="docutils literal notranslate"><span class="pre">typeof(x)</span> <span class="pre">=</span> <span class="pre">AbstractArray</span></code> and <code class="docutils literal notranslate"><span class="pre">typeof(f)</span> <span class="pre">==</span> <span class="pre">AbstractArray</span></code> where <code class="docutils literal notranslate"><span class="pre">length(x)</span> <span class="pre">=</span> <span class="pre">length(f)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trapezoidal(f,</span> <span class="pre">x)</span></code> for any <code class="docutils literal notranslate"><span class="pre">typeof(x)</span> <span class="pre">=</span> <span class="pre">AbstractRange</span></code> and <code class="docutils literal notranslate"><span class="pre">typeof(f)</span> <span class="pre">==</span> <span class="pre">AbstractArray</span></code> where <code class="docutils literal notranslate"><span class="pre">length(x)</span> <span class="pre">=</span> <span class="pre">length(f)</span></code></p>
<ul>
<li><p>Exploit the fact that <code class="docutils literal notranslate"><span class="pre">AbstractRange</span></code> has constant step sizes to specialize the algorithm</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">trapezoidal(f,</span> <span class="pre">x̲,</span> <span class="pre">x̄,</span> <span class="pre">N)</span></code> where <code class="docutils literal notranslate"><span class="pre">typeof(f)</span> <span class="pre">=</span> <span class="pre">Function</span></code>, and the other arguments are <code class="docutils literal notranslate"><span class="pre">Real</span></code></p>
<ul>
<li><p>For this, build a uniform grid with <code class="docutils literal notranslate"><span class="pre">N</span></code> points on <code class="docutils literal notranslate"><span class="pre">[x̲,</span> <span class="pre">x̄]</span></code> – call the <code class="docutils literal notranslate"><span class="pre">f</span></code> function at those grid points and use the existing <code class="docutils literal notranslate"><span class="pre">trapezoidal(f,</span> <span class="pre">x)</span></code> from the implementation</p></li>
</ul>
</li>
</ul>
<p>With these:</p>
<ol class="simple">
<li><p>Test each variation of the function with <span class="math notranslate nohighlight">\(f(x) = x^2\)</span> with <span class="math notranslate nohighlight">\(\underline{x}=0,\, \bar{x} = 1\)</span>.</p></li>
<li><p>From the analytical solution of the function, plot the error of <code class="docutils literal notranslate"><span class="pre">trapezoidal(f,</span> <span class="pre">x̲,</span> <span class="pre">x̄,</span> <span class="pre">N)</span></code> relative to the analytical solution for a grid of different <code class="docutils literal notranslate"><span class="pre">N</span></code> values.</p></li>
<li><p>Consider trying different functions for <span class="math notranslate nohighlight">\(f(x)\)</span> and compare the solutions for various <code class="docutils literal notranslate"><span class="pre">N</span></code>.</p></li>
</ol>
<p>When trying different functions, instead of integrating by hand consider using a high-accuracy
library for numerical integration such as <a class="reference external" href="https://juliamath.github.io/QuadGK.jl/latest/">QuadGK.jl</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">QuadGK</span><span class="w"></span>

<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="w"></span>
<span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">accuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quadgk</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.3333333333333333, 5.551115123125783e-17)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-6-advanced">
<h3><span class="section-number">5.7.6. </span>Exercise 6 (Advanced)<a class="headerlink" href="#exercise-6-advanced" title="Permalink to this headline">¶</a></h3>
<p>Take a variation of your code in Exercise 5.</p>
<p>Use auto-differentiation to calculate the following derivative for the example functions</p>
<div class="math notranslate nohighlight">
\[
\frac{d}{d {\bar{x}}}\int_{\underline{x}}^{\bar{x}} f(x) \, dx
\]</div>
<p>Hint: See the following code for the general pattern, and be careful to
follow the <a class="reference internal" href="#generic-tips-tricks"><span class="std std-ref">rules for generic programming</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">ForwardDiff</span><span class="w"></span>

<span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="c"># one</span><span class="w"></span>
<span class="k">return</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">Df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ForwardDiff</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"></span>

<span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w"></span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.1</span><span class="p">)</span><span class="w"></span>

<span class="n">Df</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f(0.0, 3.0) = 1.5
f(0.0, 3.1) = 1.55
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.7"
        },
        kernelOptions: {
            kernelName: "julia-1.7",
            path: "./getting_started_julia"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.7'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started with Julia
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   1. Setting up Your Julia Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="julia_by_example.html">
   2. Introductory Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="julia_essentials.html">
   3. Julia Essentials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fundamental_types.html">
   4. Arrays, Tuples, Ranges, and Other Fundamental Types
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   5. Introduction to Types and Generic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Package Ecosystem
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/generic_programming.html">
   6. Generic Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/general_packages.html">
   7. General Purpose Packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/data_statistical_packages.html">
   8. Data and Statistics Packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/optimization_solver_packages.html">
   9. Solvers, Optimizers, and Automatic Differentiation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Software Engineering
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/tools_editors.html">
   10. Visual Studio Code and Other Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/version_control.html">
   11. GitHub, Version Control and Collaboration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/testing.html">
   12. Packages, Testing, and Continuous Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/need_for_speed.html">
   13. The Need for Speed
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/geom_series.html">
   14. Geometric Series for Elementary Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/linear_algebra.html">
   15. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/orth_proj.html">
   16. Orthogonal Projections and Their Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/lln_clt.html">
   17. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/linear_models.html">
   18. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/finite_markov.html">
   19. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/stationary_densities.html">
   20. Continuous State Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/kalman.html">
   21. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/numerical_linear_algebra.html">
   22. Numerical Linear Algebra and Factorizations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/iterative_methods_sparsity.html">
   23. Krylov Methods and Matrix Conditioning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/short_path.html">
   24. Shortest Paths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/mccall_model.html">
   25. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/mccall_model_with_separation.html">
   26. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/wald_friedman.html">
   27. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/odu.html">
   28. Job Search III: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/career.html">
   29. Job Search IV: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/jv.html">
   30. Job Search V: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/optgrowth.html">
   31. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/coleman_policy_iter.html">
   32. Optimal Growth II: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/egm_policy_iter.html">
   33. Optimal Growth III: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/lqcontrol.html">
   34. LQ Dynamic Programming Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/perm_income.html">
   35. Optimal Savings I: The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/perm_income_cons.html">
   36. Optimal Savings II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/smoothing.html">
   37. Consumption and Tax Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/ifp.html">
   38. Optimal Savings III: Occasionally Binding Constraints
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/robustness.html">
   39. Robustness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming/discrete_dp.html">
   40. Discrete State Dynamic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modeling in Continuous Time
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../continuous_time/seir_model.html">
   41. Modeling COVID 19 with Differential Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../continuous_time/covid_sde.html">
   42. Modeling Shocks in COVID 19 with Stochastic Differential Equations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/schelling.html">
   43. Schelling’s Segregation Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/lake_model.html">
   44. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/rational_expectations.html">
   45. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/markov_perf.html">
   46. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/markov_asset.html">
   47. Asset Pricing I: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/lucas_model.html">
   48. Asset Pricing II: The Lucas Asset Pricing Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/harrison_kreps.html">
   49. Asset Pricing III:  Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/uncertainty_traps.html">
   50. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/aiyagari.html">
   51. The Aiyagari Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/arellano.html">
   52. Default Risk and Income Fluctuations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/matsuyama.html">
   53. Globalization and Cycles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time Series Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/arma.html">
   54. Covariance Stationary Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/estspec.html">
   55. Estimation of Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/additive_functionals.html">
   56. Additive Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/multiplicative_functionals.html">
   57. Multiplicative Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/lu_tricks.html">
   58. Classical Control with Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/classical_filtering.html">
   59. Classical Filtering With Linear Algebra
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming Squared
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/dyn_stack.html">
   60. Dynamic Stackelberg Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/lqramsey.html">
   61. Optimal Taxation in an LQ Economy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/opt_tax_recur.html">
   62. Optimal Taxation with State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/amss.html">
   63. Optimal Taxation without State-Contingent Debt
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../about_lectures.html">
   64. About these Lectures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../troubleshooting.html">
   65. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../zreferences.html">
   66. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../status.html">
   67. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                    <!-- <li class="btn__search">
                        <form action="../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
                            <i data-feather="search"></i>
                        </form>
                    </li> -->
                </ul>

                <ul class="qe-toolbar__links">
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/getting_started_julia/introduction_to_types.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-julia.myst/tree/main/lectures/getting_started_julia/introduction_to_types.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://mybinder.org/v2/gh/QuantEcon/lecture-julia.notebooks/main?urlpath=tree/getting_started_julia/introduction_to_types.ipynb">BinderHub</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-julia.notebooks" data-urlpath="tree/lecture-julia.notebooks/getting_started_julia/introduction_to_types.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://mybinder.org/v2/gh/QuantEcon/lecture-julia.notebooks/main?urlpath=tree/getting_started_julia/introduction_to_types.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "getting_started_julia/introduction_to_types";
                const repoURL = "https://github.com/QuantEcon/lecture-julia.notebooks";
                const urlPath = "tree/lecture-julia.notebooks/getting_started_julia/introduction_to_types.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-54984338-8', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>