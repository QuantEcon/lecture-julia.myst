
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>42. Robustness &#8212; Quantitative Economics with Julia</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-svg.js"></script>
    <link rel="canonical" href="https://julia.quantecon.org/dynamic_programming/robustness.html" />
    <link rel="shortcut icon" href="../_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="43. Discrete State Dynamic Programming" href="discrete_dp.html" />
    <link rel="prev" title="41. Optimal Savings III: Occasionally Binding Constraints" href="ifp.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-54984338-8', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/qe-logo-large.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Quantitative Economics with Julia</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started with Julia
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/getting_started.html">
   1. Setting up Your Julia Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/julia_by_example.html">
   2. Introductory Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/julia_essentials.html">
   3. Julia Essentials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/fundamental_types.html">
   4. Arrays, Tuples, Ranges, and Other Fundamental Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started_julia/introduction_to_types.html">
   5. Introduction to Types and Generic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Package Ecosystem
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/generic_programming.html">
   6. Generic Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/general_packages.html">
   7. General Purpose Packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/data_statistical_packages.html">
   8. Data and Statistics Packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../more_julia/optimization_solver_packages.html">
   9. Solvers, Optimizers, and Automatic Differentiation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Software Engineering
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/tools_editors.html">
   10. Visual Studio Code and Other Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/version_control.html">
   11. GitHub, Version Control and Collaboration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/testing.html">
   12. Packages, Testing, and Continuous Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software_engineering/need_for_speed.html">
   13. The Need for Speed
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/geom_series.html">
   14. Geometric Series for Elementary Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/linear_algebra.html">
   15. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/orth_proj.html">
   16. Orthogonal Projections and Their Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/lln_clt.html">
   17. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/stationary_densities.html">
   18. Continuous State Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/numerical_linear_algebra.html">
   19. Numerical Linear Algebra and Factorizations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools_and_techniques/iterative_methods_sparsity.html">
   20. Krylov Methods and Matrix Conditioning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/scalar_dynam.html">
   21. Dynamics in One Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/ar1_processes.html">
   22. AR1 Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/finite_markov.html">
   23. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/linear_models.html">
   24. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/wealth_dynamics.html">
   25. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/kalman.html">
   26. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_dynamics/short_path.html">
   27. Shortest Paths
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   28. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   29. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   30. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   31. Job Search III: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   32. Job Search IV: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   33. Job Search V: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   34. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   35. Optimal Growth II: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   36. Optimal Growth III: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   37. LQ Dynamic Programming Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   38. Optimal Savings I: The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   39. Optimal Savings II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="smoothing.html">
   40. Consumption and Tax Smoothing with Complete and Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   41. Optimal Savings III: Occasionally Binding Constraints
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   42. Robustness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_dp.html">
   43. Discrete State Dynamic Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modeling in Continuous Time
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../continuous_time/seir_model.html">
   44. Modeling COVID 19 with Differential Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../continuous_time/covid_sde.html">
   45. Modeling Shocks in COVID 19 with Stochastic Differential Equations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/schelling.html">
   46. Schelling’s Segregation Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/lake_model.html">
   47. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/rational_expectations.html">
   48. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/markov_perf.html">
   49. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/markov_asset.html">
   50. Asset Pricing I: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/lucas_model.html">
   51. Asset Pricing II: The Lucas Asset Pricing Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/harrison_kreps.html">
   52. Asset Pricing III:  Incomplete Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/uncertainty_traps.html">
   53. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/aiyagari.html">
   54. The Aiyagari Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/arellano.html">
   55. Default Risk and Income Fluctuations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_models/matsuyama.html">
   56. Globalization and Cycles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time Series Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/arma.html">
   57. Covariance Stationary Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/estspec.html">
   58. Estimation of Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/additive_functionals.html">
   59. Additive Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/multiplicative_functionals.html">
   60. Multiplicative Functionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/lu_tricks.html">
   61. Classical Control with Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_series_models/classical_filtering.html">
   62. Classical Filtering With Linear Algebra
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic Programming Squared
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/dyn_stack.html">
   63. Dynamic Stackelberg Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/lqramsey.html">
   64. Optimal Taxation in an LQ Economy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/opt_tax_recur.html">
   65. Optimal Taxation with State-Contingent Debt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dynamic_programming_squared/amss.html">
   66. Optimal Taxation without State-Contingent Debt
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../about_lectures.html">
   67. About these Lectures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../troubleshooting.html">
   68. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../zreferences.html">
   69. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../status.html">
   70. Execution Statistics
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/dynamic_programming/robustness.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   42.1. Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sets-of-models-imply-sets-of-values">
     42.1.1. Sets of Models Imply Sets Of Values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspiring-video">
     42.1.2. Inspiring Video
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-references">
     42.1.3. Other References
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-model">
   42.2. The Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-more-robust-policies">
   42.3. Constructing More Robust Policies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyzing-the-bellman-equation">
     42.3.1. Analyzing the Bellman equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robustness-as-outcome-of-a-two-person-zero-sum-game">
   42.4. Robustness as Outcome of a Two-Person Zero-Sum Game
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agent-2-s-problem">
     42.4.1. Agent 2’s Problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-agent-2-s-problem-to-construct-bounds-on-the-value-sets">
     42.4.2. Using Agent 2’s Problem to Construct Bounds on the Value Sets
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-lower-bound">
       42.4.2.1. The Lower Bound
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-upper-bound">
       42.4.2.2. The Upper Bound
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reshaping-the-set-of-values">
       42.4.2.3. Reshaping the set of values
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agent-1-s-problem">
     42.4.3. Agent 1’s Problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nash-equilibrium">
     42.4.4. Nash Equilibrium
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-stochastic-case">
   42.5. The Stochastic Case
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-the-model">
     42.5.1. Solving the Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-other-quantities">
     42.5.2. Computing Other Quantities
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#worst-case-value-of-a-policy">
       42.5.2.1. Worst-Case Value of a Policy
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   42.6. Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application">
   42.7. Application
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix">
   42.8. Appendix
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Robustness</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   42.1. Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sets-of-models-imply-sets-of-values">
     42.1.1. Sets of Models Imply Sets Of Values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspiring-video">
     42.1.2. Inspiring Video
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-references">
     42.1.3. Other References
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-model">
   42.2. The Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-more-robust-policies">
   42.3. Constructing More Robust Policies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyzing-the-bellman-equation">
     42.3.1. Analyzing the Bellman equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robustness-as-outcome-of-a-two-person-zero-sum-game">
   42.4. Robustness as Outcome of a Two-Person Zero-Sum Game
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agent-2-s-problem">
     42.4.1. Agent 2’s Problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-agent-2-s-problem-to-construct-bounds-on-the-value-sets">
     42.4.2. Using Agent 2’s Problem to Construct Bounds on the Value Sets
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-lower-bound">
       42.4.2.1. The Lower Bound
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-upper-bound">
       42.4.2.2. The Upper Bound
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reshaping-the-set-of-values">
       42.4.2.3. Reshaping the set of values
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agent-1-s-problem">
     42.4.3. Agent 1’s Problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nash-equilibrium">
     42.4.4. Nash Equilibrium
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-stochastic-case">
   42.5. The Stochastic Case
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-the-model">
     42.5.1. Solving the Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-other-quantities">
     42.5.2. Computing Other Quantities
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#worst-case-value-of-a-policy">
       42.5.2.1. Worst-Case Value of a Policy
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   42.6. Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application">
   42.7. Application
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix">
   42.8. Appendix
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div id="qe-notebook-header" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><div class="tex2jax_ignore mathjax_ignore section" id="robustness">
<h1><a class="toc-backref" href="#id4"><span class="section-number">42. </span>Robustness</a><a class="headerlink" href="#robustness" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<span id="index-0"></span><p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#robustness" id="id4">Robustness</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id5">Overview</a></p></li>
<li><p><a class="reference internal" href="#the-model" id="id6">The Model</a></p></li>
<li><p><a class="reference internal" href="#constructing-more-robust-policies" id="id7">Constructing More Robust Policies</a></p></li>
<li><p><a class="reference internal" href="#robustness-as-outcome-of-a-two-person-zero-sum-game" id="id8">Robustness as Outcome of a Two-Person Zero-Sum Game</a></p></li>
<li><p><a class="reference internal" href="#the-stochastic-case" id="id9">The Stochastic Case</a></p></li>
<li><p><a class="reference internal" href="#implementation" id="id10">Implementation</a></p></li>
<li><p><a class="reference internal" href="#application" id="id11">Application</a></p></li>
<li><p><a class="reference internal" href="#appendix" id="id12">Appendix</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id5"><span class="section-number">42.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p id="index-1">This lecture modifies a Bellman equation to express a decision maker’s doubts about  transition dynamics.</p>
<p>His specification doubts make the decision maker want a <em>robust</em> decision rule.</p>
<p><em>Robust</em> means insensitive to misspecification of transition dynamics.</p>
<p>The decision maker has a single <em>approximating model</em>.</p>
<p>He calls it <em>approximating</em> to acknowledge that he doesn’t completely trust it.</p>
<p>He fears that outcomes will actually be determined by another model that he cannot describe explicitly.</p>
<p>All that he knows is that the actual data-generating model is in some (uncountable) set of models that surrounds his approximating model.</p>
<p>He quantifies the discrepancy between his approximating model and the genuine data-generating model by using a quantity called <em>entropy</em>.</p>
<p>(We’ll explain what entropy means below)</p>
<p>He wants a decision rule that will work well enough no matter which of those other models actually governs outcomes.</p>
<p>This is what it means for his decision rule to be “robust to misspecification of an approximating model”.</p>
<p>This may  sound like too much to ask for, but <span class="math notranslate nohighlight">\(\ldots\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\ldots\)</span>  a <em>secret weapon</em> is available to design robust decision rules.</p>
<p>The secret weapon is max-min control theory.</p>
<p>A value-maximizing decision maker enlists the aid of an (imaginary) value-minimizing model chooser to construct <em>bounds</em> on the value attained by a given decision rule under different models of the transition dynamics.</p>
<p>The original decision maker uses those bounds to construct a decision rule with an assured performance level, no matter which model actually governs outcomes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In reading this lecture, please don’t think that our decision maker is paranoid when he conducts a worst-case analysis. By designing a rule that works well against a worst-case, his intention is to construct a rule that will work well across a <em>set</em> of models.</p>
</div>
<div class="section" id="sets-of-models-imply-sets-of-values">
<span id="rb-vec"></span><h3><span class="section-number">42.1.1. </span>Sets of Models Imply Sets Of Values<a class="headerlink" href="#sets-of-models-imply-sets-of-values" title="Permalink to this headline">¶</a></h3>
<p>Our “robust” decision maker wants to know how well a given rule will work when he does not <em>know</em> a single transition law  <span class="math notranslate nohighlight">\(\ldots\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\ldots\)</span> he wants to know  <em>sets</em> of values that will be attained by a given decision rule <span class="math notranslate nohighlight">\(F\)</span> under a <em>set</em> of transition laws.</p>
<p>Ultimately, he wants to design a decision rule <span class="math notranslate nohighlight">\(F\)</span> that shapes these <em>sets</em> of values in ways that he prefers.</p>
<p>With this in mind, consider the following graph, which relates to a particular decision problem to be explained below</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../_images/kg0.png"><img alt="../_images/kg0.png" src="../_images/kg0.png" style="width: 70%;" /></a>
</div>
<p>The figure shows a <em>value-entropy correspondence</em> for a particular decision rule <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>The shaded set is the graph of the correspondence, which maps entropy to a set of values associated with a set of models that surround the decision maker’s approximating model.</p>
<p>Here</p>
<ul class="simple">
<li><p><em>Value</em> refers to a sum of discounted rewards obtained by applying the decision rule <span class="math notranslate nohighlight">\(F\)</span> when the state starts at some fixed initial state <span class="math notranslate nohighlight">\(x_0\)</span>.</p></li>
<li><p><em>Entropy</em> is a nonnegative number that measures the size of a set of models surrounding the decision maker’s approximating model.</p>
<ul>
<li><p>Entropy is zero when the set includes only the approximating model, indicating that the decision maker completely trusts the approximating model.</p></li>
<li><p>Entropy is bigger, and the set of surrounding models is bigger, the less the decision maker trusts the approximating model.</p></li>
</ul>
</li>
</ul>
<p>The shaded region indicates that for <strong>all</strong> models having entropy less than or equal to the number on the horizontal axis, the value obtained will be somewhere within the indicated set of values.</p>
<p>Now let’s compare sets of values associated with two different decision rules, <span class="math notranslate nohighlight">\(F_r\)</span> and <span class="math notranslate nohighlight">\(F_b\)</span>.</p>
<p>In the next figure,</p>
<ul class="simple">
<li><p>The red set shows the value-entropy correspondence for decision rule <span class="math notranslate nohighlight">\(F_r\)</span>.</p></li>
<li><p>The blue set shows the value-entropy correspondence for decision rule <span class="math notranslate nohighlight">\(F_b\)</span>.</p></li>
</ul>
<div class="figure align-default">
<a class="reference internal image-reference" href="../_images/kg.png"><img alt="../_images/kg.png" src="../_images/kg.png" style="width: 70%;" /></a>
</div>
<p>The blue correspondence is skinnier than the red correspondence.</p>
<p>This conveys the sense in which the decision rule <span class="math notranslate nohighlight">\(F_b\)</span> is <em>more robust</em> than the decision rule <span class="math notranslate nohighlight">\(F_r\)</span>.</p>
<ul class="simple">
<li><p><em>more robust</em> means that the set of values is less sensitive to <em>increasing misspecification</em> as measured by entropy.</p></li>
</ul>
<p>Notice that the less robust rule <span class="math notranslate nohighlight">\(F_r\)</span> promises higher values for small misspecifications (small entropy).</p>
<p>(But it is more fragile in the sense that it is more sensitive to perturbations of the approximating model)</p>
<p>Below we’ll explain in detail how to construct these sets of values for a given <span class="math notranslate nohighlight">\(F\)</span>, but for now <span class="math notranslate nohighlight">\(\ldots\)</span>.</p>
<p>Here is a hint about the  <em>secret weapons</em> we’ll use to construct these sets</p>
<ul class="simple">
<li><p>We’ll use some min problems to construct the lower bounds.</p></li>
<li><p>We’ll use some max problems to construct the upper bounds.</p></li>
</ul>
<p>We will also describe how to choose <span class="math notranslate nohighlight">\(F\)</span> to shape the sets of values.</p>
<p>This will involve crafting a <em>skinnier</em> set at the cost of  a lower <em>level</em> (at least for low values of entropy).</p>
</div>
<div class="section" id="inspiring-video">
<h3><span class="section-number">42.1.2. </span>Inspiring Video<a class="headerlink" href="#inspiring-video" title="Permalink to this headline">¶</a></h3>
<p>If you want to understand more about why one serious quantitative researcher is interested in this approach, we recommend <a class="reference external" href="http://www.nobelprize.org/mediaplayer/index.php?id=1994">Lars Peter Hansen’s Nobel lecture</a>.</p>
</div>
<div class="section" id="other-references">
<h3><span class="section-number">42.1.3. </span>Other References<a class="headerlink" href="#other-references" title="Permalink to this headline">¶</a></h3>
<p>Our discussion in this lecture is based on</p>
<ul class="simple">
<li><p><span id="id1">[<a class="reference internal" href="../zreferences.html#id87" title="Lars Peter Hansen and Thomas J Sargent. Wanting robustness in macroeconomics. Manuscript, Department of Economics, Stanford University., 2000.">HS00</a>]</span></p></li>
<li><p><span id="id2">[<a class="reference internal" href="../zreferences.html#id86" title="L P Hansen and T J Sargent. Robustness. Princeton University Press, 2008.">HS08</a>]</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span><span class="p">,</span><span class="w"> </span><span class="n">Statistics</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="the-model">
<h2><a class="toc-backref" href="#id6"><span class="section-number">42.2. </span>The Model</a><a class="headerlink" href="#the-model" title="Permalink to this headline">¶</a></h2>
<p>For simplicity, we present ideas in the context of a class of problems with linear transition laws and quadratic objective functions.</p>
<p>To fit in with <a class="reference internal" href="lqcontrol.html"><span class="doc">our earlier lecture on LQ control</span></a>, we will treat loss minimization rather than value maximization.</p>
<p>To begin, recall the <a class="reference internal" href="lqcontrol.html#lq-ih"><span class="std std-ref">infinite horizon LQ problem</span></a>, where an agent chooses a sequence of controls <span class="math notranslate nohighlight">\(\{u_t\}\)</span> to minimize</p>
<div class="math notranslate nohighlight" id="equation-rob-sih">
<span class="eqno">(42.1)<a class="headerlink" href="#equation-rob-sih" title="Permalink to this equation">¶</a></span>\[\sum_{t=0}^{\infty} \beta^t
   \left\{
       x_t' R x_t +  u_t' Q u_t
   \right\}\]</div>
<p>subject to the linear law of motion</p>
<div class="math notranslate nohighlight" id="equation-rob-lom">
<span class="eqno">(42.2)<a class="headerlink" href="#equation-rob-lom" title="Permalink to this equation">¶</a></span>\[x_{t+1} = A x_t + B u_t + C w_{t+1},
\qquad t = 0, 1, 2, \ldots\]</div>
<p>As before,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_t\)</span> is <span class="math notranslate nohighlight">\(n \times 1\)</span>, <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(n \times n\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> is <span class="math notranslate nohighlight">\(k \times 1\)</span>, <span class="math notranslate nohighlight">\(B\)</span> is <span class="math notranslate nohighlight">\(n \times k\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(w_t\)</span> is <span class="math notranslate nohighlight">\(j \times 1\)</span>, <span class="math notranslate nohighlight">\(C\)</span> is <span class="math notranslate nohighlight">\(n \times j\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> is <span class="math notranslate nohighlight">\(n \times n\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> is <span class="math notranslate nohighlight">\(k \times k\)</span></p></li>
</ul>
<p>Here <span class="math notranslate nohighlight">\(x_t\)</span> is the state, <span class="math notranslate nohighlight">\(u_t\)</span> is the control,  and <span class="math notranslate nohighlight">\(w_t\)</span> is a shock vector.</p>
<p>For now we take <span class="math notranslate nohighlight">\(\{ w_t \} := \{ w_t \}_{t=1}^{\infty}\)</span> to be deterministic — a single fixed sequence.</p>
<p>We also allow for <em>model uncertainty</em> on the part of the agent solving this optimization problem.</p>
<p>In particular, the agent takes <span class="math notranslate nohighlight">\(w_t = 0\)</span> for all <span class="math notranslate nohighlight">\(t \geq 0\)</span> as a benchmark model, but admits the possibility that this model might be wrong.</p>
<p>As a consequence, she also considers a set of alternative models expressed in terms of  sequences <span class="math notranslate nohighlight">\(\{ w_t \}\)</span> that are “close” to the zero sequence.</p>
<p>She seeks a policy that will do well enough for a set of alternative models whose members are pinned down by  sequences <span class="math notranslate nohighlight">\(\{ w_t \}\)</span>.</p>
<p>Soon we’ll quantify the quality of a model specification in terms of the maximal size of the expression <span class="math notranslate nohighlight">\(\sum_{t=0}^{\infty} \beta^{t+1}w_{t+1}' w_{t+1}\)</span>.</p>
</div>
<div class="section" id="constructing-more-robust-policies">
<h2><a class="toc-backref" href="#id7"><span class="section-number">42.3. </span>Constructing More Robust Policies</a><a class="headerlink" href="#constructing-more-robust-policies" title="Permalink to this headline">¶</a></h2>
<p>If our agent takes <span class="math notranslate nohighlight">\(\{ w_t \}\)</span> as a given deterministic sequence, then, drawing on intuition from earlier lectures on dynamic programming, we can anticipate Bellman equations such as</p>
<div class="math notranslate nohighlight">
\[
J_{t-1} (x)
= \min_u
\{
    x' R x + u' Q u + \beta \,
    J_t (Ax + B u + C w_t)
\}
\]</div>
<p>(Here <span class="math notranslate nohighlight">\(J\)</span> depends on <span class="math notranslate nohighlight">\(t\)</span> because the sequence <span class="math notranslate nohighlight">\(\{w_t\}\)</span> is not recursive)</p>
<p>Our tool for studying robustness is to construct a rule that works well even if an adverse sequence <span class="math notranslate nohighlight">\(\{ w_t \}\)</span> occurs.</p>
<p>In our framework, “adverse” means “loss increasing”.</p>
<p>As we’ll see, this will eventually lead us to construct the Bellman equation.</p>
<div class="math notranslate nohighlight" id="equation-rb-wcb0">
<span class="eqno">(42.3)<a class="headerlink" href="#equation-rb-wcb0" title="Permalink to this equation">¶</a></span>\[J (x) = \min_u \max_w \{ x' R x + u' Q u + \beta \,[J (Ax + B u + C w) - \theta w'w] \}\]</div>
<p>Notice that we’ve added the penalty term <span class="math notranslate nohighlight">\(- \theta w'w\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(w'w = \| w \|^2\)</span>, this term becomes influential when <span class="math notranslate nohighlight">\(w\)</span> moves away from the origin.</p>
<p>The penalty parameter <span class="math notranslate nohighlight">\(\theta\)</span> controls how much we penalize the maximizing agent for “harming” the minimizing agent.</p>
<p>By raising <span class="math notranslate nohighlight">\(\theta\)</span> more and more, we more and more limit the ability of maximizing agent to distort outcomes relative to the approximating model.</p>
<p>So bigger <span class="math notranslate nohighlight">\(\theta\)</span> is implicitly associated with smaller distortion sequences <span class="math notranslate nohighlight">\(\{w_t \}\)</span>.</p>
<div class="section" id="analyzing-the-bellman-equation">
<h3><span class="section-number">42.3.1. </span>Analyzing the Bellman equation<a class="headerlink" href="#analyzing-the-bellman-equation" title="Permalink to this headline">¶</a></h3>
<p>So what does <span class="math notranslate nohighlight">\(J\)</span> in <a class="reference internal" href="#equation-rb-wcb0">(42.3)</a> look like?</p>
<p>As with the <a class="reference internal" href="lqcontrol.html"><span class="doc">ordinary LQ control model</span></a>, <span class="math notranslate nohighlight">\(J\)</span> takes the form <span class="math notranslate nohighlight">\(J(x) = x' P x\)</span> for some symmetric positive definite matrix <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>One of our main tasks will be to analyze and compute the matrix <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>Related tasks will be to study associated feedback rules for <span class="math notranslate nohighlight">\(u_t\)</span> and <span class="math notranslate nohighlight">\(w_{t+1}\)</span>.</p>
<p>First, using <a class="reference internal" href="../tools_and_techniques/linear_algebra.html#la-mcalc"><span class="std std-ref">matrix calculus</span></a>, you will be able to verify that</p>
<div class="math notranslate nohighlight" id="equation-rb-mp0">
<span class="eqno">(42.4)<a class="headerlink" href="#equation-rb-mp0" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\max_w
&amp;\{
    (Ax + B u + C w)' P (Ax + B u + C w) - \theta w'w
\}
\\
&amp; \hspace{20mm} = (Ax + Bu)' \mathcal D(P) (Ax + Bu)
\end{aligned}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-rb-d">
<span class="eqno">(42.5)<a class="headerlink" href="#equation-rb-d" title="Permalink to this equation">¶</a></span>\[\mathcal D(P) := P + PC (\theta I - C' P C)^{-1} C' P\]</div>
<p>and <span class="math notranslate nohighlight">\(I\)</span> is a <span class="math notranslate nohighlight">\(j \times j\)</span> identity matrix.  Substituting this expression for the maximum into <a class="reference internal" href="#equation-rb-wcb0">(42.3)</a> yields</p>
<div class="math notranslate nohighlight" id="equation-rb-owb">
<span class="eqno">(42.6)<a class="headerlink" href="#equation-rb-owb" title="Permalink to this equation">¶</a></span>\[x'Px  =  \min_u    \{
    x' R x + u' Q u + \beta \,
   (Ax + Bu)' \mathcal D(P) (Ax + Bu)    \}\]</div>
<p>Using similar mathematics, the solution to this minimization problem is <span class="math notranslate nohighlight">\(u  = - F x\)</span> where <span class="math notranslate nohighlight">\(F := (Q + \beta B' \mathcal D (P) B)^{-1} \beta B' \mathcal D(P) A\)</span>.</p>
<p>Substituting this minimizer back into <a class="reference internal" href="#equation-rb-owb">(42.6)</a> and working through the algebra gives
<span class="math notranslate nohighlight">\(x' P x = x' \mathcal B ( \mathcal D( P )) x\)</span> for all <span class="math notranslate nohighlight">\(x\)</span>, or, equivalently,</p>
<div class="math notranslate nohighlight">
\[
P = \mathcal B ( \mathcal D( P ))
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal D\)</span> is the operator defined in <a class="reference internal" href="#equation-rb-d">(42.5)</a> and</p>
<div class="math notranslate nohighlight">
\[
\mathcal B(P)
:= R - \beta^2 A' P B (Q + \beta B' P B)^{-1} B' P A + \beta A' P A
\]</div>
<p>The operator <span class="math notranslate nohighlight">\(\mathcal B\)</span> is the standard (i.e., non-robust) LQ Bellman operator, and <span class="math notranslate nohighlight">\(P = \mathcal B(P)\)</span> is the standard matrix Riccati equation coming from the
Bellman equation — see <a class="reference internal" href="lqcontrol.html#lq-ih"><span class="std std-ref">this discussion</span></a>.</p>
<p>Under some regularity conditions (see <span id="id3">[<a class="reference internal" href="../zreferences.html#id86" title="L P Hansen and T J Sargent. Robustness. Princeton University Press, 2008.">HS08</a>]</span>), the operator <span class="math notranslate nohighlight">\(\mathcal B \circ \mathcal D\)</span>
has a unique positive definite fixed point, which we denote below by <span class="math notranslate nohighlight">\(\hat P\)</span>.</p>
<p>A robust policy, indexed by <span class="math notranslate nohighlight">\(\theta\)</span>, is <span class="math notranslate nohighlight">\(u  = - \hat F x\)</span> where</p>
<div class="math notranslate nohighlight" id="equation-rb-oc-ih">
<span class="eqno">(42.7)<a class="headerlink" href="#equation-rb-oc-ih" title="Permalink to this equation">¶</a></span>\[\hat F
:= (Q + \beta B' \mathcal D (\hat P) B)^{-1} \beta B' \mathcal D(\hat P) A\]</div>
<p>We also define</p>
<div class="math notranslate nohighlight" id="equation-rb-kd">
<span class="eqno">(42.8)<a class="headerlink" href="#equation-rb-kd" title="Permalink to this equation">¶</a></span>\[\hat K
:= (\theta I - C' \hat PC)^{-1} C'  \hat P (A - B \hat F)\]</div>
<p>The interpretation of <span class="math notranslate nohighlight">\(\hat K\)</span> is that <span class="math notranslate nohighlight">\(w_{t+1} = \hat K x_t\)</span> on the worst-case path of <span class="math notranslate nohighlight">\(\{x_t \}\)</span>, in the sense that this vector is the maximizer of <a class="reference internal" href="#equation-rb-mp0">(42.4)</a> evaluated at the fixed rule <span class="math notranslate nohighlight">\(u  = - \hat F x\)</span>.</p>
<p>Note that <span class="math notranslate nohighlight">\(\hat P, \hat F, \hat K\)</span> are all determined by the
primitives and <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>Note also that if <span class="math notranslate nohighlight">\(\theta\)</span> is very large, then <span class="math notranslate nohighlight">\(\mathcal D\)</span> is
approximately equal to the identity mapping.</p>
<p>Hence, when <span class="math notranslate nohighlight">\(\theta\)</span> is large,  <span class="math notranslate nohighlight">\(\hat P\)</span> and <span class="math notranslate nohighlight">\(\hat F\)</span> are approximately equal to their standard LQ values.</p>
<p>Furthermore, when <span class="math notranslate nohighlight">\(\theta\)</span> is large, <span class="math notranslate nohighlight">\(\hat K\)</span> is approximately equal to zero.</p>
<p>Conversely, smaller <span class="math notranslate nohighlight">\(\theta\)</span> is associated with greater fear of model misspecification, and greater concern for robustness.</p>
</div>
</div>
<div class="section" id="robustness-as-outcome-of-a-two-person-zero-sum-game">
<h2><a class="toc-backref" href="#id8"><span class="section-number">42.4. </span>Robustness as Outcome of a Two-Person Zero-Sum Game</a><a class="headerlink" href="#robustness-as-outcome-of-a-two-person-zero-sum-game" title="Permalink to this headline">¶</a></h2>
<p>What we have done above can be interpreted in terms of  a two-person zero-sum game in which <span class="math notranslate nohighlight">\(\hat F, \hat K\)</span> are Nash equilibrium objects.</p>
<p>Agent 1 is our original agent, who seeks to minimize loss in the LQ program while admitting the possibility of misspecification.</p>
<p>Agent 2 is an imaginary malevolent player.</p>
<p>Agent 2’s malevolence helps the original agent to compute bounds on his value function across a set of models.</p>
<p>We begin with agent 2’s problem.</p>
<div class="section" id="agent-2-s-problem">
<span id="rb-a2"></span><h3><span class="section-number">42.4.1. </span>Agent 2’s Problem<a class="headerlink" href="#agent-2-s-problem" title="Permalink to this headline">¶</a></h3>
<p>Agent 2</p>
<ol class="simple">
<li><p>knows a fixed policy <span class="math notranslate nohighlight">\(F\)</span> specifying the behavior of agent 1, in the sense that <span class="math notranslate nohighlight">\(u_t = - F x_t\)</span> for all <span class="math notranslate nohighlight">\(t\)</span></p></li>
<li><p>responds by choosing a shock sequence <span class="math notranslate nohighlight">\(\{ w_t \}\)</span> from a set of paths sufficiently close to the benchmark sequence <span class="math notranslate nohighlight">\(\{0, 0, 0, \ldots\}\)</span></p></li>
</ol>
<p>A natural way to say “sufficiently close to the zero sequence” is to restrict the
summed inner product <span class="math notranslate nohighlight">\(\sum_{t=1}^{\infty} w_t' w_t\)</span> to be small.</p>
<p>However, to obtain a time-invariant recursive formulation, it turns out to be convenient to
restrict a  discounted inner product</p>
<div class="math notranslate nohighlight" id="equation-rb-dec">
<span class="eqno">(42.9)<a class="headerlink" href="#equation-rb-dec" title="Permalink to this equation">¶</a></span>\[\sum_{t=1}^{\infty} \beta^t w_t' w_t \leq \eta\]</div>
<p>Now let <span class="math notranslate nohighlight">\(F\)</span> be a fixed policy, and let <span class="math notranslate nohighlight">\(J_F(x_0, \mathbf w)\)</span> be the
present-value cost of that policy given sequence <span class="math notranslate nohighlight">\(\mathbf w := \{w_t\}\)</span>
and initial condition <span class="math notranslate nohighlight">\(x_0 \in \mathbb R^n\)</span>.</p>
<p>Substituting <span class="math notranslate nohighlight">\(-F x_t\)</span> for <span class="math notranslate nohighlight">\(u_t\)</span> in <a class="reference internal" href="#equation-rob-sih">(42.1)</a>, this value can be written as</p>
<div class="math notranslate nohighlight" id="equation-rob-fpv">
<span class="eqno">(42.10)<a class="headerlink" href="#equation-rob-fpv" title="Permalink to this equation">¶</a></span>\[J_F(x_0, \mathbf w) :=
    \sum_{t=0}^{\infty} \beta^t
    x_t' (R + F' Q F) x_t\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-rob-lomf">
<span class="eqno">(42.11)<a class="headerlink" href="#equation-rob-lomf" title="Permalink to this equation">¶</a></span>\[x_{t+1} = (A - B F) x_t + C w_{t+1}\]</div>
<p>and the initial condition <span class="math notranslate nohighlight">\(x_0\)</span> is as specified in the left side of <a class="reference internal" href="#equation-rob-fpv">(42.10)</a>.</p>
<p>Agent 2 chooses <span class="math notranslate nohighlight">\({\mathbf w}\)</span> to maximize agent 1’s loss <span class="math notranslate nohighlight">\(J_F(x_0, \mathbf w)\)</span> subject to <a class="reference internal" href="#equation-rb-dec">(42.9)</a>.</p>
<p>Using a Lagrangian formulation, we can express this problem as</p>
<div class="math notranslate nohighlight">
\[
\max_{\mathbf w}
 \sum_{t=0}^{\infty} \beta^t
  \left\{
    x_t' (R + F' Q F) x_t - \beta \theta (w_{t+1}' w_{t+1} - \eta)
  \right\}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\{x_t\}\)</span> satisfied  <a class="reference internal" href="#equation-rob-lomf">(42.11)</a> and <span class="math notranslate nohighlight">\(\theta\)</span> is a Lagrange multiplier on constraint <a class="reference internal" href="#equation-rb-dec">(42.9)</a>.</p>
<p>For the moment, let’s take <span class="math notranslate nohighlight">\(\theta\)</span> as fixed, allowing us to drop the constant <span class="math notranslate nohighlight">\(\beta \theta \eta\)</span> term in the objective function, and hence write the problem as</p>
<div class="math notranslate nohighlight">
\[
\max_{\mathbf w}
 \sum_{t=0}^{\infty} \beta^t
  \left\{
    x_t' (R + F' Q F) x_t - \beta \theta w_{t+1}' w_{t+1}
  \right\}
\]</div>
<p>or, equivalently,</p>
<div class="math notranslate nohighlight" id="equation-rb-a2o">
<span class="eqno">(42.12)<a class="headerlink" href="#equation-rb-a2o" title="Permalink to this equation">¶</a></span>\[\min_{\mathbf w}
\sum_{t=0}^{\infty} \beta^t
\left\{
    -x_t' (R + F' Q F) x_t + \beta \theta w_{t+1}' w_{t+1}
\right\}\]</div>
<p>subject to <a class="reference internal" href="#equation-rob-lomf">(42.11)</a>.</p>
<p>What’s striking about this optimization problem is that it is once again an LQ discounted dynamic programming problem, with <span class="math notranslate nohighlight">\(\mathbf w = \{ w_t \}\)</span> as the sequence of controls.</p>
<p>The expression for the optimal policy can be found by applying the usual LQ formula (<a class="reference internal" href="lqcontrol.html#lq-ih"><span class="std std-ref">see here</span></a>).</p>
<p>We denote it by <span class="math notranslate nohighlight">\(K(F, \theta)\)</span>, with the interpretation <span class="math notranslate nohighlight">\(w_{t+1} = K(F, \theta) x_t\)</span>.</p>
<p>The remaining step for agent 2’s problem is to set <span class="math notranslate nohighlight">\(\theta\)</span> to enforce the constraint <a class="reference internal" href="#equation-rb-dec">(42.9)</a>, which can be done by choosing <span class="math notranslate nohighlight">\(\theta = \theta_{\eta}\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-rb-pdt">
<span class="eqno">(42.13)<a class="headerlink" href="#equation-rb-pdt" title="Permalink to this equation">¶</a></span>\[\beta \sum_{t=0}^{\infty} \beta^t x_t' K(F, \theta_\eta)' K(F, \theta_\eta) x_t = \eta\]</div>
<p>Here <span class="math notranslate nohighlight">\(x_t\)</span> is given by <a class="reference internal" href="#equation-rob-lomf">(42.11)</a> — which in this case becomes <span class="math notranslate nohighlight">\(x_{t+1} = (A - B F + CK(F, \theta)) x_t\)</span>.</p>
</div>
<div class="section" id="using-agent-2-s-problem-to-construct-bounds-on-the-value-sets">
<span id="rb-a1"></span><h3><span class="section-number">42.4.2. </span>Using Agent 2’s Problem to Construct Bounds on the Value Sets<a class="headerlink" href="#using-agent-2-s-problem-to-construct-bounds-on-the-value-sets" title="Permalink to this headline">¶</a></h3>
<div class="section" id="the-lower-bound">
<h4><span class="section-number">42.4.2.1. </span>The Lower Bound<a class="headerlink" href="#the-lower-bound" title="Permalink to this headline">¶</a></h4>
<p>Define the minimized object on the right side of problem <a class="reference internal" href="#equation-rb-a2o">(42.12)</a> as <span class="math notranslate nohighlight">\(R_\theta(x_0, F)\)</span>.</p>
<p>Because “minimizers minimize” we have</p>
<div class="math notranslate nohighlight">
\[
R_\theta(x_0, F) \leq \sum_{t=0}^\infty \beta^t \left\{  - x_t' (R + F' Q F) x_t \right\} + \beta \theta \sum_{t=0}^\infty \beta^t w_{t+1}' w_{t+1},
\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{t+1} = (A - B F + CK(F, \theta)) x_t\)</span> and <span class="math notranslate nohighlight">\(x_0\)</span> is a given initial condition.</p>
<p>This inequality in turn implies the inequality</p>
<div class="math notranslate nohighlight" id="equation-rob-bound">
<span class="eqno">(42.14)<a class="headerlink" href="#equation-rob-bound" title="Permalink to this equation">¶</a></span>\[R_\theta(x_0, F) - \theta \ {\rm ent}
\leq \sum_{t=0}^\infty \beta^t \left\{  - x_t' (R + F' Q F) x_t \right\}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
{\rm ent} := \beta \sum_{t=0}^\infty \beta^t w_{t+1}' w_{t+1}
\]</div>
<p>The left side of inequality <a class="reference internal" href="#equation-rob-bound">(42.14)</a> is a straight line with slope <span class="math notranslate nohighlight">\(-\theta\)</span>.</p>
<p>Technically, it is  a “separating hyperplane”.</p>
<p>At a particular value of entropy, the line is tangent to the lower bound of values  as a function of entropy.</p>
<p>In particular, the lower bound on the left side of <a class="reference internal" href="#equation-rob-bound">(42.14)</a> is attained when</p>
<div class="math notranslate nohighlight" id="equation-rb-pdt22">
<span class="eqno">(42.15)<a class="headerlink" href="#equation-rb-pdt22" title="Permalink to this equation">¶</a></span>\[{\rm ent} =  \beta \sum_{t=0}^{\infty} \beta^t x_t' K(F, \theta)' K(F, \theta) x_t\]</div>
<p>To construct the <em>lower bound</em> on the set of values associated with all perturbations <span class="math notranslate nohighlight">\({\mathbf w}\)</span> satisfying the entropy constraint <a class="reference internal" href="#equation-rb-dec">(42.9)</a> at a  given entropy level, we proceed as follows:</p>
<ul class="simple">
<li><p>For a given <span class="math notranslate nohighlight">\(\theta\)</span>, solve the minimization problem <a class="reference internal" href="#equation-rb-a2o">(42.12)</a>.</p></li>
<li><p>Compute the minimizer <span class="math notranslate nohighlight">\(R_\theta(x_0, F)\)</span> and the associated entropy using <a class="reference internal" href="#equation-rb-pdt22">(42.15)</a>.</p></li>
<li><p>Compute the lower bound on the value function <span class="math notranslate nohighlight">\(R_\theta(x_0, F) - \theta \ {\rm  ent}\)</span> and plot it against <span class="math notranslate nohighlight">\({\rm ent}\)</span>.</p></li>
<li><p>Repeat the preceding three steps  for a range of values of <span class="math notranslate nohighlight">\(\theta\)</span> to trace out the lower bound.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This procedure  sweeps  out a set of separating hyperplanes indexed by different values for  the Lagrange multiplier <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
</div>
</div>
<div class="section" id="the-upper-bound">
<h4><span class="section-number">42.4.2.2. </span>The Upper Bound<a class="headerlink" href="#the-upper-bound" title="Permalink to this headline">¶</a></h4>
<p>To construct an <em>upper bound</em> we use a very similar procedure.</p>
<p>We simply replace the <em>minimization</em> problem <a class="reference internal" href="#equation-rb-a2o">(42.12)</a> with the <em>maximization</em> problem.</p>
<div class="math notranslate nohighlight" id="equation-rba2omax">
<span class="eqno">(42.16)<a class="headerlink" href="#equation-rba2omax" title="Permalink to this equation">¶</a></span>\[V_{\tilde \theta}(x_0, F) =  \max_{\mathbf w}
  \sum_{t=0}^{\infty} \beta^t
  \left\{
      -x_t' (R + F' Q F) x_t - \beta \tilde \theta w_{t+1}' w_{t+1}
  \right\}\]</div>
<p>where now <span class="math notranslate nohighlight">\(\tilde \theta  &gt;0\)</span>  penalizes the choice of <span class="math notranslate nohighlight">\({\mathbf w}\)</span> with larger entropy.</p>
<p>(Notice that <span class="math notranslate nohighlight">\(\tilde \theta = - \theta\)</span> in problem <a class="reference internal" href="#equation-rb-a2o">(42.12)</a>)</p>
<p>Because “maximizers maximize” we have</p>
<div class="math notranslate nohighlight">
\[
V_{\tilde \theta}(x_0, F) \geq \sum_{t=0}^\infty \beta^t \left\{  - x_t' (R + F' Q F) x_t \right\} - \beta \tilde \theta \sum_{t=0}^\infty \beta^t w_{t+1}' w_{t+1}
\]</div>
<p>which in turn implies the inequality</p>
<div class="math notranslate nohighlight" id="equation-robboundmax">
<span class="eqno">(42.17)<a class="headerlink" href="#equation-robboundmax" title="Permalink to this equation">¶</a></span>\[V_{\tilde \theta}(x_0, F) + \tilde \theta \ {\rm ent} \geq \sum_{t=0}^\infty \beta^t \left\{  - x_t' (R + F' Q F) x_t \right\}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
{\rm ent} \equiv \beta \sum_{t=0}^\infty \beta^t w_{t+1}' w_{t+1}
\]</div>
<p>The left side of inequality <a class="reference internal" href="#equation-robboundmax">(42.17)</a> is a straight line with slope <span class="math notranslate nohighlight">\(\tilde \theta\)</span>.</p>
<p>The upper bound on the left side of <a class="reference internal" href="#equation-robboundmax">(42.17)</a> is attained when</p>
<div class="math notranslate nohighlight" id="equation-rbpdt223">
<span class="eqno">(42.18)<a class="headerlink" href="#equation-rbpdt223" title="Permalink to this equation">¶</a></span>\[{\rm ent} =  \beta \sum_{t=0}^{\infty} \beta^t x_t' K(F, \tilde \theta)' K(F, \tilde \theta) x_t\]</div>
<p>To construct the <em>upper bound</em> on the set of values associated all perturbations <span class="math notranslate nohighlight">\({\mathbf w}\)</span> with a given entropy we proceed much as we did for the lower bound.</p>
<ul class="simple">
<li><p>For a given <span class="math notranslate nohighlight">\(\tilde \theta\)</span>, solve the maximization problem <a class="reference internal" href="#equation-rba2omax">(42.16)</a>.</p></li>
<li><p>Compute the maximizer <span class="math notranslate nohighlight">\(V_{\tilde \theta}(x_0, F)\)</span> and the associated entropy using <a class="reference internal" href="#equation-rbpdt223">(42.18)</a>.</p></li>
<li><p>Compute the upper bound on the value function <span class="math notranslate nohighlight">\(V_{\tilde \theta}(x_0, F) + \tilde \theta \ {\rm ent}\)</span> and plot it against <span class="math notranslate nohighlight">\({\rm ent}\)</span>.</p></li>
<li><p>Repeat the preceding three steps  for a range of values of <span class="math notranslate nohighlight">\(\tilde \theta\)</span> to trace out the upper bound.</p></li>
</ul>
</div>
<div class="section" id="reshaping-the-set-of-values">
<h4><span class="section-number">42.4.2.3. </span>Reshaping the set of values<a class="headerlink" href="#reshaping-the-set-of-values" title="Permalink to this headline">¶</a></h4>
<p>Now in the interest of <em>reshaping</em> these sets of values by choosing <span class="math notranslate nohighlight">\(F\)</span>, we turn to agent 1’s problem.</p>
</div>
</div>
<div class="section" id="agent-1-s-problem">
<h3><span class="section-number">42.4.3. </span>Agent 1’s Problem<a class="headerlink" href="#agent-1-s-problem" title="Permalink to this headline">¶</a></h3>
<p>Now we turn to agent 1, who solves</p>
<div class="math notranslate nohighlight" id="equation-rob-sihk">
<span class="eqno">(42.19)<a class="headerlink" href="#equation-rob-sihk" title="Permalink to this equation">¶</a></span>\[\min_{\{u_t\}}
    \sum_{t=0}^{\infty} \beta^t
    \left\{
        x_t' R x_t + u_t' Q u_t - \beta \theta w_{t+1}' w_{t+1}
    \right\}\]</div>
<p>where  <span class="math notranslate nohighlight">\(\{ w_{t+1} \}\)</span>  satisfies <span class="math notranslate nohighlight">\(w_{t+1} = K x_t\)</span>.</p>
<p>In other words, agent 1 minimizes</p>
<div class="math notranslate nohighlight" id="equation-rob-sihk2">
<span class="eqno">(42.20)<a class="headerlink" href="#equation-rob-sihk2" title="Permalink to this equation">¶</a></span>\[\sum_{t=0}^{\infty} \beta^t
    \left\{
        x_t' (R - \beta \theta K' K ) x_t + u_t' Q u_t
    \right\}\]</div>
<p>subject to</p>
<div class="math notranslate nohighlight" id="equation-rob-lomk">
<span class="eqno">(42.21)<a class="headerlink" href="#equation-rob-lomk" title="Permalink to this equation">¶</a></span>\[x_{t+1} = (A + C K) x_t + B u_t\]</div>
<p>Once again, the expression for the optimal policy can be found <a class="reference internal" href="lqcontrol.html#lq-ih"><span class="std std-ref">here</span></a> — we denote
it by <span class="math notranslate nohighlight">\(\tilde F\)</span>.</p>
</div>
<div class="section" id="nash-equilibrium">
<span id="rb-eq"></span><h3><span class="section-number">42.4.4. </span>Nash Equilibrium<a class="headerlink" href="#nash-equilibrium" title="Permalink to this headline">¶</a></h3>
<p>Clearly the <span class="math notranslate nohighlight">\(\tilde F\)</span> we have obtained depends on <span class="math notranslate nohighlight">\(K\)</span>, which, in agent 2’s problem,
depended on an initial policy <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>Holding all other parameters fixed, we can represent this relationship as a mapping <span class="math notranslate nohighlight">\(\Phi\)</span>, where</p>
<div class="math notranslate nohighlight">
\[
\tilde F = \Phi(K(F, \theta))
\]</div>
<p>The map <span class="math notranslate nohighlight">\(F \mapsto \Phi (K(F, \theta))\)</span> corresponds to a situation in which</p>
<ol class="simple">
<li><p>agent 1 uses an arbitrary initial policy <span class="math notranslate nohighlight">\(F\)</span></p></li>
<li><p>agent 2 best responds to agent 1 by choosing <span class="math notranslate nohighlight">\(K(F, \theta)\)</span></p></li>
<li><p>agent 1 best responds to agent 2 by choosing <span class="math notranslate nohighlight">\(\tilde F = \Phi (K(F, \theta))\)</span></p></li>
</ol>
<p>As you may have already guessed, the robust policy <span class="math notranslate nohighlight">\(\hat F\)</span> defined in <a class="reference internal" href="#equation-rb-oc-ih">(42.7)</a> is a fixed point of the mapping <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<p>In particular, for any given <span class="math notranslate nohighlight">\(\theta\)</span>,</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(K(\hat F, \theta) = \hat K\)</span>, where <span class="math notranslate nohighlight">\(\hat K\)</span> is as given in <a class="reference internal" href="#equation-rb-kd">(42.8)</a></p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi(\hat K) = \hat F\)</span></p></li>
</ol>
<p>A sketch of the proof is given in <a class="reference internal" href="#rb-appendix"><span class="std std-ref">the appendix</span></a>.</p>
</div>
</div>
<div class="section" id="the-stochastic-case">
<h2><a class="toc-backref" href="#id9"><span class="section-number">42.5. </span>The Stochastic Case</a><a class="headerlink" href="#the-stochastic-case" title="Permalink to this headline">¶</a></h2>
<p>Now we turn to the stochastic case, where the sequence <span class="math notranslate nohighlight">\(\{w_t\}\)</span> is treated as an iid sequence of random vectors.</p>
<p>In this setting, we suppose that our agent is uncertain about the <em>conditional probability distribution</em> of <span class="math notranslate nohighlight">\(w_{t+1}\)</span>.</p>
<p>The agent takes the standard normal distribution <span class="math notranslate nohighlight">\(N(0, I)\)</span> as the baseline conditional distribution, while admitting the possibility that other “nearby” distributions prevail.</p>
<p>These alternative conditional distributions of <span class="math notranslate nohighlight">\(w_{t+1}\)</span> might depend nonlinearly on the history  <span class="math notranslate nohighlight">\(x_s, s \leq t\)</span>.</p>
<p>To implement this idea, we need a notion of what it means for one distribution
to be near another one.</p>
<p>Here we adopt a very useful measure of closeness for distributions known as the <em>relative entropy</em>, or <a class="reference external" href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback-Leibler divergence</a>.</p>
<p>For densities <span class="math notranslate nohighlight">\(p, q\)</span>, the Kullback-Leibler divergence of <span class="math notranslate nohighlight">\(q\)</span> from <span class="math notranslate nohighlight">\(p\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
D_{KL} (p, q) := \int \ln \left[ \frac{p(x)}{q(x)} \right] p(x) \, dx
\]</div>
<p>Using this notation, we replace <a class="reference internal" href="#equation-rb-wcb0">(42.3)</a> with the stochastic analogue</p>
<div class="math notranslate nohighlight" id="equation-rb-wcb1">
<span class="eqno">(42.22)<a class="headerlink" href="#equation-rb-wcb1" title="Permalink to this equation">¶</a></span>\[J (x) =
\min_u
\max_{\psi \in \mathcal P}
\left\{
    x' R x + u' Q u + \beta \,
    \left[
    \int J (Ax + B u + C w) \, \psi(dw) - \theta D_{KL}(\psi, \phi)
    \right]
\right\}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\mathcal P\)</span> represents the set of all densities on <span class="math notranslate nohighlight">\(\mathbb R^n\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> is the benchmark distribution <span class="math notranslate nohighlight">\(N(0, I)\)</span>.</p>
<p>The distribution <span class="math notranslate nohighlight">\(\phi\)</span> is chosen as the least desirable conditional distribution in terms of next period outcomes, while taking into account the penalty term <span class="math notranslate nohighlight">\(\theta D_{KL}(\psi, \phi)\)</span>.</p>
<p>This penalty term plays a role analogous to the one played by the deterministic penalty <span class="math notranslate nohighlight">\(\theta w'w\)</span> in <a class="reference internal" href="#equation-rb-wcb0">(42.3)</a>, since it discourages large deviations from the benchmark.</p>
<div class="section" id="solving-the-model">
<h3><span class="section-number">42.5.1. </span>Solving the Model<a class="headerlink" href="#solving-the-model" title="Permalink to this headline">¶</a></h3>
<p>The maximization problem in <a class="reference internal" href="#equation-rb-wcb1">(42.22)</a> appears highly nontrivial — after all,
we are maximizing over an infinite dimensional space consisting of the entire set of densities.</p>
<p>However, it turns out that the solution is  tractable, and in fact also falls within the class of normal distributions.</p>
<p>First, we note that <span class="math notranslate nohighlight">\(J\)</span> has the form <span class="math notranslate nohighlight">\(J(x) = x' P x + d\)</span> for some positive definite matrix <span class="math notranslate nohighlight">\(P\)</span> and constant real number <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>Moreover, it turns out that if <span class="math notranslate nohighlight">\((I - \theta^{-1} C' P C)^{-1}\)</span> is nonsingular, then</p>
<div class="math notranslate nohighlight" id="equation-rb-mls">
<span class="eqno">(42.23)<a class="headerlink" href="#equation-rb-mls" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\max_{\psi \in \mathcal P}
&amp;\left\{
    \int (Ax + B u + C w)' P (Ax + B u + C w) \, \psi(dw) - \theta D_{KL}(\psi, \phi)
\right\}
\\
&amp; \hspace{20mm} = (Ax + Bu)' \mathcal D (P) (Ax + Bu) + \kappa(\theta, P)
\end{aligned}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
\kappa(\theta, P) := \theta \ln [ \det(I - \theta^{-1} C' P C)^{-1} ]
\]</div>
<p>and the maximizer is the Gaussian distribution</p>
<div class="math notranslate nohighlight" id="equation-rb-md">
<span class="eqno">(42.24)<a class="headerlink" href="#equation-rb-md" title="Permalink to this equation">¶</a></span>\[\psi = N
\left(
    (\theta I -  C' P C)^{-1} C' P (Ax + Bu), (I - \theta^{-1} C' P C)^{-1}
\right)\]</div>
<p>Substituting the expression for the maximum into  Bellman equation
<a class="reference internal" href="#equation-rb-wcb1">(42.22)</a> and using <span class="math notranslate nohighlight">\(J(x) = x'Px + d\)</span> gives</p>
<div class="math notranslate nohighlight" id="equation-rb-wcb2">
<span class="eqno">(42.25)<a class="headerlink" href="#equation-rb-wcb2" title="Permalink to this equation">¶</a></span>\[x' P x + d =
\min_u
\left\{
    x' R x + u' Q u + \beta \,
    (Ax + Bu)' \mathcal D (P) (Ax + Bu) + \beta \, [d + \kappa(\theta, P)]
\right\}\]</div>
<p>Since constant terms do not affect minimizers, the solution is the same as
<a class="reference internal" href="#equation-rb-owb">(42.6)</a>, leading to</p>
<div class="math notranslate nohighlight">
\[
x' P x + d
= x' \mathcal B( \mathcal D(P)) x + \beta \, [d + \kappa(\theta, P)]
\]</div>
<p>To solve this Bellman equation, we take <span class="math notranslate nohighlight">\(\hat P\)</span> to be the positive definite fixed point of
<span class="math notranslate nohighlight">\(\mathcal B \circ \mathcal D\)</span>.</p>
<p>In addition, we take <span class="math notranslate nohighlight">\(\hat d\)</span> as the real number solving <span class="math notranslate nohighlight">\(d = \beta \, [d + \kappa(\theta, P)]\)</span>, which is</p>
<div class="math notranslate nohighlight" id="equation-rb-hatd">
<span class="eqno">(42.26)<a class="headerlink" href="#equation-rb-hatd" title="Permalink to this equation">¶</a></span>\[\hat d := \frac{\beta}{1 - \beta} \kappa(\theta, P)\]</div>
<p>The robust policy in this stochastic case is the minimizer in
<a class="reference internal" href="#equation-rb-wcb2">(42.25)</a>, which is once again <span class="math notranslate nohighlight">\(u  = - \hat F x\)</span> for <span class="math notranslate nohighlight">\(\hat F\)</span> given by <a class="reference internal" href="#equation-rb-oc-ih">(42.7)</a>.</p>
<p>Substituting the robust policy into <a class="reference internal" href="#equation-rb-md">(42.24)</a> we obtain the worst case shock
distribution:</p>
<div class="math notranslate nohighlight">
\[
w_{t+1} \sim
N( \hat K x_t, (I - \theta^{-1} C' \hat PC)^{-1} )
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat K\)</span> is given by <a class="reference internal" href="#equation-rb-kd">(42.8)</a>.</p>
<p>Note that the mean of the worst-case shock distribution is equal to the same  worst-case <span class="math notranslate nohighlight">\(w_{t+1}\)</span> as in the earlier deterministic setting.</p>
</div>
<div class="section" id="computing-other-quantities">
<span id="rb-coq"></span><h3><span class="section-number">42.5.2. </span>Computing Other Quantities<a class="headerlink" href="#computing-other-quantities" title="Permalink to this headline">¶</a></h3>
<p>Before turning to implementation, we briefly outline how to compute several other quantities of interest.</p>
<div class="section" id="worst-case-value-of-a-policy">
<h4><span class="section-number">42.5.2.1. </span>Worst-Case Value of a Policy<a class="headerlink" href="#worst-case-value-of-a-policy" title="Permalink to this headline">¶</a></h4>
<p>One thing we will be interested in doing is holding a policy fixed and
computing the discounted loss associated with that policy.</p>
<p>So let <span class="math notranslate nohighlight">\(F\)</span> be a given policy and let <span class="math notranslate nohighlight">\(J_F(x)\)</span> be
the associated loss, which, by analogy with <a class="reference internal" href="#equation-rb-wcb1">(42.22)</a>, satisfies</p>
<div class="math notranslate nohighlight">
\[
J_F(x)
=
\max_{\psi \in \mathcal P}
\left\{
    x' (R + F'QF) x + \beta \,
    \left[
    \int J_F ( (A - BF)x + C w) \, \psi(dw) - \theta D_{KL}(\psi, \phi)
    \right]
\right\}
\]</div>
<p>Writing <span class="math notranslate nohighlight">\(J_F(x) = x'P_Fx + d_F\)</span> and applying the same argument used to
derive <a class="reference internal" href="#equation-rb-mls">(42.23)</a> we get</p>
<div class="math notranslate nohighlight">
\[
x' P_F x + d_F
=
x' (R + F'QF) x + \beta \,
\left[
 x' (A - BF)' \mathcal D(P_F) (A - BF) x + d_F + \kappa(\theta, P_F)
\right]
\]</div>
<p>To solve this we take <span class="math notranslate nohighlight">\(P_F\)</span> to be the fixed point</p>
<div class="math notranslate nohighlight">
\[
P_F = R + F'QF + \beta (A - BF)' \mathcal D(P_F) (A - BF)
\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-rb-hatd2">
<span class="eqno">(42.27)<a class="headerlink" href="#equation-rb-hatd2" title="Permalink to this equation">¶</a></span>\[d_F
:= \frac{\beta}{1 - \beta} \kappa(\theta, P_F)
= \frac{\beta}{1 - \beta}
 \theta \ln [ \det(I - \theta^{-1} C' P_F C)^{-1} ]\]</div>
<p>If you skip ahead to <a class="reference internal" href="#rb-appendix"><span class="std std-ref">the appendix</span></a>, you will be able to
verify that <span class="math notranslate nohighlight">\(-P_F\)</span> is the solution to the Bellman equation in
agent 2’s problem <a class="reference internal" href="#rb-a2"><span class="std std-ref">discussed above</span></a>  — we use this in our
computations.</p>
</div>
</div>
</div>
<div class="section" id="implementation">
<h2><a class="toc-backref" href="#id10"><span class="section-number">42.6. </span>Implementation</a><a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://quantecon.org/quantecon-jl">QuantEcon.jl</a> package provides a type called <code class="docutils literal notranslate"><span class="pre">RBLQ</span></code> for implementation of robust LQ optimal control.</p>
<p>The code can be found <a class="reference external" href="https://github.com/QuantEcon/QuantEcon.jl/blob/master/src/robustlq.jl">on GitHub</a>.</p>
<p>Here is a brief description of the methods of the type</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d_operator()</span></code> and <code class="docutils literal notranslate"><span class="pre">b_operator()</span></code> implement <span class="math notranslate nohighlight">\(\mathcal D\)</span>
and <span class="math notranslate nohighlight">\(\mathcal B\)</span> respectively</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">robust_rule()</span></code> and <code class="docutils literal notranslate"><span class="pre">robust_rule_simple()</span></code> both solve for the
triple <span class="math notranslate nohighlight">\(\hat F, \hat K, \hat P\)</span>, as described in equations <a class="reference internal" href="#equation-rb-oc-ih">(42.7)</a> – <a class="reference internal" href="#equation-rb-kd">(42.8)</a> and the surrounding discussion</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">robust_rule()</span></code> is more efficient</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">robust_rule_simple()</span></code> is more transparent and easier to follow</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">K_to_F()</span></code> and <code class="docutils literal notranslate"><span class="pre">F_to_K()</span></code> solve the decision problems
of <a class="reference internal" href="#rb-a1"><span class="std std-ref">agent 1</span></a> and <a class="reference internal" href="#rb-a2"><span class="std std-ref">agent 2</span></a> respectively</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_deterministic_entropy()</span></code> computes the left-hand side of <a class="reference internal" href="#equation-rb-pdt">(42.13)</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evaluate_F()</span></code> computes the loss and entropy associated with a given
policy — see <a class="reference internal" href="#rb-coq"><span class="std std-ref">this discussion</span></a></p></li>
</ul>
</div>
<div class="section" id="application">
<h2><a class="toc-backref" href="#id11"><span class="section-number">42.7. </span>Application</a><a class="headerlink" href="#application" title="Permalink to this headline">¶</a></h2>
<p>Let us consider a monopolist similar to <a class="reference internal" href="lqcontrol.html#lqc-mwac"><span class="std std-ref">this one</span></a>, but now facing model uncertainty.</p>
<p>The inverse demand function is <span class="math notranslate nohighlight">\(p_t = a_0 - a_1 y_t + d_t\)</span></p>
<p>where</p>
<div class="math notranslate nohighlight">
\[
d_{t+1} = \rho d_t + \sigma_d w_{t+1},
\quad \{w_t\} \stackrel{\textrm{iid}}{\sim} N(0,1)
\]</div>
<p>and all parameters are strictly positive.</p>
<p>The period return function for the monopolist is</p>
<div class="math notranslate nohighlight">
\[
r_t =  p_t y_t - \gamma \frac{(y_{t+1} - y_t)^2}{2} - c y_t
\]</div>
<p>Its objective is to maximize expected discounted profits, or, equivalently, to minimize <span class="math notranslate nohighlight">\(\mathbb E \sum_{t=0}^\infty \beta^t (- r_t)\)</span>.</p>
<p>To form a linear regulator problem, we take the state and control to be</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_t
= \begin{bmatrix}
      1 \\ y_t \\ d_t
  \end{bmatrix}
  \quad \text{and} \quad
  u_t = y_{t+1} - y_t
\end{split}\]</div>
<p>Setting <span class="math notranslate nohighlight">\(b := (a_0 - c) / 2\)</span> we define</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R
= -
\begin{bmatrix}
   0 &amp;  b &amp; 0 \\
   b &amp; -a_1 &amp; 1/2 \\
   0 &amp; 1/2 &amp; 0
\end{bmatrix}
\quad \text{and} \quad
Q = \gamma / 2
\end{split}\]</div>
<p>For the transition matrices we set</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A
= \begin{bmatrix}
   1 &amp; 0 &amp; 0 \\
   0 &amp; 1 &amp; 0 \\
   0 &amp; 0 &amp; \rho
  \end{bmatrix},
\qquad
B
= \begin{bmatrix}
   0 \\
   1 \\
   0
  \end{bmatrix},
\qquad
C
= \begin{bmatrix}
   0 \\
   0 \\
   \sigma_d
  \end{bmatrix}
\end{split}\]</div>
<p>Our aim is to compute the value-entropy correspondences <a class="reference internal" href="#rb-vec"><span class="std std-ref">shown above</span></a>.</p>
<p>The parameters are</p>
<div class="math notranslate nohighlight">
\[
a_0 = 100, a_1 = 0.5, \rho = 0.9, \sigma_d = 0.05, \beta = 0.95, c = 2, \gamma = 50.0
\]</div>
<p>The standard normal distribution for <span class="math notranslate nohighlight">\(w_t\)</span> is understood as the
agent’s baseline, with uncertainty parameterized by <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>We compute value-entropy correspondences for two policies.</p>
<ol class="simple">
<li><p>The no concern for robustness policy <span class="math notranslate nohighlight">\(F_0\)</span>, which is the ordinary LQ
loss minimizer.</p></li>
<li><p>A “moderate” concern for robustness policy <span class="math notranslate nohighlight">\(F_b\)</span>, with <span class="math notranslate nohighlight">\(\theta = 0.02\)</span>.</p></li>
</ol>
<p>The code for producing the graph shown above, with blue being for the robust policy, is as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">QuantEcon</span><span class="p">,</span><span class="w"> </span><span class="n">Plots</span><span class="p">,</span><span class="w"> </span><span class="n">LinearAlgebra</span><span class="p">,</span><span class="w"> </span><span class="n">Interpolations</span>


<span class="c"># model parameters</span>
<span class="n">a_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="n">a_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span>
<span class="n">ρ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9</span>
<span class="n">σ_d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span>
<span class="n">β</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.95</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="n">γ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">50.0</span>
<span class="n">θ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.002</span>
<span class="n">ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a_0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span>

<span class="c"># Define LQ matrices</span>
<span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="n">ac</span><span class="w">    </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">ac</span><span class="w"> </span><span class="o">-</span><span class="n">a_1</span><span class="w">  </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">    </span><span class="mf">0.</span><span class="w">  </span><span class="mf">0.5</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span>
<span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">R</span><span class="w">  </span><span class="c"># For minimization</span>
<span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Matrix</span><span class="p">([</span><span class="n">γ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">]</span><span class="o">&#39;</span><span class="p">)</span>
<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="w">    </span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
<span class="w">    </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="w">  </span><span class="n">ρ</span><span class="p">]</span>
<span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="o">&#39;</span>
<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="n">σ_d</span><span class="p">]</span><span class="o">&#39;</span>

<span class="c">## Functions</span>

<span class="k">function</span><span class="w"> </span><span class="n">evaluate_policy</span><span class="p">(</span><span class="n">θ</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">)</span>
<span class="w">    </span><span class="n">rlq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RBLQ</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">β</span><span class="p">,</span><span class="w"> </span><span class="n">θ</span><span class="p">)</span>
<span class="w">    </span><span class="n">K_F</span><span class="p">,</span><span class="w"> </span><span class="n">P_F</span><span class="p">,</span><span class="w"> </span><span class="n">d_F</span><span class="p">,</span><span class="w"> </span><span class="n">O_F</span><span class="p">,</span><span class="w"> </span><span class="n">o_F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evaluate_F</span><span class="p">(</span><span class="n">rlq</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">)</span>
<span class="w">    </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="p">]</span><span class="o">&#39;</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x0</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">P_F</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x0</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="n">d_F</span>
<span class="w">    </span><span class="n">entropy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x0</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">O_F</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x0</span><span class="w"> </span><span class="o">.+</span><span class="w"> </span><span class="n">o_F</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">entropy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">    </span><span class="c"># return scalars</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">value_and_entropy</span><span class="p">(</span><span class="n">emax</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">grid_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">lowercase</span><span class="p">(</span><span class="n">bw</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;worst&quot;</span>
<span class="w">        </span><span class="n">θs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span><span class="w">  </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">θs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span><span class="w">  </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">grid_size</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">θs</span><span class="p">)</span>
<span class="w">        </span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collect</span><span class="p">(</span><span class="n">evaluate_policy</span><span class="p">(</span><span class="n">θ</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">))</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">≥</span><span class="w"> </span><span class="n">emax</span><span class="w">      </span><span class="c"># stop at this entropy level</span>
<span class="w">            </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">]</span>
<span class="w">            </span><span class="k">break</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">data</span>
<span class="k">end</span>

<span class="c">## Main</span>

<span class="c"># compute optimal rule</span>
<span class="n">optimal_lq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuantEcon</span><span class="o">.</span><span class="n">LQ</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">(</span><span class="n">B</span><span class="o">&#39;</span><span class="n">A</span><span class="p">),</span><span class="w"> </span><span class="n">bet</span><span class="o">=</span><span class="n">β</span><span class="p">)</span>
<span class="n">Po</span><span class="p">,</span><span class="w"> </span><span class="n">Fo</span><span class="p">,</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stationary_values</span><span class="p">(</span><span class="n">optimal_lq</span><span class="p">)</span>

<span class="c"># compute robust rule for our θ</span>
<span class="n">baseline_robust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RBLQ</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">β</span><span class="p">,</span><span class="w"> </span><span class="n">θ</span><span class="p">)</span>
<span class="n">Fb</span><span class="p">,</span><span class="w"> </span><span class="n">Kb</span><span class="p">,</span><span class="w"> </span><span class="n">Pb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">robust_rule</span><span class="p">(</span><span class="n">baseline_robust</span><span class="p">)</span>

<span class="c"># Check the positive definiteness of worst-case covariance matrix to</span>
<span class="c"># ensure that θ exceeds the breakdown point</span>
<span class="n">test_matrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">C</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Pb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">θ</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">eigenvals</span><span class="p">,</span><span class="w"> </span><span class="n">eigenvecs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eigen</span><span class="p">(</span><span class="n">test_matrix</span><span class="p">)</span>
<span class="nd">@assert</span><span class="w"> </span><span class="n">all</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">≥</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">eigenvals</span><span class="p">)</span>

<span class="n">emax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.6e6</span>

<span class="c"># compute values and entropies</span>
<span class="n">optimal_best_case</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value_and_entropy</span><span class="p">(</span><span class="n">emax</span><span class="p">,</span><span class="w"> </span><span class="n">Fo</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;best&quot;</span><span class="p">)</span>
<span class="n">robust_best_case</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value_and_entropy</span><span class="p">(</span><span class="n">emax</span><span class="p">,</span><span class="w"> </span><span class="n">Fb</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;best&quot;</span><span class="p">)</span>
<span class="n">optimal_worst_case</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value_and_entropy</span><span class="p">(</span><span class="n">emax</span><span class="p">,</span><span class="w"> </span><span class="n">Fo</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;worst&quot;</span><span class="p">)</span>
<span class="n">robust_worst_case</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value_and_entropy</span><span class="p">(</span><span class="n">emax</span><span class="p">,</span><span class="w"> </span><span class="n">Fb</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;worst&quot;</span><span class="p">)</span>

<span class="c"># we reverse order of &quot;worst_case&quot;s so values are ascending</span>
<span class="n">data_pairs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">optimal_best_case</span><span class="p">,</span><span class="w"> </span><span class="n">optimal_worst_case</span><span class="p">),</span>
<span class="w">              </span><span class="p">(</span><span class="n">robust_best_case</span><span class="p">,</span><span class="w"> </span><span class="n">robust_worst_case</span><span class="p">))</span>

<span class="n">egrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="n">emax</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
<span class="n">egrid_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">data_pair</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">data_pairs</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">data_pair</span>
<span class="w">        </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="w">        </span><span class="n">curve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LinearInterpolation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">extrapolation_bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Line</span><span class="p">())</span>
<span class="w">        </span><span class="n">push!</span><span class="p">(</span><span class="n">egrid_data</span><span class="p">,</span><span class="w"> </span><span class="n">curve</span><span class="o">.</span><span class="p">(</span><span class="n">egrid</span><span class="p">))</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
<span class="n">plot</span><span class="p">(</span><span class="n">egrid</span><span class="p">,</span><span class="w"> </span><span class="n">egrid_data</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="ss">:red</span><span class="w"> </span><span class="ss">:red</span><span class="w"> </span><span class="ss">:blue</span><span class="w"> </span><span class="ss">:blue</span><span class="p">])</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">egrid</span><span class="p">,</span><span class="w"> </span><span class="n">egrid_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">fillrange</span><span class="o">=</span><span class="n">egrid_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="w">    </span><span class="n">fillcolor</span><span class="o">=</span><span class="ss">:red</span><span class="p">,</span><span class="w"> </span><span class="n">fillalpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="ss">:red</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="o">=</span><span class="ss">:none</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">egrid</span><span class="p">,</span><span class="w"> </span><span class="n">egrid_data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">fillrange</span><span class="o">=</span><span class="n">egrid_data</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
<span class="w">    </span><span class="n">fillcolor</span><span class="o">=</span><span class="ss">:blue</span><span class="p">,</span><span class="w"> </span><span class="n">fillalpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="ss">:blue</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="o">=</span><span class="ss">:none</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;Entropy&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;Value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip020">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip020)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip021">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip020)" d="M370.19 1410.9 L2352.76 1410.9 L2352.76 47.2441 L370.19 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip022">
    <rect x="370" y="47" width="1984" height="1365"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="426.3,1410.9 426.3,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1010.78,1410.9 1010.78,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1595.27,1410.9 1595.27,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2179.75,1410.9 2179.75,47.2441 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="370.19,1410.9 2352.76,1410.9 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="426.3,1410.9 426.3,1392 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1010.78,1410.9 1010.78,1392 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1595.27,1410.9 1595.27,1392 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2179.75,1410.9 2179.75,1392 "/>
<path clip-path="url(#clip020)" d="M426.3 1441.82 Q422.689 1441.82 420.86 1445.38 Q419.055 1448.92 419.055 1456.05 Q419.055 1463.16 420.86 1466.72 Q422.689 1470.26 426.3 1470.26 Q429.934 1470.26 431.74 1466.72 Q433.568 1463.16 433.568 1456.05 Q433.568 1448.92 431.74 1445.38 Q429.934 1441.82 426.3 1441.82 M426.3 1438.11 Q432.11 1438.11 435.166 1442.72 Q438.244 1447.3 438.244 1456.05 Q438.244 1464.78 435.166 1469.38 Q432.11 1473.97 426.3 1473.97 Q420.49 1473.97 417.411 1469.38 Q414.356 1464.78 414.356 1456.05 Q414.356 1447.3 417.411 1442.72 Q420.49 1438.11 426.3 1438.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M903.759 1454.4 L922.116 1454.4 L922.116 1458.33 L908.042 1458.33 L908.042 1466.8 Q909.06 1466.46 910.079 1466.29 Q911.097 1466.11 912.116 1466.11 Q917.903 1466.11 921.283 1469.28 Q924.662 1472.45 924.662 1477.87 Q924.662 1483.45 921.19 1486.55 Q917.718 1489.63 911.398 1489.63 Q909.222 1489.63 906.954 1489.26 Q904.709 1488.89 902.301 1488.15 L902.301 1483.45 Q904.384 1484.58 906.607 1485.14 Q908.829 1485.69 911.306 1485.69 Q915.31 1485.69 917.648 1483.59 Q919.986 1481.48 919.986 1477.87 Q919.986 1474.26 917.648 1472.15 Q915.31 1470.04 911.306 1470.04 Q909.431 1470.04 907.556 1470.46 Q905.704 1470.88 903.759 1471.76 L903.759 1454.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M933.875 1483.08 L938.759 1483.08 L938.759 1488.96 L933.875 1488.96 L933.875 1483.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M958.944 1457.48 Q955.333 1457.48 953.505 1461.04 Q951.699 1464.58 951.699 1471.71 Q951.699 1478.82 953.505 1482.38 Q955.333 1485.92 958.944 1485.92 Q962.579 1485.92 964.384 1482.38 Q966.213 1478.82 966.213 1471.71 Q966.213 1464.58 964.384 1461.04 Q962.579 1457.48 958.944 1457.48 M958.944 1453.77 Q964.755 1453.77 967.81 1458.38 Q970.889 1462.96 970.889 1471.71 Q970.889 1480.44 967.81 1485.04 Q964.755 1489.63 958.944 1489.63 Q953.134 1489.63 950.056 1485.04 Q947 1480.44 947 1471.71 Q947 1462.96 950.056 1458.38 Q953.134 1453.77 958.944 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M989.106 1457.48 Q985.495 1457.48 983.666 1461.04 Q981.861 1464.58 981.861 1471.71 Q981.861 1478.82 983.666 1482.38 Q985.495 1485.92 989.106 1485.92 Q992.74 1485.92 994.546 1482.38 Q996.375 1478.82 996.375 1471.71 Q996.375 1464.58 994.546 1461.04 Q992.74 1457.48 989.106 1457.48 M989.106 1453.77 Q994.916 1453.77 997.972 1458.38 Q1001.05 1462.96 1001.05 1471.71 Q1001.05 1480.44 997.972 1485.04 Q994.916 1489.63 989.106 1489.63 Q983.296 1489.63 980.217 1485.04 Q977.162 1480.44 977.162 1471.71 Q977.162 1462.96 980.217 1458.38 Q983.296 1453.77 989.106 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1037.44 1463.49 L1026.86 1474.12 L1037.44 1484.7 L1034.68 1487.5 L1024.06 1476.87 L1013.43 1487.5 L1010.7 1484.7 L1021.26 1474.12 L1010.7 1463.49 L1013.43 1460.69 L1024.06 1471.32 L1034.68 1460.69 L1037.44 1463.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1049.8 1485.02 L1057.44 1485.02 L1057.44 1458.66 L1049.13 1460.32 L1049.13 1456.06 L1057.39 1454.4 L1062.07 1454.4 L1062.07 1485.02 L1069.71 1485.02 L1069.71 1488.96 L1049.8 1488.96 L1049.8 1485.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1089.15 1457.48 Q1085.54 1457.48 1083.71 1461.04 Q1081.91 1464.58 1081.91 1471.71 Q1081.91 1478.82 1083.71 1482.38 Q1085.54 1485.92 1089.15 1485.92 Q1092.79 1485.92 1094.59 1482.38 Q1096.42 1478.82 1096.42 1471.71 Q1096.42 1464.58 1094.59 1461.04 Q1092.79 1457.48 1089.15 1457.48 M1089.15 1453.77 Q1094.96 1453.77 1098.02 1458.38 Q1101.1 1462.96 1101.1 1471.71 Q1101.1 1480.44 1098.02 1485.04 Q1094.96 1489.63 1089.15 1489.63 Q1083.34 1489.63 1080.26 1485.04 Q1077.21 1480.44 1077.21 1471.71 Q1077.21 1462.96 1080.26 1458.38 Q1083.34 1453.77 1089.15 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1102.28 1433.47 L1117.2 1433.47 L1117.2 1436.66 L1105.76 1436.66 L1105.76 1443.55 Q1106.59 1443.27 1107.42 1443.13 Q1108.24 1442.98 1109.07 1442.98 Q1113.77 1442.98 1116.52 1445.56 Q1119.26 1448.14 1119.26 1452.54 Q1119.26 1457.07 1116.44 1459.59 Q1113.62 1462.09 1108.49 1462.09 Q1106.72 1462.09 1104.88 1461.79 Q1103.05 1461.49 1101.1 1460.89 L1101.1 1457.07 Q1102.79 1457.99 1104.59 1458.44 Q1106.4 1458.89 1108.41 1458.89 Q1111.67 1458.89 1113.57 1457.18 Q1115.47 1455.47 1115.47 1452.54 Q1115.47 1449.6 1113.57 1447.89 Q1111.67 1446.18 1108.41 1446.18 Q1106.89 1446.18 1105.37 1446.52 Q1103.86 1446.86 1102.28 1447.57 L1102.28 1433.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1487.62 1485.02 L1495.26 1485.02 L1495.26 1458.66 L1486.95 1460.32 L1486.95 1456.06 L1495.21 1454.4 L1499.89 1454.4 L1499.89 1485.02 L1507.53 1485.02 L1507.53 1488.96 L1487.62 1488.96 L1487.62 1485.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1516.97 1483.08 L1521.86 1483.08 L1521.86 1488.96 L1516.97 1488.96 L1516.97 1483.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1542.04 1457.48 Q1538.43 1457.48 1536.6 1461.04 Q1534.8 1464.58 1534.8 1471.71 Q1534.8 1478.82 1536.6 1482.38 Q1538.43 1485.92 1542.04 1485.92 Q1545.67 1485.92 1547.48 1482.38 Q1549.31 1478.82 1549.31 1471.71 Q1549.31 1464.58 1547.48 1461.04 Q1545.67 1457.48 1542.04 1457.48 M1542.04 1453.77 Q1547.85 1453.77 1550.91 1458.38 Q1553.99 1462.96 1553.99 1471.71 Q1553.99 1480.44 1550.91 1485.04 Q1547.85 1489.63 1542.04 1489.63 Q1536.23 1489.63 1533.15 1485.04 Q1530.1 1480.44 1530.1 1471.71 Q1530.1 1462.96 1533.15 1458.38 Q1536.23 1453.77 1542.04 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1572.2 1457.48 Q1568.59 1457.48 1566.76 1461.04 Q1564.96 1464.58 1564.96 1471.71 Q1564.96 1478.82 1566.76 1482.38 Q1568.59 1485.92 1572.2 1485.92 Q1575.84 1485.92 1577.64 1482.38 Q1579.47 1478.82 1579.47 1471.71 Q1579.47 1464.58 1577.64 1461.04 Q1575.84 1457.48 1572.2 1457.48 M1572.2 1453.77 Q1578.01 1453.77 1581.07 1458.38 Q1584.15 1462.96 1584.15 1471.71 Q1584.15 1480.44 1581.07 1485.04 Q1578.01 1489.63 1572.2 1489.63 Q1566.39 1489.63 1563.31 1485.04 Q1560.26 1480.44 1560.26 1471.71 Q1560.26 1462.96 1563.31 1458.38 Q1566.39 1453.77 1572.2 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1620.54 1463.49 L1609.96 1474.12 L1620.54 1484.7 L1617.78 1487.5 L1607.16 1476.87 L1596.53 1487.5 L1593.8 1484.7 L1604.36 1474.12 L1593.8 1463.49 L1596.53 1460.69 L1607.16 1471.32 L1617.78 1460.69 L1620.54 1463.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1632.9 1485.02 L1640.54 1485.02 L1640.54 1458.66 L1632.23 1460.32 L1632.23 1456.06 L1640.49 1454.4 L1645.17 1454.4 L1645.17 1485.02 L1652.8 1485.02 L1652.8 1488.96 L1632.9 1488.96 L1632.9 1485.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1672.25 1457.48 Q1668.64 1457.48 1666.81 1461.04 Q1665 1464.58 1665 1471.71 Q1665 1478.82 1666.81 1482.38 Q1668.64 1485.92 1672.25 1485.92 Q1675.88 1485.92 1677.69 1482.38 Q1679.52 1478.82 1679.52 1471.71 Q1679.52 1464.58 1677.69 1461.04 Q1675.88 1457.48 1672.25 1457.48 M1672.25 1453.77 Q1678.06 1453.77 1681.11 1458.38 Q1684.19 1462.96 1684.19 1471.71 Q1684.19 1480.44 1681.11 1485.04 Q1678.06 1489.63 1672.25 1489.63 Q1666.44 1489.63 1663.36 1485.04 Q1660.3 1480.44 1660.3 1471.71 Q1660.3 1462.96 1663.36 1458.38 Q1666.44 1453.77 1672.25 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1694.22 1445.99 Q1691.66 1445.99 1690.15 1447.74 Q1688.67 1449.49 1688.67 1452.54 Q1688.67 1455.57 1690.15 1457.33 Q1691.66 1459.08 1694.22 1459.08 Q1696.78 1459.08 1698.26 1457.33 Q1699.77 1455.57 1699.77 1452.54 Q1699.77 1449.49 1698.26 1447.74 Q1696.78 1445.99 1694.22 1445.99 M1701.76 1434.09 L1701.76 1437.55 Q1700.33 1436.87 1698.86 1436.51 Q1697.41 1436.16 1695.99 1436.16 Q1692.22 1436.16 1690.23 1438.69 Q1688.26 1441.23 1687.97 1446.37 Q1689.08 1444.73 1690.76 1443.87 Q1692.43 1442.98 1694.44 1442.98 Q1698.67 1442.98 1701.12 1445.56 Q1703.58 1448.12 1703.58 1452.54 Q1703.58 1456.86 1701.03 1459.48 Q1698.47 1462.09 1694.22 1462.09 Q1689.35 1462.09 1686.77 1458.37 Q1684.19 1454.62 1684.19 1447.53 Q1684.19 1440.88 1687.35 1436.93 Q1690.51 1432.96 1695.83 1432.96 Q1697.26 1432.96 1698.71 1433.24 Q1700.18 1433.52 1701.76 1434.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2072.1 1485.02 L2079.74 1485.02 L2079.74 1458.66 L2071.43 1460.32 L2071.43 1456.06 L2079.7 1454.4 L2084.37 1454.4 L2084.37 1485.02 L2092.01 1485.02 L2092.01 1488.96 L2072.1 1488.96 L2072.1 1485.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2101.45 1483.08 L2106.34 1483.08 L2106.34 1488.96 L2101.45 1488.96 L2101.45 1483.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2116.57 1454.4 L2134.93 1454.4 L2134.93 1458.33 L2120.85 1458.33 L2120.85 1466.8 Q2121.87 1466.46 2122.89 1466.29 Q2123.91 1466.11 2124.93 1466.11 Q2130.71 1466.11 2134.09 1469.28 Q2137.47 1472.45 2137.47 1477.87 Q2137.47 1483.45 2134 1486.55 Q2130.53 1489.63 2124.21 1489.63 Q2122.03 1489.63 2119.76 1489.26 Q2117.52 1488.89 2115.11 1488.15 L2115.11 1483.45 Q2117.2 1484.58 2119.42 1485.14 Q2121.64 1485.69 2124.12 1485.69 Q2128.12 1485.69 2130.46 1483.59 Q2132.8 1481.48 2132.8 1477.87 Q2132.8 1474.26 2130.46 1472.15 Q2128.12 1470.04 2124.12 1470.04 Q2122.24 1470.04 2120.37 1470.46 Q2118.51 1470.88 2116.57 1471.76 L2116.57 1454.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2156.69 1457.48 Q2153.07 1457.48 2151.25 1461.04 Q2149.44 1464.58 2149.44 1471.71 Q2149.44 1478.82 2151.25 1482.38 Q2153.07 1485.92 2156.69 1485.92 Q2160.32 1485.92 2162.13 1482.38 Q2163.95 1478.82 2163.95 1471.71 Q2163.95 1464.58 2162.13 1461.04 Q2160.32 1457.48 2156.69 1457.48 M2156.69 1453.77 Q2162.5 1453.77 2165.55 1458.38 Q2168.63 1462.96 2168.63 1471.71 Q2168.63 1480.44 2165.55 1485.04 Q2162.5 1489.63 2156.69 1489.63 Q2150.88 1489.63 2147.8 1485.04 Q2144.74 1480.44 2144.74 1471.71 Q2144.74 1462.96 2147.8 1458.38 Q2150.88 1453.77 2156.69 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2205.02 1463.49 L2194.44 1474.12 L2205.02 1484.7 L2202.26 1487.5 L2191.64 1476.87 L2181.01 1487.5 L2178.28 1484.7 L2188.84 1474.12 L2178.28 1463.49 L2181.01 1460.69 L2191.64 1471.32 L2202.26 1460.69 L2205.02 1463.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2217.38 1485.02 L2225.02 1485.02 L2225.02 1458.66 L2216.71 1460.32 L2216.71 1456.06 L2224.97 1454.4 L2229.65 1454.4 L2229.65 1485.02 L2237.29 1485.02 L2237.29 1488.96 L2217.38 1488.96 L2217.38 1485.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2256.73 1457.48 Q2253.12 1457.48 2251.29 1461.04 Q2249.49 1464.58 2249.49 1471.71 Q2249.49 1478.82 2251.29 1482.38 Q2253.12 1485.92 2256.73 1485.92 Q2260.37 1485.92 2262.17 1482.38 Q2264 1478.82 2264 1471.71 Q2264 1464.58 2262.17 1461.04 Q2260.37 1457.48 2256.73 1457.48 M2256.73 1453.77 Q2262.54 1453.77 2265.6 1458.38 Q2268.68 1462.96 2268.68 1471.71 Q2268.68 1480.44 2265.6 1485.04 Q2262.54 1489.63 2256.73 1489.63 Q2250.92 1489.63 2247.84 1485.04 Q2244.79 1480.44 2244.79 1471.71 Q2244.79 1462.96 2247.84 1458.38 Q2250.92 1453.77 2256.73 1453.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2278.7 1445.99 Q2276.14 1445.99 2274.64 1447.74 Q2273.15 1449.49 2273.15 1452.54 Q2273.15 1455.57 2274.64 1457.33 Q2276.14 1459.08 2278.7 1459.08 Q2281.26 1459.08 2282.74 1457.33 Q2284.25 1455.57 2284.25 1452.54 Q2284.25 1449.49 2282.74 1447.74 Q2281.26 1445.99 2278.7 1445.99 M2286.24 1434.09 L2286.24 1437.55 Q2284.81 1436.87 2283.35 1436.51 Q2281.9 1436.16 2280.47 1436.16 Q2276.71 1436.16 2274.71 1438.69 Q2272.74 1441.23 2272.46 1446.37 Q2273.57 1444.73 2275.24 1443.87 Q2276.91 1442.98 2278.93 1442.98 Q2283.16 1442.98 2285.6 1445.56 Q2288.07 1448.12 2288.07 1452.54 Q2288.07 1456.86 2285.51 1459.48 Q2282.95 1462.09 2278.7 1462.09 Q2273.83 1462.09 2271.25 1458.37 Q2268.68 1454.62 2268.68 1447.53 Q2268.68 1440.88 2271.84 1436.93 Q2275 1432.96 2280.32 1432.96 Q2281.75 1432.96 2283.2 1433.24 Q2284.66 1433.52 2286.24 1434.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1239.01 1526.67 L1269.06 1526.67 L1269.06 1532.08 L1245.44 1532.08 L1245.44 1546.14 L1268.07 1546.14 L1268.07 1551.56 L1245.44 1551.56 L1245.44 1568.77 L1269.63 1568.77 L1269.63 1574.19 L1239.01 1574.19 L1239.01 1526.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1309.58 1552.67 L1309.58 1574.19 L1303.72 1574.19 L1303.72 1552.86 Q1303.72 1547.8 1301.75 1545.29 Q1299.77 1542.77 1295.83 1542.77 Q1291.08 1542.77 1288.35 1545.79 Q1285.61 1548.82 1285.61 1554.04 L1285.61 1574.19 L1279.72 1574.19 L1279.72 1538.54 L1285.61 1538.54 L1285.61 1544.08 Q1287.71 1540.86 1290.54 1539.27 Q1293.41 1537.68 1297.13 1537.68 Q1303.27 1537.68 1306.43 1541.5 Q1309.58 1545.29 1309.58 1552.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1327.05 1528.42 L1327.05 1538.54 L1339.11 1538.54 L1339.11 1543.09 L1327.05 1543.09 L1327.05 1562.44 Q1327.05 1566.8 1328.23 1568.04 Q1329.44 1569.28 1333.1 1569.28 L1339.11 1569.28 L1339.11 1574.19 L1333.1 1574.19 Q1326.32 1574.19 1323.74 1571.67 Q1321.16 1569.12 1321.16 1562.44 L1321.16 1543.09 L1316.87 1543.09 L1316.87 1538.54 L1321.16 1538.54 L1321.16 1528.42 L1327.05 1528.42 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1367.47 1544.01 Q1366.49 1543.44 1365.31 1543.18 Q1364.16 1542.9 1362.76 1542.9 Q1357.8 1542.9 1355.12 1546.14 Q1352.48 1549.36 1352.48 1555.41 L1352.48 1574.19 L1346.59 1574.19 L1346.59 1538.54 L1352.48 1538.54 L1352.48 1544.08 Q1354.33 1540.83 1357.29 1539.27 Q1360.25 1537.68 1364.48 1537.68 Q1365.09 1537.68 1365.82 1537.77 Q1366.55 1537.84 1367.44 1538 L1367.47 1544.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1386 1542.64 Q1381.29 1542.64 1378.55 1546.34 Q1375.81 1550 1375.81 1556.39 Q1375.81 1562.79 1378.52 1566.48 Q1381.25 1570.14 1386 1570.14 Q1390.68 1570.14 1393.41 1566.45 Q1396.15 1562.76 1396.15 1556.39 Q1396.15 1550.06 1393.41 1546.37 Q1390.68 1542.64 1386 1542.64 M1386 1537.68 Q1393.64 1537.68 1398 1542.64 Q1402.36 1547.61 1402.36 1556.39 Q1402.36 1565.15 1398 1570.14 Q1393.64 1575.11 1386 1575.11 Q1378.33 1575.11 1373.97 1570.14 Q1369.64 1565.15 1369.64 1556.39 Q1369.64 1547.61 1373.97 1542.64 Q1378.33 1537.68 1386 1537.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1417.73 1568.84 L1417.73 1587.74 L1411.84 1587.74 L1411.84 1538.54 L1417.73 1538.54 L1417.73 1543.95 Q1419.58 1540.77 1422.38 1539.24 Q1425.21 1537.68 1429.12 1537.68 Q1435.62 1537.68 1439.66 1542.83 Q1443.73 1547.99 1443.73 1556.39 Q1443.73 1564.8 1439.66 1569.95 Q1435.62 1575.11 1429.12 1575.11 Q1425.21 1575.11 1422.38 1573.58 Q1419.58 1572.02 1417.73 1568.84 M1437.65 1556.39 Q1437.65 1549.93 1434.98 1546.27 Q1432.34 1542.58 1427.69 1542.58 Q1423.05 1542.58 1420.37 1546.27 Q1417.73 1549.93 1417.73 1556.39 Q1417.73 1562.85 1420.37 1566.55 Q1423.05 1570.21 1427.69 1570.21 Q1432.34 1570.21 1434.98 1566.55 Q1437.65 1562.85 1437.65 1556.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1468.27 1577.5 Q1465.79 1583.86 1463.44 1585.8 Q1461.08 1587.74 1457.13 1587.74 L1452.45 1587.74 L1452.45 1582.84 L1455.89 1582.84 Q1458.31 1582.84 1459.65 1581.7 Q1460.98 1580.55 1462.61 1576.29 L1463.66 1573.61 L1449.24 1538.54 L1455.45 1538.54 L1466.59 1566.42 L1477.73 1538.54 L1483.93 1538.54 L1468.27 1577.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="370.19,1296.49 2352.76,1296.49 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="370.19,1041.21 2352.76,1041.21 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="370.19,785.932 2352.76,785.932 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="370.19,530.653 2352.76,530.653 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="370.19,275.375 2352.76,275.375 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="370.19,1410.9 370.19,47.2441 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="370.19,1296.49 389.087,1296.49 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="370.19,1041.21 389.087,1041.21 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="370.19,785.932 389.087,785.932 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="370.19,530.653 389.087,530.653 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="370.19,275.375 389.087,275.375 "/>
<path clip-path="url(#clip020)" d="M322.245 1282.29 Q318.634 1282.29 316.805 1285.85 Q315 1289.39 315 1296.52 Q315 1303.63 316.805 1307.19 Q318.634 1310.74 322.245 1310.74 Q325.879 1310.74 327.685 1307.19 Q329.514 1303.63 329.514 1296.52 Q329.514 1289.39 327.685 1285.85 Q325.879 1282.29 322.245 1282.29 M322.245 1278.58 Q328.055 1278.58 331.111 1283.19 Q334.19 1287.77 334.19 1296.52 Q334.19 1305.25 331.111 1309.86 Q328.055 1314.44 322.245 1314.44 Q316.435 1314.44 313.356 1309.86 Q310.301 1305.25 310.301 1296.52 Q310.301 1287.77 313.356 1283.19 Q316.435 1278.58 322.245 1278.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M130.51 1046.3 Q133.867 1047.02 135.742 1049.29 Q137.64 1051.56 137.64 1054.89 Q137.64 1060.01 134.121 1062.81 Q130.603 1065.61 124.121 1065.61 Q121.945 1065.61 119.63 1065.17 Q117.339 1064.75 114.885 1063.9 L114.885 1059.38 Q116.83 1060.52 119.144 1061.1 Q121.459 1061.67 123.982 1061.67 Q128.38 1061.67 130.672 1059.94 Q132.987 1058.2 132.987 1054.89 Q132.987 1051.84 130.834 1050.12 Q128.705 1048.39 124.885 1048.39 L120.857 1048.39 L120.857 1044.54 L125.07 1044.54 Q128.519 1044.54 130.348 1043.18 Q132.177 1041.79 132.177 1039.2 Q132.177 1036.54 130.279 1035.12 Q128.404 1033.69 124.885 1033.69 Q122.964 1033.69 120.765 1034.1 Q118.566 1034.52 115.927 1035.4 L115.927 1031.23 Q118.589 1030.49 120.904 1030.12 Q123.242 1029.75 125.302 1029.75 Q130.626 1029.75 133.728 1032.18 Q136.829 1034.59 136.829 1038.71 Q136.829 1041.58 135.186 1043.57 Q133.542 1045.54 130.51 1046.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M146.505 1059.06 L151.39 1059.06 L151.39 1064.94 L146.505 1064.94 L146.505 1059.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M171.575 1033.46 Q167.964 1033.46 166.135 1037.02 Q164.329 1040.56 164.329 1047.69 Q164.329 1054.8 166.135 1058.36 Q167.964 1061.91 171.575 1061.91 Q175.209 1061.91 177.014 1058.36 Q178.843 1054.8 178.843 1047.69 Q178.843 1040.56 177.014 1037.02 Q175.209 1033.46 171.575 1033.46 M171.575 1029.75 Q177.385 1029.75 180.44 1034.36 Q183.519 1038.94 183.519 1047.69 Q183.519 1056.42 180.44 1061.03 Q177.385 1065.61 171.575 1065.61 Q165.765 1065.61 162.686 1061.03 Q159.63 1056.42 159.63 1047.69 Q159.63 1038.94 162.686 1034.36 Q165.765 1029.75 171.575 1029.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M201.737 1033.46 Q198.125 1033.46 196.297 1037.02 Q194.491 1040.56 194.491 1047.69 Q194.491 1054.8 196.297 1058.36 Q198.125 1061.91 201.737 1061.91 Q205.371 1061.91 207.176 1058.36 Q209.005 1054.8 209.005 1047.69 Q209.005 1040.56 207.176 1037.02 Q205.371 1033.46 201.737 1033.46 M201.737 1029.75 Q207.547 1029.75 210.602 1034.36 Q213.681 1038.94 213.681 1047.69 Q213.681 1056.42 210.602 1061.03 Q207.547 1065.61 201.737 1065.61 Q195.926 1065.61 192.848 1061.03 Q189.792 1056.42 189.792 1047.69 Q189.792 1038.94 192.848 1034.36 Q195.926 1029.75 201.737 1029.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M250.07 1039.47 L239.491 1050.1 L250.07 1060.68 L247.315 1063.48 L236.69 1052.85 L226.065 1063.48 L223.334 1060.68 L233.889 1050.1 L223.334 1039.47 L226.065 1036.67 L236.69 1047.3 L247.315 1036.67 L250.07 1039.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M262.431 1061 L270.07 1061 L270.07 1034.64 L261.759 1036.3 L261.759 1032.04 L270.023 1030.38 L274.699 1030.38 L274.699 1061 L282.338 1061 L282.338 1064.94 L262.431 1064.94 L262.431 1061 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M301.782 1033.46 Q298.171 1033.46 296.343 1037.02 Q294.537 1040.56 294.537 1047.69 Q294.537 1054.8 296.343 1058.36 Q298.171 1061.91 301.782 1061.91 Q305.417 1061.91 307.222 1058.36 Q309.051 1054.8 309.051 1047.69 Q309.051 1040.56 307.222 1037.02 Q305.417 1033.46 301.782 1033.46 M301.782 1029.75 Q307.592 1029.75 310.648 1034.36 Q313.727 1038.94 313.727 1047.69 Q313.727 1056.42 310.648 1061.03 Q307.592 1065.61 301.782 1065.61 Q295.972 1065.61 292.893 1061.03 Q289.838 1056.42 289.838 1047.69 Q289.838 1038.94 292.893 1034.36 Q295.972 1029.75 301.782 1029.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M326.403 1012.76 L316.811 1027.75 L326.403 1027.75 L326.403 1012.76 M325.406 1009.45 L330.183 1009.45 L330.183 1027.75 L334.19 1027.75 L334.19 1030.91 L330.183 1030.91 L330.183 1037.53 L326.403 1037.53 L326.403 1030.91 L313.727 1030.91 L313.727 1027.24 L325.406 1009.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M126.922 790.516 Q123.774 790.516 121.922 792.669 Q120.093 794.821 120.093 798.571 Q120.093 802.298 121.922 804.474 Q123.774 806.627 126.922 806.627 Q130.07 806.627 131.899 804.474 Q133.751 802.298 133.751 798.571 Q133.751 794.821 131.899 792.669 Q130.07 790.516 126.922 790.516 M136.204 775.863 L136.204 780.122 Q134.445 779.289 132.64 778.849 Q130.857 778.409 129.098 778.409 Q124.468 778.409 122.015 781.534 Q119.584 784.659 119.237 790.979 Q120.603 788.965 122.663 787.9 Q124.723 786.812 127.2 786.812 Q132.408 786.812 135.417 789.983 Q138.45 793.132 138.45 798.571 Q138.45 803.895 135.302 807.113 Q132.154 810.331 126.922 810.331 Q120.927 810.331 117.756 805.747 Q114.584 801.141 114.584 792.414 Q114.584 784.22 118.473 779.358 Q122.362 774.474 128.913 774.474 Q130.672 774.474 132.455 774.821 Q134.26 775.169 136.204 775.863 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M146.505 803.78 L151.39 803.78 L151.39 809.659 L146.505 809.659 L146.505 803.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M171.575 778.178 Q167.964 778.178 166.135 781.743 Q164.329 785.284 164.329 792.414 Q164.329 799.52 166.135 803.085 Q167.964 806.627 171.575 806.627 Q175.209 806.627 177.014 803.085 Q178.843 799.52 178.843 792.414 Q178.843 785.284 177.014 781.743 Q175.209 778.178 171.575 778.178 M171.575 774.474 Q177.385 774.474 180.44 779.081 Q183.519 783.664 183.519 792.414 Q183.519 801.141 180.44 805.747 Q177.385 810.331 171.575 810.331 Q165.765 810.331 162.686 805.747 Q159.63 801.141 159.63 792.414 Q159.63 783.664 162.686 779.081 Q165.765 774.474 171.575 774.474 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M201.737 778.178 Q198.125 778.178 196.297 781.743 Q194.491 785.284 194.491 792.414 Q194.491 799.52 196.297 803.085 Q198.125 806.627 201.737 806.627 Q205.371 806.627 207.176 803.085 Q209.005 799.52 209.005 792.414 Q209.005 785.284 207.176 781.743 Q205.371 778.178 201.737 778.178 M201.737 774.474 Q207.547 774.474 210.602 779.081 Q213.681 783.664 213.681 792.414 Q213.681 801.141 210.602 805.747 Q207.547 810.331 201.737 810.331 Q195.926 810.331 192.848 805.747 Q189.792 801.141 189.792 792.414 Q189.792 783.664 192.848 779.081 Q195.926 774.474 201.737 774.474 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M250.07 784.196 L239.491 794.821 L250.07 805.4 L247.315 808.201 L236.69 797.576 L226.065 808.201 L223.334 805.4 L233.889 794.821 L223.334 784.196 L226.065 781.396 L236.69 792.02 L247.315 781.396 L250.07 784.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M262.431 805.724 L270.07 805.724 L270.07 779.358 L261.759 781.025 L261.759 776.766 L270.023 775.099 L274.699 775.099 L274.699 805.724 L282.338 805.724 L282.338 809.659 L262.431 809.659 L262.431 805.724 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M301.782 778.178 Q298.171 778.178 296.343 781.743 Q294.537 785.284 294.537 792.414 Q294.537 799.52 296.343 803.085 Q298.171 806.627 301.782 806.627 Q305.417 806.627 307.222 803.085 Q309.051 799.52 309.051 792.414 Q309.051 785.284 307.222 781.743 Q305.417 778.178 301.782 778.178 M301.782 774.474 Q307.592 774.474 310.648 779.081 Q313.727 783.664 313.727 792.414 Q313.727 801.141 310.648 805.747 Q307.592 810.331 301.782 810.331 Q295.972 810.331 292.893 805.747 Q289.838 801.141 289.838 792.414 Q289.838 783.664 292.893 779.081 Q295.972 774.474 301.782 774.474 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M326.403 757.479 L316.811 772.469 L326.403 772.469 L326.403 757.479 M325.406 754.169 L330.183 754.169 L330.183 772.469 L334.19 772.469 L334.19 775.629 L330.183 775.629 L330.183 782.249 L326.403 782.249 L326.403 775.629 L313.727 775.629 L313.727 771.961 L325.406 754.169 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M116.482 553.663 L116.482 549.404 Q118.242 550.237 120.047 550.677 Q121.853 551.117 123.589 551.117 Q128.218 551.117 130.649 548.015 Q133.103 544.89 133.45 538.548 Q132.107 540.538 130.047 541.603 Q127.987 542.668 125.487 542.668 Q120.302 542.668 117.269 539.543 Q114.26 536.395 114.26 530.955 Q114.26 525.631 117.408 522.413 Q120.556 519.196 125.788 519.196 Q131.783 519.196 134.931 523.802 Q138.103 528.386 138.103 537.135 Q138.103 545.307 134.214 550.191 Q130.348 555.052 123.797 555.052 Q122.038 555.052 120.232 554.705 Q118.427 554.358 116.482 553.663 M125.788 539.01 Q128.936 539.01 130.765 536.858 Q132.617 534.705 132.617 530.955 Q132.617 527.228 130.765 525.075 Q128.936 522.899 125.788 522.899 Q122.64 522.899 120.788 525.075 Q118.959 527.228 118.959 530.955 Q118.959 534.705 120.788 536.858 Q122.64 539.01 125.788 539.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M146.505 548.501 L151.39 548.501 L151.39 554.381 L146.505 554.381 L146.505 548.501 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M171.575 522.899 Q167.964 522.899 166.135 526.464 Q164.329 530.006 164.329 537.135 Q164.329 544.242 166.135 547.807 Q167.964 551.348 171.575 551.348 Q175.209 551.348 177.014 547.807 Q178.843 544.242 178.843 537.135 Q178.843 530.006 177.014 526.464 Q175.209 522.899 171.575 522.899 M171.575 519.196 Q177.385 519.196 180.44 523.802 Q183.519 528.386 183.519 537.135 Q183.519 545.862 180.44 550.469 Q177.385 555.052 171.575 555.052 Q165.765 555.052 162.686 550.469 Q159.63 545.862 159.63 537.135 Q159.63 528.386 162.686 523.802 Q165.765 519.196 171.575 519.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M201.737 522.899 Q198.125 522.899 196.297 526.464 Q194.491 530.006 194.491 537.135 Q194.491 544.242 196.297 547.807 Q198.125 551.348 201.737 551.348 Q205.371 551.348 207.176 547.807 Q209.005 544.242 209.005 537.135 Q209.005 530.006 207.176 526.464 Q205.371 522.899 201.737 522.899 M201.737 519.196 Q207.547 519.196 210.602 523.802 Q213.681 528.386 213.681 537.135 Q213.681 545.862 210.602 550.469 Q207.547 555.052 201.737 555.052 Q195.926 555.052 192.848 550.469 Q189.792 545.862 189.792 537.135 Q189.792 528.386 192.848 523.802 Q195.926 519.196 201.737 519.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M250.07 528.918 L239.491 539.543 L250.07 550.122 L247.315 552.922 L236.69 542.297 L226.065 552.922 L223.334 550.122 L233.889 539.543 L223.334 528.918 L226.065 526.117 L236.69 536.742 L247.315 526.117 L250.07 528.918 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M262.431 550.446 L270.07 550.446 L270.07 524.08 L261.759 525.747 L261.759 521.487 L270.023 519.821 L274.699 519.821 L274.699 550.446 L282.338 550.446 L282.338 554.381 L262.431 554.381 L262.431 550.446 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M301.782 522.899 Q298.171 522.899 296.343 526.464 Q294.537 530.006 294.537 537.135 Q294.537 544.242 296.343 547.807 Q298.171 551.348 301.782 551.348 Q305.417 551.348 307.222 547.807 Q309.051 544.242 309.051 537.135 Q309.051 530.006 307.222 526.464 Q305.417 522.899 301.782 522.899 M301.782 519.196 Q307.592 519.196 310.648 523.802 Q313.727 528.386 313.727 537.135 Q313.727 545.862 310.648 550.469 Q307.592 555.052 301.782 555.052 Q295.972 555.052 292.893 550.469 Q289.838 545.862 289.838 537.135 Q289.838 528.386 292.893 523.802 Q295.972 519.196 301.782 519.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M326.403 502.201 L316.811 517.19 L326.403 517.19 L326.403 502.201 M325.406 498.89 L330.183 498.89 L330.183 517.19 L334.19 517.19 L334.19 520.35 L330.183 520.35 L330.183 526.97 L326.403 526.97 L326.403 520.35 L313.727 520.35 L313.727 516.683 L325.406 498.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M119.448 295.167 L127.087 295.167 L127.087 268.802 L118.777 270.468 L118.777 266.209 L127.041 264.542 L131.717 264.542 L131.717 295.167 L139.356 295.167 L139.356 299.102 L119.448 299.102 L119.448 295.167 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M148.8 293.223 L153.684 293.223 L153.684 299.102 L148.8 299.102 L148.8 293.223 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M167.897 295.167 L184.216 295.167 L184.216 299.102 L162.272 299.102 L162.272 295.167 Q164.934 292.412 169.517 287.783 Q174.124 283.13 175.304 281.788 Q177.55 279.264 178.429 277.528 Q179.332 275.769 179.332 274.079 Q179.332 271.325 177.388 269.589 Q175.466 267.852 172.365 267.852 Q170.166 267.852 167.712 268.616 Q165.281 269.38 162.504 270.931 L162.504 266.209 Q165.328 265.075 167.781 264.496 Q170.235 263.917 172.272 263.917 Q177.642 263.917 180.837 266.602 Q184.031 269.288 184.031 273.778 Q184.031 275.908 183.221 277.829 Q182.434 279.727 180.328 282.32 Q179.749 282.991 176.647 286.209 Q173.545 289.403 167.897 295.167 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M204.031 267.621 Q200.42 267.621 198.591 271.186 Q196.786 274.727 196.786 281.857 Q196.786 288.963 198.591 292.528 Q200.42 296.07 204.031 296.07 Q207.665 296.07 209.471 292.528 Q211.3 288.963 211.3 281.857 Q211.3 274.727 209.471 271.186 Q207.665 267.621 204.031 267.621 M204.031 263.917 Q209.841 263.917 212.897 268.524 Q215.975 273.107 215.975 281.857 Q215.975 290.584 212.897 295.19 Q209.841 299.774 204.031 299.774 Q198.221 299.774 195.142 295.19 Q192.087 290.584 192.087 281.857 Q192.087 273.107 195.142 268.524 Q198.221 263.917 204.031 263.917 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M252.364 273.639 L241.786 284.264 L252.364 294.843 L249.61 297.644 L238.985 287.019 L228.36 297.644 L225.628 294.843 L236.184 284.264 L225.628 273.639 L228.36 270.839 L238.985 281.463 L249.61 270.839 L252.364 273.639 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M264.725 295.167 L272.364 295.167 L272.364 268.802 L264.054 270.468 L264.054 266.209 L272.318 264.542 L276.994 264.542 L276.994 295.167 L284.633 295.167 L284.633 299.102 L264.725 299.102 L264.725 295.167 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M304.077 267.621 Q300.466 267.621 298.637 271.186 Q296.832 274.727 296.832 281.857 Q296.832 288.963 298.637 292.528 Q300.466 296.07 304.077 296.07 Q307.711 296.07 309.517 292.528 Q311.345 288.963 311.345 281.857 Q311.345 274.727 309.517 271.186 Q307.711 267.621 304.077 267.621 M304.077 263.917 Q309.887 263.917 312.943 268.524 Q316.021 273.107 316.021 281.857 Q316.021 290.584 312.943 295.19 Q309.887 299.774 304.077 299.774 Q298.267 299.774 295.188 295.19 Q292.132 290.584 292.132 281.857 Q292.132 273.107 295.188 268.524 Q298.267 263.917 304.077 263.917 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M317.206 243.612 L332.121 243.612 L332.121 246.809 L320.686 246.809 L320.686 253.693 Q321.513 253.411 322.341 253.279 Q323.168 253.129 323.996 253.129 Q328.698 253.129 331.444 255.705 Q334.19 258.282 334.19 262.683 Q334.19 267.216 331.368 269.736 Q328.547 272.237 323.413 272.237 Q321.645 272.237 319.802 271.936 Q317.977 271.635 316.021 271.034 L316.021 267.216 Q317.714 268.137 319.519 268.589 Q321.325 269.04 323.337 269.04 Q326.591 269.04 328.491 267.328 Q330.39 265.617 330.39 262.683 Q330.39 259.749 328.491 258.037 Q326.591 256.326 323.337 256.326 Q321.814 256.326 320.291 256.664 Q318.786 257.003 317.206 257.718 L317.206 243.612 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M64.0042 798.441 L16.4842 816.583 L16.4842 809.867 L56.4926 794.812 L16.4842 779.725 L16.4842 773.041 L64.0042 791.152 L64.0042 798.441 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M46.0847 755.218 Q46.0847 762.315 47.7079 765.053 Q49.3312 767.79 53.2461 767.79 Q56.3653 767.79 58.2114 765.753 Q60.0256 763.684 60.0256 760.151 Q60.0256 755.281 56.5881 752.353 Q53.1188 749.393 47.3897 749.393 L46.0847 749.393 L46.0847 755.218 M43.6657 743.536 L64.0042 743.536 L64.0042 749.393 L58.5933 749.393 Q61.8398 751.398 63.3994 754.39 Q64.9272 757.382 64.9272 761.711 Q64.9272 767.185 61.8716 770.432 Q58.7843 773.646 53.6281 773.646 Q47.6125 773.646 44.5569 769.636 Q41.5014 765.594 41.5014 757.605 L41.5014 749.393 L40.9285 749.393 Q36.8862 749.393 34.6901 752.066 Q32.4621 754.708 32.4621 759.514 Q32.4621 762.57 33.1941 765.466 Q33.9262 768.363 35.3903 771.036 L29.9795 771.036 Q28.7381 767.822 28.1334 764.798 Q27.4968 761.774 27.4968 758.91 Q27.4968 751.175 31.5072 747.356 Q35.5176 743.536 43.6657 743.536 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M14.479 731.473 L14.479 725.617 L64.0042 725.617 L64.0042 731.473 L14.479 731.473 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M49.9359 713.968 L28.3562 713.968 L28.3562 708.111 L49.7131 708.111 Q54.7739 708.111 57.3202 706.138 Q59.8346 704.165 59.8346 700.218 Q59.8346 695.475 56.8109 692.738 Q53.7872 689.969 48.5673 689.969 L28.3562 689.969 L28.3562 684.113 L64.0042 684.113 L64.0042 689.969 L58.5296 689.969 Q61.7762 692.102 63.3676 694.934 Q64.9272 697.735 64.9272 701.459 Q64.9272 707.602 61.1078 710.785 Q57.2883 713.968 49.9359 713.968 M27.4968 699.231 L27.4968 699.231 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M44.7161 641.558 L47.5806 641.558 L47.5806 668.485 Q53.6281 668.103 56.8109 664.856 Q59.9619 661.578 59.9619 655.753 Q59.9619 652.38 59.1344 649.228 Q58.3069 646.046 56.6518 642.926 L62.1899 642.926 Q63.5267 646.077 64.227 649.388 Q64.9272 652.698 64.9272 656.103 Q64.9272 664.634 59.9619 669.631 Q54.9967 674.596 46.5303 674.596 Q37.7774 674.596 32.6531 669.885 Q27.4968 665.143 27.4968 657.122 Q27.4968 649.929 32.1438 645.759 Q36.7589 641.558 44.7161 641.558 M42.9973 647.414 Q38.1912 647.478 35.3266 650.12 Q32.4621 652.73 32.4621 657.058 Q32.4621 661.96 35.2312 664.92 Q38.0002 667.848 43.0292 668.294 L42.9973 647.414 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip022)" style="stroke:#ff0000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="426.3,744.232 445.192,678.853 464.085,651.831 482.977,628.312 501.869,612.174 520.762,596.036 539.654,580.315 558.547,568.533 577.439,556.752 596.331,544.97 615.224,533.188 634.116,522.818 653.008,513.822 671.901,504.826 690.793,495.83 709.686,486.834 728.578,477.838 747.47,468.842 766.363,461.08 785.255,454.024 804.148,446.967 823.04,439.911 841.932,432.854 860.825,425.798 879.717,418.741 898.609,411.685 917.502,404.628 936.394,397.572 955.287,391.246 974.179,385.621 993.071,379.997 1011.96,374.372 1030.86,368.748 1049.75,363.123 1068.64,357.499 1087.53,351.874 1106.43,346.25 1125.32,340.625 1144.21,335.001 1163.1,329.376 1182,323.752 1200.89,318.127 1219.78,312.503 1238.67,307.57 1257.56,303.049 1276.46,298.529 1295.35,294.009 1314.24,289.489 1333.13,284.968 1352.03,280.448 1370.92,275.928 1389.81,271.408 1408.7,266.887 1427.6,262.367 1446.49,257.847 1465.38,253.327 1484.27,248.806 1503.17,244.286 1522.06,239.766 1540.95,235.246 1559.84,230.725 1578.74,226.205 1597.63,221.685 1616.52,217.165 1635.41,212.644 1654.3,208.631 1673.2,204.991 1692.09,201.352 1710.98,197.713 1729.87,194.073 1748.77,190.434 1767.66,186.794 1786.55,183.155 1805.44,179.516 1824.34,175.876 1843.23,172.237 1862.12,168.598 1881.01,164.958 1899.91,161.319 1918.8,157.679 1937.69,154.04 1956.58,150.401 1975.48,146.761 1994.37,143.122 2013.26,139.482 2032.15,135.843 2051.04,132.204 2069.94,128.564 2088.83,124.925 2107.72,121.285 2126.61,117.646 2145.51,114.007 2164.4,110.367 2183.29,106.728 2202.18,103.088 2221.08,99.449 2239.97,95.8096 2258.86,92.1702 2277.75,88.755 2296.65,85.838 "/>
<polyline clip-path="url(#clip022)" style="stroke:#ff0000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="426.3,744.232 445.192,810.336 464.085,838.342 482.977,859.899 501.869,878.107 520.762,893.84 539.654,907.995 558.547,921.174 577.439,933.533 596.331,944.811 615.224,955.632 634.116,966.021 653.008,975.71 671.901,985.109 690.793,994.213 709.686,1002.83 728.578,1011.24 747.47,1019.43 766.363,1027.26 785.255,1034.93 804.148,1042.43 823.04,1049.65 841.932,1056.72 860.825,1063.66 879.717,1070.4 898.609,1077 917.502,1083.47 936.394,1089.82 955.287,1096.01 974.179,1102.09 993.071,1108.07 1011.96,1113.94 1030.86,1119.7 1049.75,1125.36 1068.64,1130.93 1087.53,1136.41 1106.43,1141.8 1125.32,1147.11 1144.21,1152.34 1163.1,1157.49 1182,1162.56 1200.89,1167.55 1219.78,1172.48 1238.67,1177.34 1257.56,1182.14 1276.46,1186.87 1295.35,1191.53 1314.24,1196.14 1333.13,1200.69 1352.03,1205.18 1370.92,1209.61 1389.81,1213.99 1408.7,1218.31 1427.6,1222.58 1446.49,1226.8 1465.38,1230.97 1484.27,1235.09 1503.17,1239.16 1522.06,1243.19 1540.95,1247.16 1559.84,1251.09 1578.74,1254.98 1597.63,1258.82 1616.52,1262.62 1635.41,1266.37 1654.3,1270.08 1673.2,1273.75 1692.09,1277.37 1710.98,1280.96 1729.87,1284.5 1748.77,1288.01 1767.66,1291.47 1786.55,1294.89 1805.44,1298.28 1824.34,1301.62 1843.23,1304.93 1862.12,1308.19 1881.01,1311.42 1899.91,1314.61 1918.8,1317.76 1937.69,1320.87 1956.58,1323.94 1975.48,1326.97 1994.37,1329.96 2013.26,1332.91 2032.15,1335.83 2051.04,1338.7 2069.94,1341.54 2088.83,1344.33 2107.72,1347.09 2126.61,1349.8 2145.51,1352.47 2164.4,1355.1 2183.29,1357.69 2202.18,1360.23 2221.08,1362.73 2239.97,1365.19 2258.86,1367.61 2277.75,1369.98 2296.65,1372.3 "/>
<polyline clip-path="url(#clip022)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="426.3,1122.99 445.192,1105.44 464.085,1098.22 482.977,1092.64 501.869,1087.95 520.762,1083.8 539.654,1080.06 558.547,1076.64 577.439,1073.47 596.331,1070.48 615.224,1067.63 634.116,1064.95 653.008,1062.39 671.901,1059.9 690.793,1057.56 709.686,1055.25 728.578,1053.07 747.47,1050.91 766.363,1048.84 785.255,1046.83 804.148,1044.84 823.04,1042.96 841.932,1041.08 860.825,1039.23 879.717,1037.48 898.609,1035.72 917.502,1033.98 936.394,1032.33 955.287,1030.69 974.179,1029.04 993.071,1027.46 1011.96,1025.92 1030.86,1024.38 1049.75,1022.84 1068.64,1021.36 1087.53,1019.91 1106.43,1018.47 1125.32,1017.03 1144.21,1015.6 1163.1,1014.24 1182,1012.89 1200.89,1011.54 1219.78,1010.18 1238.67,1008.84 1257.56,1007.57 1276.46,1006.3 1295.35,1005.03 1314.24,1003.76 1333.13,1002.49 1352.03,1001.26 1370.92,1000.07 1389.81,998.879 1408.7,997.689 1427.6,996.499 1446.49,995.31 1465.38,994.12 1484.27,993.004 1503.17,991.889 1522.06,990.773 1540.95,989.658 1559.84,988.543 1578.74,987.427 1597.63,986.312 1616.52,985.247 1635.41,984.202 1654.3,983.156 1673.2,982.111 1692.09,981.066 1710.98,980.02 1729.87,978.975 1748.77,977.93 1767.66,976.915 1786.55,975.936 1805.44,974.957 1824.34,973.977 1843.23,972.998 1862.12,972.019 1881.01,971.039 1899.91,970.06 1918.8,969.08 1937.69,968.106 1956.58,967.189 1975.48,966.273 1994.37,965.356 2013.26,964.439 2032.15,963.522 2051.04,962.605 2069.94,961.688 2088.83,960.771 2107.72,959.854 2126.61,958.937 2145.51,958.042 2164.4,957.184 2183.29,956.326 2202.18,955.468 2221.08,954.611 2239.97,953.753 2258.86,952.895 2277.75,952.037 2296.65,951.179 "/>
<polyline clip-path="url(#clip022)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="426.3,1122.99 445.192,1140.52 464.085,1147.79 482.977,1153.35 501.869,1158.04 520.762,1162.16 539.654,1165.88 558.547,1169.3 577.439,1172.48 596.331,1175.46 615.224,1178.27 634.116,1180.94 653.008,1183.49 671.901,1185.92 690.793,1188.27 709.686,1190.52 728.578,1192.7 747.47,1194.8 766.363,1196.84 785.255,1198.82 804.148,1200.75 823.04,1202.62 841.932,1204.44 860.825,1206.22 879.717,1207.95 898.609,1209.65 917.502,1211.3 936.394,1212.92 955.287,1214.51 974.179,1216.06 993.071,1217.58 1011.96,1219.08 1030.86,1220.54 1049.75,1221.98 1068.64,1223.39 1087.53,1224.77 1106.43,1226.13 1125.32,1227.47 1144.21,1228.78 1163.1,1230.07 1182,1231.34 1200.89,1232.59 1219.78,1233.81 1238.67,1235.02 1257.56,1236.21 1276.46,1237.38 1295.35,1238.53 1314.24,1239.66 1333.13,1240.78 1352.03,1241.88 1370.92,1242.96 1389.81,1244.03 1408.7,1245.08 1427.6,1246.11 1446.49,1247.13 1465.38,1248.13 1484.27,1249.12 1503.17,1250.09 1522.06,1251.05 1540.95,1251.99 1559.84,1252.92 1578.74,1253.83 1597.63,1254.74 1616.52,1255.62 1635.41,1256.5 1654.3,1257.36 1673.2,1258.21 1692.09,1259.04 1710.98,1259.86 1729.87,1260.67 1748.77,1261.47 1767.66,1262.25 1786.55,1263.02 1805.44,1263.78 1824.34,1264.53 1843.23,1265.26 1862.12,1265.99 1881.01,1266.7 1899.91,1267.4 1918.8,1268.09 1937.69,1268.76 1956.58,1269.43 1975.48,1270.08 1994.37,1270.72 2013.26,1271.35 2032.15,1271.97 2051.04,1272.58 2069.94,1273.18 2088.83,1273.77 2107.72,1274.35 2126.61,1274.91 2145.51,1275.47 2164.4,1276.01 2183.29,1276.55 2202.18,1277.07 2221.08,1277.59 2239.97,1278.09 2258.86,1278.59 2277.75,1279.07 2296.65,1279.55 "/>
<path clip-path="url(#clip022)" d="M426.3 744.232 L445.192 678.853 L464.085 651.831 L482.977 628.312 L501.869 612.174 L520.762 596.036 L539.654 580.315 L558.547 568.533 L577.439 556.752 L596.331 544.97 L615.224 533.188 L634.116 522.818 L653.008 513.822 L671.901 504.826 L690.793 495.83 L709.686 486.834 L728.578 477.838 L747.47 468.842 L766.363 461.08 L785.255 454.024 L804.148 446.967 L823.04 439.911 L841.932 432.854 L860.825 425.798 L879.717 418.741 L898.609 411.685 L917.502 404.628 L936.394 397.572 L955.287 391.246 L974.179 385.621 L993.071 379.997 L1011.96 374.372 L1030.86 368.748 L1049.75 363.123 L1068.64 357.499 L1087.53 351.874 L1106.43 346.25 L1125.32 340.625 L1144.21 335.001 L1163.1 329.376 L1182 323.752 L1200.89 318.127 L1219.78 312.503 L1238.67 307.57 L1257.56 303.049 L1276.46 298.529 L1295.35 294.009 L1314.24 289.489 L1333.13 284.968 L1352.03 280.448 L1370.92 275.928 L1389.81 271.408 L1408.7 266.887 L1427.6 262.367 L1446.49 257.847 L1465.38 253.327 L1484.27 248.806 L1503.17 244.286 L1522.06 239.766 L1540.95 235.246 L1559.84 230.725 L1578.74 226.205 L1597.63 221.685 L1616.52 217.165 L1635.41 212.644 L1654.3 208.631 L1673.2 204.991 L1692.09 201.352 L1710.98 197.713 L1729.87 194.073 L1748.77 190.434 L1767.66 186.794 L1786.55 183.155 L1805.44 179.516 L1824.34 175.876 L1843.23 172.237 L1862.12 168.598 L1881.01 164.958 L1899.91 161.319 L1918.8 157.679 L1937.69 154.04 L1956.58 150.401 L1975.48 146.761 L1994.37 143.122 L2013.26 139.482 L2032.15 135.843 L2051.04 132.204 L2069.94 128.564 L2088.83 124.925 L2107.72 121.285 L2126.61 117.646 L2145.51 114.007 L2164.4 110.367 L2183.29 106.728 L2202.18 103.088 L2221.08 99.449 L2239.97 95.8096 L2258.86 92.1702 L2277.75 88.755 L2296.65 85.838 L2296.65 1372.3 L2277.75 1369.98 L2258.86 1367.61 L2239.97 1365.19 L2221.08 1362.73 L2202.18 1360.23 L2183.29 1357.69 L2164.4 1355.1 L2145.51 1352.47 L2126.61 1349.8 L2107.72 1347.09 L2088.83 1344.33 L2069.94 1341.54 L2051.04 1338.7 L2032.15 1335.83 L2013.26 1332.91 L1994.37 1329.96 L1975.48 1326.97 L1956.58 1323.94 L1937.69 1320.87 L1918.8 1317.76 L1899.91 1314.61 L1881.01 1311.42 L1862.12 1308.19 L1843.23 1304.93 L1824.34 1301.62 L1805.44 1298.28 L1786.55 1294.89 L1767.66 1291.47 L1748.77 1288.01 L1729.87 1284.5 L1710.98 1280.96 L1692.09 1277.37 L1673.2 1273.75 L1654.3 1270.08 L1635.41 1266.37 L1616.52 1262.62 L1597.63 1258.82 L1578.74 1254.98 L1559.84 1251.09 L1540.95 1247.16 L1522.06 1243.19 L1503.17 1239.16 L1484.27 1235.09 L1465.38 1230.97 L1446.49 1226.8 L1427.6 1222.58 L1408.7 1218.31 L1389.81 1213.99 L1370.92 1209.61 L1352.03 1205.18 L1333.13 1200.69 L1314.24 1196.14 L1295.35 1191.53 L1276.46 1186.87 L1257.56 1182.14 L1238.67 1177.34 L1219.78 1172.48 L1200.89 1167.55 L1182 1162.56 L1163.1 1157.49 L1144.21 1152.34 L1125.32 1147.11 L1106.43 1141.8 L1087.53 1136.41 L1068.64 1130.93 L1049.75 1125.36 L1030.86 1119.7 L1011.96 1113.94 L993.071 1108.07 L974.179 1102.09 L955.287 1096.01 L936.394 1089.82 L917.502 1083.47 L898.609 1077 L879.717 1070.4 L860.825 1063.66 L841.932 1056.72 L823.04 1049.65 L804.148 1042.43 L785.255 1034.93 L766.363 1027.26 L747.47 1019.43 L728.578 1011.24 L709.686 1002.83 L690.793 994.213 L671.901 985.109 L653.008 975.71 L634.116 966.021 L615.224 955.632 L596.331 944.811 L577.439 933.533 L558.547 921.174 L539.654 907.995 L520.762 893.84 L501.869 878.107 L482.977 859.899 L464.085 838.342 L445.192 810.336 L426.3 744.232  Z" fill="#ff0000" fill-rule="evenodd" fill-opacity="0.1"/>
<polyline clip-path="url(#clip022)" style="stroke:#ff0000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="426.3,744.232 445.192,678.853 464.085,651.831 482.977,628.312 501.869,612.174 520.762,596.036 539.654,580.315 558.547,568.533 577.439,556.752 596.331,544.97 615.224,533.188 634.116,522.818 653.008,513.822 671.901,504.826 690.793,495.83 709.686,486.834 728.578,477.838 747.47,468.842 766.363,461.08 785.255,454.024 804.148,446.967 823.04,439.911 841.932,432.854 860.825,425.798 879.717,418.741 898.609,411.685 917.502,404.628 936.394,397.572 955.287,391.246 974.179,385.621 993.071,379.997 1011.96,374.372 1030.86,368.748 1049.75,363.123 1068.64,357.499 1087.53,351.874 1106.43,346.25 1125.32,340.625 1144.21,335.001 1163.1,329.376 1182,323.752 1200.89,318.127 1219.78,312.503 1238.67,307.57 1257.56,303.049 1276.46,298.529 1295.35,294.009 1314.24,289.489 1333.13,284.968 1352.03,280.448 1370.92,275.928 1389.81,271.408 1408.7,266.887 1427.6,262.367 1446.49,257.847 1465.38,253.327 1484.27,248.806 1503.17,244.286 1522.06,239.766 1540.95,235.246 1559.84,230.725 1578.74,226.205 1597.63,221.685 1616.52,217.165 1635.41,212.644 1654.3,208.631 1673.2,204.991 1692.09,201.352 1710.98,197.713 1729.87,194.073 1748.77,190.434 1767.66,186.794 1786.55,183.155 1805.44,179.516 1824.34,175.876 1843.23,172.237 1862.12,168.598 1881.01,164.958 1899.91,161.319 1918.8,157.679 1937.69,154.04 1956.58,150.401 1975.48,146.761 1994.37,143.122 2013.26,139.482 2032.15,135.843 2051.04,132.204 2069.94,128.564 2088.83,124.925 2107.72,121.285 2126.61,117.646 2145.51,114.007 2164.4,110.367 2183.29,106.728 2202.18,103.088 2221.08,99.449 2239.97,95.8096 2258.86,92.1702 2277.75,88.755 2296.65,85.838 "/>
<path clip-path="url(#clip022)" d="M426.3 1122.99 L445.192 1105.44 L464.085 1098.22 L482.977 1092.64 L501.869 1087.95 L520.762 1083.8 L539.654 1080.06 L558.547 1076.64 L577.439 1073.47 L596.331 1070.48 L615.224 1067.63 L634.116 1064.95 L653.008 1062.39 L671.901 1059.9 L690.793 1057.56 L709.686 1055.25 L728.578 1053.07 L747.47 1050.91 L766.363 1048.84 L785.255 1046.83 L804.148 1044.84 L823.04 1042.96 L841.932 1041.08 L860.825 1039.23 L879.717 1037.48 L898.609 1035.72 L917.502 1033.98 L936.394 1032.33 L955.287 1030.69 L974.179 1029.04 L993.071 1027.46 L1011.96 1025.92 L1030.86 1024.38 L1049.75 1022.84 L1068.64 1021.36 L1087.53 1019.91 L1106.43 1018.47 L1125.32 1017.03 L1144.21 1015.6 L1163.1 1014.24 L1182 1012.89 L1200.89 1011.54 L1219.78 1010.18 L1238.67 1008.84 L1257.56 1007.57 L1276.46 1006.3 L1295.35 1005.03 L1314.24 1003.76 L1333.13 1002.49 L1352.03 1001.26 L1370.92 1000.07 L1389.81 998.879 L1408.7 997.689 L1427.6 996.499 L1446.49 995.31 L1465.38 994.12 L1484.27 993.004 L1503.17 991.889 L1522.06 990.773 L1540.95 989.658 L1559.84 988.543 L1578.74 987.427 L1597.63 986.312 L1616.52 985.247 L1635.41 984.202 L1654.3 983.156 L1673.2 982.111 L1692.09 981.066 L1710.98 980.02 L1729.87 978.975 L1748.77 977.93 L1767.66 976.915 L1786.55 975.936 L1805.44 974.957 L1824.34 973.977 L1843.23 972.998 L1862.12 972.019 L1881.01 971.039 L1899.91 970.06 L1918.8 969.08 L1937.69 968.106 L1956.58 967.189 L1975.48 966.273 L1994.37 965.356 L2013.26 964.439 L2032.15 963.522 L2051.04 962.605 L2069.94 961.688 L2088.83 960.771 L2107.72 959.854 L2126.61 958.937 L2145.51 958.042 L2164.4 957.184 L2183.29 956.326 L2202.18 955.468 L2221.08 954.611 L2239.97 953.753 L2258.86 952.895 L2277.75 952.037 L2296.65 951.179 L2296.65 1279.55 L2277.75 1279.07 L2258.86 1278.59 L2239.97 1278.09 L2221.08 1277.59 L2202.18 1277.07 L2183.29 1276.55 L2164.4 1276.01 L2145.51 1275.47 L2126.61 1274.91 L2107.72 1274.35 L2088.83 1273.77 L2069.94 1273.18 L2051.04 1272.58 L2032.15 1271.97 L2013.26 1271.35 L1994.37 1270.72 L1975.48 1270.08 L1956.58 1269.43 L1937.69 1268.76 L1918.8 1268.09 L1899.91 1267.4 L1881.01 1266.7 L1862.12 1265.99 L1843.23 1265.26 L1824.34 1264.53 L1805.44 1263.78 L1786.55 1263.02 L1767.66 1262.25 L1748.77 1261.47 L1729.87 1260.67 L1710.98 1259.86 L1692.09 1259.04 L1673.2 1258.21 L1654.3 1257.36 L1635.41 1256.5 L1616.52 1255.62 L1597.63 1254.74 L1578.74 1253.83 L1559.84 1252.92 L1540.95 1251.99 L1522.06 1251.05 L1503.17 1250.09 L1484.27 1249.12 L1465.38 1248.13 L1446.49 1247.13 L1427.6 1246.11 L1408.7 1245.08 L1389.81 1244.03 L1370.92 1242.96 L1352.03 1241.88 L1333.13 1240.78 L1314.24 1239.66 L1295.35 1238.53 L1276.46 1237.38 L1257.56 1236.21 L1238.67 1235.02 L1219.78 1233.81 L1200.89 1232.59 L1182 1231.34 L1163.1 1230.07 L1144.21 1228.78 L1125.32 1227.47 L1106.43 1226.13 L1087.53 1224.77 L1068.64 1223.39 L1049.75 1221.98 L1030.86 1220.54 L1011.96 1219.08 L993.071 1217.58 L974.179 1216.06 L955.287 1214.51 L936.394 1212.92 L917.502 1211.3 L898.609 1209.65 L879.717 1207.95 L860.825 1206.22 L841.932 1204.44 L823.04 1202.62 L804.148 1200.75 L785.255 1198.82 L766.363 1196.84 L747.47 1194.8 L728.578 1192.7 L709.686 1190.52 L690.793 1188.27 L671.901 1185.92 L653.008 1183.49 L634.116 1180.94 L615.224 1178.27 L596.331 1175.46 L577.439 1172.48 L558.547 1169.3 L539.654 1165.88 L520.762 1162.16 L501.869 1158.04 L482.977 1153.35 L464.085 1147.79 L445.192 1140.52 L426.3 1122.99  Z" fill="#0000ff" fill-rule="evenodd" fill-opacity="0.1"/>
<polyline clip-path="url(#clip022)" style="stroke:#0000ff; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="426.3,1122.99 445.192,1105.44 464.085,1098.22 482.977,1092.64 501.869,1087.95 520.762,1083.8 539.654,1080.06 558.547,1076.64 577.439,1073.47 596.331,1070.48 615.224,1067.63 634.116,1064.95 653.008,1062.39 671.901,1059.9 690.793,1057.56 709.686,1055.25 728.578,1053.07 747.47,1050.91 766.363,1048.84 785.255,1046.83 804.148,1044.84 823.04,1042.96 841.932,1041.08 860.825,1039.23 879.717,1037.48 898.609,1035.72 917.502,1033.98 936.394,1032.33 955.287,1030.69 974.179,1029.04 993.071,1027.46 1011.96,1025.92 1030.86,1024.38 1049.75,1022.84 1068.64,1021.36 1087.53,1019.91 1106.43,1018.47 1125.32,1017.03 1144.21,1015.6 1163.1,1014.24 1182,1012.89 1200.89,1011.54 1219.78,1010.18 1238.67,1008.84 1257.56,1007.57 1276.46,1006.3 1295.35,1005.03 1314.24,1003.76 1333.13,1002.49 1352.03,1001.26 1370.92,1000.07 1389.81,998.879 1408.7,997.689 1427.6,996.499 1446.49,995.31 1465.38,994.12 1484.27,993.004 1503.17,991.889 1522.06,990.773 1540.95,989.658 1559.84,988.543 1578.74,987.427 1597.63,986.312 1616.52,985.247 1635.41,984.202 1654.3,983.156 1673.2,982.111 1692.09,981.066 1710.98,980.02 1729.87,978.975 1748.77,977.93 1767.66,976.915 1786.55,975.936 1805.44,974.957 1824.34,973.977 1843.23,972.998 1862.12,972.019 1881.01,971.039 1899.91,970.06 1918.8,969.08 1937.69,968.106 1956.58,967.189 1975.48,966.273 1994.37,965.356 2013.26,964.439 2032.15,963.522 2051.04,962.605 2069.94,961.688 2088.83,960.771 2107.72,959.854 2126.61,958.937 2145.51,958.042 2164.4,957.184 2183.29,956.326 2202.18,955.468 2221.08,954.611 2239.97,953.753 2258.86,952.895 2277.75,952.037 2296.65,951.179 "/>
</svg>
</div></div>
</div>
<p>Here’s another such figure, with <span class="math notranslate nohighlight">\(\theta = 0.002\)</span> instead of <span class="math notranslate nohighlight">\(0.02\)</span></p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../_images/kg_small_theta.png"><img alt="../_images/kg_small_theta.png" src="../_images/kg_small_theta.png" style="width: 70%;" /></a>
</div>
<p>Can you explain the different shape of the value-entropy correspondence for the robust policy?</p>
</div>
<div class="section" id="appendix">
<span id="rb-appendix"></span><h2><a class="toc-backref" href="#id12"><span class="section-number">42.8. </span>Appendix</a><a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
<p>We sketch the proof only of the first claim in <a class="reference internal" href="#rb-eq"><span class="std std-ref">this section</span></a>,
which is that, for any given <span class="math notranslate nohighlight">\(\theta\)</span>, <span class="math notranslate nohighlight">\(K(\hat F, \theta) = \hat K\)</span>,
where <span class="math notranslate nohighlight">\(\hat K\)</span> is as given in <a class="reference internal" href="#equation-rb-kd">(42.8)</a>.</p>
<p>This is the content of the next lemma.</p>
<p><strong>Lemma.</strong> If <span class="math notranslate nohighlight">\(\hat P\)</span> is the fixed point of the map <span class="math notranslate nohighlight">\(\mathcal B \circ \mathcal D\)</span> and <span class="math notranslate nohighlight">\(\hat F\)</span> is the robust policy as given in <a class="reference internal" href="#equation-rb-oc-ih">(42.7)</a>, then</p>
<div class="math notranslate nohighlight" id="equation-rb-kft">
<span class="eqno">(42.28)<a class="headerlink" href="#equation-rb-kft" title="Permalink to this equation">¶</a></span>\[K(\hat F, \theta) = (\theta I - C'\hat P C)^{-1} C' \hat P  (A - B \hat F)\]</div>
<p><em>Proof:</em> As a first step, observe that when <span class="math notranslate nohighlight">\(F = \hat F\)</span>, the Bellman equation associated with the LQ problem  <a class="reference internal" href="#equation-rob-lomf">(42.11)</a> – <a class="reference internal" href="#equation-rb-a2o">(42.12)</a> is</p>
<div class="math notranslate nohighlight" id="equation-rb-a2be">
<span class="eqno">(42.29)<a class="headerlink" href="#equation-rb-a2be" title="Permalink to this equation">¶</a></span>\[\tilde P = -R - \hat F' Q \hat F -
\beta^2 (A - B \hat F)' \tilde P C
(\beta \theta I + \beta C' \tilde P C)^{-1} C' \tilde P (A - B \hat F) +
\beta (A - B \hat F)' \tilde P (A - B \hat F)\]</div>
<p>(revisit <a class="reference internal" href="lqcontrol.html#lq-ih"><span class="std std-ref">this discussion</span></a> if you don’t know where <a class="reference internal" href="#equation-rb-a2be">(42.29)</a> comes from) and the optimal policy is</p>
<div class="math notranslate nohighlight">
\[
w_{t+1} = - \beta (\beta \theta I + \beta C' \tilde P C)^{-1}
C' \tilde P (A - B \hat F) x_t
\]</div>
<p>Suppose for a moment that <span class="math notranslate nohighlight">\(- \hat P\)</span> solves the Bellman equation <a class="reference internal" href="#equation-rb-a2be">(42.29)</a>.</p>
<p>In this case the policy becomes</p>
<div class="math notranslate nohighlight">
\[
w_{t+1} = (\theta I - C' \hat P C)^{-1} C' \hat P (A - B \hat F) x_t
\]</div>
<p>which is exactly the claim in <a class="reference internal" href="#equation-rb-kft">(42.28)</a>.</p>
<p>Hence it remains only to show that <span class="math notranslate nohighlight">\(- \hat P\)</span> solves <a class="reference internal" href="#equation-rb-a2be">(42.29)</a>,
or, in other words,</p>
<div class="math notranslate nohighlight">
\[
\hat  P
 =
 R + \hat F' Q \hat F
 + \beta (A - B \hat F)' \hat P C
   (\theta I - C' \hat P C)^{-1} C' \hat P (A - B \hat F)
   + \beta (A - B \hat F)' \hat P (A - B \hat F)
\]</div>
<p>Using the definition of <span class="math notranslate nohighlight">\(\mathcal D\)</span>, we can rewrite the right-hand
side more simply as</p>
<div class="math notranslate nohighlight">
\[
R + \hat F' Q \hat F
+ \beta (A - B \hat F)' \mathcal D(\hat P) (A - B \hat F)
\]</div>
<p>Although it involves a substantial amount of algebra, it can be shown that the
latter is just <span class="math notranslate nohighlight">\(\hat P\)</span>.</p>
<p>(Hint: Use the fact that <span class="math notranslate nohighlight">\(\hat P = \mathcal B( \mathcal D( \hat P))\)</span>)</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.9"
        },
        kernelOptions: {
            kernelName: "julia-1.9",
            path: "./dynamic_programming"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.9'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="ifp.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">41. </span>Optimal Savings III: Occasionally Binding Constraints</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="discrete_dp.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">43. </span>Discrete State Dynamic Programming</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Jesse Perla & Thomas J. Sargent & John Stachurski<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>